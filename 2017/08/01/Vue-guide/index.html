<!doctype html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="vue," />








  <link rel="shortcut icon" type="image/x-icon" href="/Avatar.png?v=5.1.0" />






<meta name="description" content="VueJs官网教程学习笔记安装
兼容性:不支持IE8及以下版本浏览器；因为使用了IE8无法模拟的Object.defineProperty
开发版本-&amp;gt;包含了完整的警告和调试模式
CLI-&amp;gt;可以构建一个完整的vue项目

介绍
是一套构建用户界面的框架，本身只关注视图层，但可以和第三方库结合来构建复杂的spa

Vue实例
构造器

Vue(选项对象)
123var vm = new">
<meta property="og:type" content="article">
<meta property="og:title" content="Vue-guide">
<meta property="og:url" content="http://yoursite.com/2017/08/01/Vue-guide/index.html">
<meta property="og:site_name" content="BryanAdamss的博客">
<meta property="og:description" content="VueJs官网教程学习笔记安装
兼容性:不支持IE8及以下版本浏览器；因为使用了IE8无法模拟的Object.defineProperty
开发版本-&amp;gt;包含了完整的警告和调试模式
CLI-&amp;gt;可以构建一个完整的vue项目

介绍
是一套构建用户界面的框架，本身只关注视图层，但可以和第三方库结合来构建复杂的spa

Vue实例
构造器

Vue(选项对象)
123var vm = new">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/props.png">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/lifecycle.png">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/props-events.png">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/data.png">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/transition.png">
<meta property="og:image" content="http://yoursite.com/2017/08/01/Vue-guide/state.png">
<meta property="og:updated_time" content="2018-04-08T11:57:00.657Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Vue-guide">
<meta name="twitter:description" content="VueJs官网教程学习笔记安装
兼容性:不支持IE8及以下版本浏览器；因为使用了IE8无法模拟的Object.defineProperty
开发版本-&amp;gt;包含了完整的警告和调试模式
CLI-&amp;gt;可以构建一个完整的vue项目

介绍
是一套构建用户界面的框架，本身只关注视图层，但可以和第三方库结合来构建复杂的spa

Vue实例
构造器

Vue(选项对象)
123var vm = new">
<meta name="twitter:image" content="http://yoursite.com/2017/08/01/Vue-guide/props.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    sidebar: {"position":"left","display":"post","offset":12,"offset_float":0,"b2t":false,"scrollpercent":false},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/2017/08/01/Vue-guide/"/>





  <title> Vue-guide | BryanAdamss的博客 </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  














  
  
    
  

  <div class="container one-collumn sidebar-position-left page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">BryanAdamss的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">一个伪前端</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocapitalize="off" autocomplete="off" autocorrect="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2017/08/01/Vue-guide/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="BryanAdamss">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/Avatar.png">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="BryanAdamss的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                Vue-guide
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-01T10:35:14+08:00">
                2017-08-01 10:35:14
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/FrontEnd/" itemprop="url" rel="index">
                    <span itemprop="name">前端</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="VueJs官网教程学习笔记"><a href="#VueJs官网教程学习笔记" class="headerlink" title="VueJs官网教程学习笔记"></a>VueJs官网教程学习笔记</h1><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><ul>
<li>兼容性:不支持IE8及以下版本浏览器；因为使用了IE8无法模拟的Object.defineProperty</li>
<li>开发版本-&gt;包含了完整的警告和调试模式</li>
<li>CLI-&gt;可以构建一个完整的vue项目</li>
</ul>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><ul>
<li>是一套构建用户界面的框架，本身只关注视图层，但可以和第三方库结合来构建复杂的spa</li>
</ul>
<h2 id="Vue实例"><a href="#Vue实例" class="headerlink" title="Vue实例"></a>Vue实例</h2><ul>
<li><p>构造器</p>
<ul>
<li><p>Vue(选项对象)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="comment">// 选项</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>可扩展Vue构造器</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> MyComponent = Vue.extend(&#123;</div><div class="line">  <span class="comment">// 扩展选项</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// 所有的 `MyComponent` 实例都将以预定义的扩展选项被创建</span></div><div class="line"><span class="keyword">var</span> myComponentInstance = <span class="keyword">new</span> MyComponent()</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>属性与方法</p>
<ul>
<li>每个vue实例会<strong>代理</strong>其<code>data</code>对象里有所有属性，这些属性都是响应式的；<img src="/2017/08/01/Vue-guide/props.png" alt=""></li>
<li>$开头的为vue实例属性/方法</li>
<li>不要在实例属性或者回调函数中使用箭头函数，箭头函数会绑定上级context，this预期将不会是vue实例</li>
</ul>
</li>
<li>实例生命周期<ul>
<li><img src="/2017/08/01/Vue-guide/lifecycle.png" alt=""></li>
<li>生命周期钩子-&gt;自定义事件<ul>
<li>可以在选项对象中进行配置</li>
<li>生命周期钩子中的this指向实例化后的对象<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">a</span>: <span class="number">1</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">created</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="comment">// `this` 指向 vm 实例</span></div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'a is: '</span> + <span class="keyword">this</span>.a)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// -&gt; "a is: 1"</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="模板语法"><a href="#模板语法" class="headerlink" title="模板语法"></a>模板语法</h2><h3 id="插值"><a href="#插值" class="headerlink" title="插值"></a>插值</h3><ul>
<li><p>文本</p>
<ul>
<li>绑定文本<ul>
<li><code>v-text</code><ul>
<li>会将对应表达式求值后，当做字符串替换元素内的内容</li>
</ul>
</li>
<li>{{ msg }}
<ul>
<li>msg 改变时，视图也会发生改变;是<code>v-text</code>的简写，求值后，当做字符串替换 {{ }}处的内容;{{ }}中可以使用表达式，但不能使用语句，流程控制也不能用(使用三元表达式代替)</li>
<li>{{ }}形式会和ng中的一样，存在首次加载闪烁的问题，如果是首屏内容，可以尝试使用<code>v-text</code>绑定</li>
</ul>
</li>
<li>一次性插值<ul>
<li>在元素上使用<code>v-once</code>指令，这样元素内部的所有数据绑定，只会显示第一次绑定时的数据，当数据发生变化时，它们都不会得到更新，可以用在不会发生改变的数据的绑定；<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">span</span> <span class="attr">v-once</span>&gt;</span>This will never change: &#123;&#123; msg &#125;&#125;,&#123;&#123; test &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>纯html</p>
<ul>
<li><code>v-html</code><ul>
<li>{{ }}和<code>v-text</code>会将数据当做纯文本处理，不会对其做html解析;<code>v-html</code>会将对应表达表达式当做html解析后，输出到元素内</li>
</ul>
</li>
</ul>
</li>
<li>属性(特性)<ul>
<li><code>v-bind</code><ul>
<li>主要用来绑定特性<ul>
<li><code>v-bind:title=&quot;test&quot;</code> 将test绑定到元素的title特性上；        </li>
</ul>
</li>
<li>缩写<ul>
<li><code>v-bind:href=&quot;url&quot;</code>-&gt;<code>:href=&quot;url&quot;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="指令"><a href="#指令" class="headerlink" title="指令"></a>指令</h3><ul>
<li>指令是<code>v-</code>开头(ng中以ng-开头)，它的预期是一个<strong>单一js表达式</strong>(<code>v-for</code>除外)</li>
<li><p>可以带参数</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"doSomething"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>修饰符</p>
<ul>
<li>指令后通过添加<code>.</code>来附加修饰符（Modifiers），用于指出一个指令应该以特殊方式绑定。<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>=<span class="string">"onSubmit"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span>// submit时阻止默认行为</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="过滤器"><a href="#过滤器" class="headerlink" title="过滤器"></a>过滤器</h3><ul>
<li>vue2.0中没有预定义的过滤器了，所有filter都需要自定义</li>
<li>主要用在{{ }}和<code>v-bind</code>中，达到格式化输出文本的作用</li>
<li>可级联使用</li>
<li>可带参数<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//使用</span></div><div class="line">&lt;!-- <span class="keyword">in</span> mustaches --&gt;</div><div class="line">&#123;&#123; message | capitalize &#125;&#125;</div><div class="line">&lt;!-- <span class="keyword">in</span> v-bind --&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-bind:id</span>=<span class="string">"rawId | formatId"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"><span class="comment">// 定义</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">  filters: &#123;</div><div class="line">    <span class="attr">capitalize</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (!value) <span class="keyword">return</span> <span class="string">''</span></div><div class="line">      value = value.toString()</div><div class="line">      <span class="keyword">return</span> value.charAt(<span class="number">0</span>).toUpperCase() + value.slice(<span class="number">1</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// 级联使用</span></div><div class="line">&#123;&#123; message | filterA | filterB &#125;&#125;</div><div class="line"><span class="comment">// 带参数</span></div><div class="line">&#123;&#123; message | filterA(<span class="string">'arg1'</span>, arg2) &#125;&#125;<span class="comment">// 这里，filterA 是个拥有三个参数的函数。message 的值将会作为第一个参数传入。字符串 'arg1' 将作为第二个参数传给 filterA，表达式 arg2 的值将作为第三个参数。</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="缩写"><a href="#缩写" class="headerlink" title="缩写"></a>缩写</h3><ul>
<li><p>v-bind</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 完整语法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-bind:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 缩写 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">:href</span>=<span class="string">"url"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>v-on</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 完整语法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click</span>=<span class="string">"doSomething"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 缩写 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> @<span class="attr">click</span>=<span class="string">"doSomething"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="计算属性"><a href="#计算属性" class="headerlink" title="计算属性"></a>计算属性</h2><h3 id="计算属性-1"><a href="#计算属性-1" class="headerlink" title="计算属性"></a>计算属性</h3><ul>
<li><p>可以将计算属性当成data中属性添加了一个getter方法，并返回一个新属性，但新属性依赖data中的属性；</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// js</span></div><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#example'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">message</span>: <span class="string">'Hello'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">computed</span>: &#123;</div><div class="line">    <span class="comment">// a computed getter</span></div><div class="line">    reversedMessage: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="comment">// `this` 指向vm实例，由于vm实例代理了所有data中的属性，所以this.message能被访问到</span></div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line"><span class="comment">// 当data中的message发生变化时，reversedMessage也会重新计算</span></div></pre></td></tr></table></figure>
</li>
<li><p>计算属性vsMethods</p>
  <figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Reversed message: "&#123;&#123; reversedMessage() &#125;&#125;"<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div></pre></td></tr></table></figure>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">methods: &#123;</div><div class="line">  <span class="attr">reversedMessage</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.message.split(<span class="string">''</span>).reverse().join(<span class="string">''</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 这样也能实现反转的效果</span></div></pre></td></tr></table></figure>
<ul>
<li>不同点<ul>
<li>计算属性是基于它们的依赖进行缓存的；如上面计算属性的例子，只要data中的message没有发生变化，computed中的reversedMessage都不会重新计算，每次访问reversedMessage都将会是之前缓存的数据；</li>
<li>methods则不存在缓存一说，如上面methods例子，只要`<p>Reversed message: "{{ reversedMessage() }}"</p>`需要重新渲染，reversedMessage就会被重新调用并计算一次</li>
</ul>
</li>
</ul>
</li>
<li><p>计算setter</p>
<ul>
<li>计算属性默认只有getter，可以提供setter方法<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// ...</span></div><div class="line">computed: &#123;</div><div class="line">  <span class="attr">fullName</span>: &#123;</div><div class="line">    <span class="comment">// getter</span></div><div class="line">    get: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.firstName + <span class="string">' '</span> + <span class="keyword">this</span>.lastName</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// setter</span></div><div class="line">    set: <span class="function"><span class="keyword">function</span> (<span class="params">newValue</span>) </span>&#123;</div><div class="line">      <span class="keyword">var</span> names = newValue.split(<span class="string">' '</span>)</div><div class="line">      <span class="keyword">this</span>.firstName = names[<span class="number">0</span>]</div><div class="line">      <span class="keyword">this</span>.lastName = names[names.length - <span class="number">1</span>]</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// ...</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>watch</p>
<ul>
<li><p>主要用来观测数据的变化，并进行一系列的操作</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"watch-example"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span></div><div class="line">    Ask a yes/no question:</div><div class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"question"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; answer &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line">&lt;!-- Since there is already a rich ecosystem <span class="keyword">of</span> ajax libraries    --&gt;</div><div class="line"><span class="xml"><span class="comment">&lt;!-- and collections of general-purpose utility methods, Vue core --&gt;</span></span></div><div class="line"><span class="comment">&lt;!-- is able to remain small by not reinventing them. This also   --&gt;</span></div><div class="line"><span class="comment">&lt;!-- gives you the freedom to just use what you're familiar with. --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/axios@0.12.0/dist/axios.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://unpkg.com/lodash@4.13.1/lodash.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">var</span> watchExampleVM = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#watch-example'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">question</span>: <span class="string">''</span>,</div><div class="line">    <span class="attr">answer</span>: <span class="string">'I cannot give you an answer until you ask a question!'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">watch</span>: &#123;</div><div class="line">    <span class="comment">// 如果 question 发生改变，这个函数就会运行</span></div><div class="line">    question: <span class="function"><span class="keyword">function</span> (<span class="params">newQuestion</span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.answer = <span class="string">'Waiting for you to stop typing...'</span></div><div class="line">      <span class="keyword">this</span>.getAnswer()</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">methods</span>: &#123;</div><div class="line">    <span class="comment">// _.debounce 是一个通过 lodash 限制操作频率的函数。</span></div><div class="line">    <span class="comment">// 在这个例子中，我们希望限制访问yesno.wtf/api的频率</span></div><div class="line">    <span class="comment">// ajax请求直到用户输入完毕才会发出</span></div><div class="line">    <span class="comment">// 学习更多关于 _.debounce function (and its cousin</span></div><div class="line">    <span class="comment">// _.throttle), 参考: https://lodash.com/docs#debounce</span></div><div class="line">    getAnswer: _.debounce(</div><div class="line">      <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">this</span>.question.indexOf(<span class="string">'?'</span>) === <span class="number">-1</span>) &#123;</div><div class="line">          <span class="keyword">this</span>.answer = <span class="string">'Questions usually contain a question mark. ;-)'</span></div><div class="line">          <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="keyword">this</span>.answer = <span class="string">'Thinking...'</span></div><div class="line">        <span class="keyword">var</span> vm = <span class="keyword">this</span></div><div class="line">        axios.get(<span class="string">'https://yesno.wtf/api'</span>)</div><div class="line">          .then(<span class="function"><span class="keyword">function</span> (<span class="params">response</span>) </span>&#123;</div><div class="line">            vm.answer = _.capitalize(response.data.answer)</div><div class="line">          &#125;)</div><div class="line">          .catch(<span class="function"><span class="keyword">function</span> (<span class="params">error</span>) </span>&#123;</div><div class="line">            vm.answer = <span class="string">'Error! Could not reach the API. '</span> + error</div><div class="line">          &#125;)</div><div class="line">      &#125;,</div><div class="line">      <span class="comment">// 这是我们为用户停止输入等待的毫秒数</span></div><div class="line">      <span class="number">500</span></div><div class="line">    )</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>什么时候用computed、methods、watch</p>
<ul>
<li>computed主要用在根据原有属性，进行计算，返回新属性的操作；即适合用在对数据(属性)的set和get上</li>
<li>methods主要用来编写一些通用，没有什么依赖的方法。</li>
<li>watch主要用来观测数据(属性)的变化，当变化时进行一系列操作（异步操作或开销较大的操作）</li>
</ul>
</li>
<li>总结<ul>
<li>computed适合用来对数据进行set、get</li>
<li>watch适合用来在数据变化时，进行大开销的操作</li>
<li>methods 用来编写通用的方法</li>
</ul>
</li>
</ul>
<h2 id="Class与Style绑定"><a href="#Class与Style绑定" class="headerlink" title="Class与Style绑定"></a>Class与Style绑定</h2><h3 id="绑定-HTML-Class"><a href="#绑定-HTML-Class" class="headerlink" title="绑定 HTML Class"></a>绑定 HTML Class</h3><p>类似ng-class</p>
<ul>
<li><p>对象语法</p>
<ul>
<li><p>传一个对象，以动态切换class</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123; active: isActive &#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><span class="comment">// isActive为true时，则添加active样式类，为false则去除</span></div></pre></td></tr></table></figure>
</li>
<li><p>可以传多个属性，进行动态切换class；并v-bind:class可以和普通class属性共存</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"static"</span></div><div class="line"> v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"&#123; active: isActive, 'text-danger': hasError &#125;"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>可以直接绑定data里的一个对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"classObject"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"><span class="comment">// js</span></div><div class="line">data: &#123;</div><div class="line">  <span class="attr">classObject</span>: &#123;</div><div class="line">    <span class="attr">active</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">'text-danger'</span>: <span class="literal">false</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>也可以绑定一个computed里的对象</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"classObject"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"><span class="comment">// js</span></div><div class="line">data: &#123;</div><div class="line">  <span class="attr">isActive</span>: <span class="literal">true</span>,</div><div class="line">  <span class="attr">error</span>: <span class="literal">null</span></div><div class="line">&#125;,</div><div class="line"><span class="attr">computed</span>: &#123;</div><div class="line">  <span class="attr">classObject</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">active</span>: <span class="keyword">this</span>.isActive &amp;&amp; !<span class="keyword">this</span>.error,</div><div class="line">      <span class="string">'text-danger'</span>: <span class="keyword">this</span>.error &amp;&amp; <span class="keyword">this</span>.error.type === <span class="string">'fatal'</span>,</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>数组语法</p>
<ul>
<li><p>可以把数组传递给v-bind:class，以应用一个class列表</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[activeClass, errorClass]"</span>&gt;</div><div class="line"><span class="comment">// js</span></div><div class="line">data: &#123;</div><div class="line">  <span class="attr">activeClass</span>: <span class="string">'active'</span>,</div><div class="line">  <span class="attr">errorClass</span>: <span class="string">'text-danger'</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>可以在数组中使用条件表达式</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[isActive ? activeClass : '', errorClass]"</span>&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>可以在数组中使用对象语法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:<span class="class"><span class="keyword">class</span></span>=<span class="string">"[&#123; active: isActive &#125;, errorClass]"</span>&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="绑定内联样式"><a href="#绑定内联样式" class="headerlink" title="绑定内联样式"></a>绑定内联样式</h3><p>类似ng-style</p>
<ul>
<li><p>对象语法</p>
<ul>
<li>直接绑定一个对象，CSS属性名用驼峰式(camelCase) <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:style=<span class="string">"&#123; color: activeColor, fontSize: fontSize + 'px' &#125;"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></div><div class="line"><span class="comment">// js</span></div><div class="line">data: &#123;</div><div class="line">  <span class="attr">activeColor</span>: <span class="string">'red'</span>,</div><div class="line">  <span class="attr">fontSize</span>: <span class="number">30</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>数组语法</p>
<ul>
<li>v-bind:style 的数组语法可以将多个样式对象应用到一个元素上<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div v-bind:style=<span class="string">"[baseStyles, overridingStyles]"</span>&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>多重值</p>
<ul>
<li>从 2.3.0 起你可以为 style 绑定中的属性提供一个包含多个值的数组，常用于提供多个带前缀的值<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;div :style=<span class="string">"&#123; display: ['-webkit-box', '-ms-flexbox', 'flex'] &#125;"</span>&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="条件渲染"><a href="#条件渲染" class="headerlink" title="条件渲染"></a>条件渲染</h2><p>类似<code>ng-if</code></p>
<h3 id="v-if"><a href="#v-if" class="headerlink" title="v-if"></a><code>v-if</code></h3><ul>
<li><p>条件为true时，则渲染，将元素添加到DOM中，为false，则将其从dom中删除</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;h1 v-<span class="keyword">if</span>=<span class="string">"ok"</span>&gt;Yes&lt;<span class="regexp">/h1&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>条件渲染一组</p>
<ul>
<li>可以将需要条件渲染的元素放到<code>&lt;template&gt;</code>元素中，然后用<code>v-if</code>条件渲染<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">template</span> <span class="attr">v-if</span>=<span class="string">"ok"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Title<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 1<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>Paragraph 2<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="v-else"><a href="#v-else" class="headerlink" title="v-else"></a><code>v-else</code></h3><ul>
<li><p>可以使用v-else指令来表示v-if的”else块”</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"Math.random() &gt; 0.5"</span>&gt;</span></div><div class="line">  Now you see me</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span></div><div class="line">  Now you don't</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>v-else</code>元素必须紧跟在<code>v-if</code>或者<code>v-else-if</code>元素的后面——否则它将不会被识别</p>
</li>
</ul>
<h3 id="v-else-if"><a href="#v-else-if" class="headerlink" title="v-else-if"></a><code>v-else-if</code></h3><ul>
<li><p>充当”else if块”；可链式调用</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">"type === 'A'"</span>&gt;</span></div><div class="line">  A</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">"type === 'B'"</span>&gt;</span></div><div class="line">  B</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else-if</span>=<span class="string">"type === 'C'"</span>&gt;</span></div><div class="line">  C</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-else</span>&gt;</span></div><div class="line">  Not A/B/C</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>类似于 v-else，v-else-if 必须紧跟在 v-if 或者 v-else-if 元素之后</p>
</li>
</ul>
<h3 id="用-key-管理可复用的元素"><a href="#用-key-管理可复用的元素" class="headerlink" title="用 key 管理可复用的元素"></a>用 key 管理可复用的元素</h3><ul>
<li><p>默认情况下，vue会尽可能的高效渲染元素，通常会复用已有元素而不是从头开始渲染。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;template v-<span class="keyword">if</span>=<span class="string">"loginType === 'username'"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></div><div class="line">  &lt;input placeholder=<span class="string">"Enter your username"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></div><div class="line">&lt;template v-<span class="keyword">else</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></div><div class="line">  &lt;input placeholder=<span class="string">"Enter your email address"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></div><div class="line"><span class="comment">// 这里的input会被复用，并不会因为if和else而渲染两个，只是改变placeholder，这样效率更高</span></div></pre></td></tr></table></figure>
</li>
<li><p>有时，我们就是需要渲染两个，这是就需要使用<code>key</code>；如上面例子，为这两个input分别添加一个唯一的<code>key</code>值时，切换时，vue就不会复用他们，而是重新渲染一个</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;template v-<span class="keyword">if</span>=<span class="string">"loginType === 'username'"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>Username<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></div><div class="line">  &lt;input placeholder=<span class="string">"Enter your username"</span> key=<span class="string">"username-input"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></div><div class="line">&lt;template v-<span class="keyword">else</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">label</span>&gt;</span>Email<span class="tag">&lt;/<span class="name">label</span>&gt;</span></span></div><div class="line">  &lt;input placeholder=<span class="string">"Enter your email address"</span> key=<span class="string">"email-input"</span>&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span></div><div class="line"><span class="comment">// 注意, &lt;label&gt; 元素仍然会被高效地复用，因为它们没有添加 key 属性。</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="v-show"><a href="#v-show" class="headerlink" title="v-show"></a><code>v-show</code></h3><ul>
<li>通过切换元素的display属性，元素会一直保留在DOM中，并不会因为为false，就把元素从DOM中删除，这点和<code>v-if</code>不同</li>
</ul>
<h3 id="v-if和v-show"><a href="#v-if和v-show" class="headerlink" title="v-if和v-show"></a><code>v-if</code>和<code>v-show</code></h3><ul>
<li>v-if是通过增加、删除元素来达到显示/隐藏</li>
<li>v-if 也是惰性的：如果在初始渲染时条件为假，则什么也不做——直到条件第一次变为真时，才会开始渲染条件块。</li>
<li>v-show通过css切换(display属性)来显示/隐藏</li>
<li>v-show不管初始条件是什么，元素总是会被渲染，并且只是简单地基于 CSS 进行切换。</li>
<li>一般来说， v-if 有更高的切换开销，而 v-show 有更高的初始渲染开销。因此，如果需要非常频繁地切换，则使用 v-show 较好；如果在运行时条件不太可能改变，则使用 v-if 较好。</li>
</ul>
<h3 id="v-if和v-for一起使用"><a href="#v-if和v-for一起使用" class="headerlink" title="v-if和v-for一起使用"></a><code>v-if</code>和<code>v-for</code>一起使用</h3><ul>
<li>v-for 具有比 v-if 更高的优先级；先循环，再判断显示隐藏</li>
</ul>
<h2 id="列表渲染"><a href="#列表渲染" class="headerlink" title="列表渲染"></a>列表渲染</h2><h3 id="v-for"><a href="#v-for" class="headerlink" title="v-for"></a>v-for</h3><ul>
<li><p>数组迭代</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">id</span>=<span class="string">"example-2"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"(item, index) in items"</span>&gt;</span></div><div class="line">    &#123;&#123; parentMessage &#125;&#125; - &#123;&#123; index &#125;&#125; - &#123;&#123; item.message &#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div><div class="line">// js</div><div class="line">var example2 = new Vue(&#123;</div><div class="line">  el: '#example-2',</div><div class="line">  data: &#123;</div><div class="line">    parentMessage: 'Parent',</div><div class="line">    items: [</div><div class="line">      &#123; message: 'Foo' &#125;,</div><div class="line">      &#123; message: 'Bar' &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>渲染多个元素块-&gt;使用<code>&lt;template&gt;</code>包裹</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">template</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>&#123;&#123; item.msg &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">li</span> <span class="attr">class</span>=<span class="string">"divider"</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>对象迭代</p>
<ul>
<li>在遍历对象时，是按 Object.keys() 的结果遍历，但是不能保证它的结果在不同的 JavaScript 引擎下是一致的。<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"(value, key, index) in object"</span>&gt;</span></div><div class="line">  &#123;&#123; index &#125;&#125;. &#123;&#123; key &#125;&#125; : &#123;&#123; value &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// js</div><div class="line">new Vue(&#123;</div><div class="line">  el: '#repeat-object',</div><div class="line">  data: &#123;</div><div class="line">    object: &#123;</div><div class="line">      firstName: 'John',</div><div class="line">      lastName: 'Doe',</div><div class="line">      age: 30</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>整数迭代</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- span会重复10次 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-for</span>=<span class="string">"n in 10"</span>&gt;</span>&#123;&#123; n &#125;&#125; <span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>v-for和v-if</p>
<ul>
<li><p>当它们处于同一节点， v-for 的优先级比 v-if 更高，这意味着 v-if 将分别重复运行于每个 v-for 循环中。相当于在for循环中，再用if判断；</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;li v-<span class="keyword">for</span>=<span class="string">"todo in todos"</span> v-<span class="keyword">if</span>=<span class="string">"!todo.isComplete"</span>&gt;</div><div class="line">    &#123;&#123; todo &#125;&#125;</div><div class="line">&lt;<span class="regexp">/li&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>如果想条件判断了再循环，可以先if再for</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">ul</span> <span class="attr">v-if</span>=<span class="string">"shouldRenderTodos"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"todo in todos"</span>&gt;</span></div><div class="line">    &#123;&#123; todo &#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="key"><a href="#key" class="headerlink" title="key"></a>key</h3><ul>
<li>vue默认会采取”就地复用”的策略,如果数据项的顺序被改变，Vue将不是移动 DOM 元素来匹配数据项的顺序， 而是简单复用此处每个元素，并且确保它在特定索引下显示已被渲染过的每个元素。<br>为了给 Vue 一个提示，以便它能跟踪每个节点的身份，从而重用和重新排序现有元素，你需要为每项提供一个唯一 key 属性。<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-for</span>=<span class="string">"item in items"</span> <span class="attr">:key</span>=<span class="string">"item.id"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 内容 --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>建议尽可能使用 v-for 来提供 key ，除非迭代 DOM 内容足够简单，或者你是故意要依赖于默认行为来获得性能提升。<br>因为它是 Vue 识别节点的一个通用机制， key 并不特别与 v-for 关联，key 还具有其他用途，我们将在后面的指南中看到其他用途。</p>
<h3 id="数组更新检测"><a href="#数组更新检测" class="headerlink" title="数组更新检测"></a>数组更新检测</h3><ul>
<li>变异方法<ul>
<li>会改变原数组的方法都为变异方法push()、pop()、shift()、unshift()、splice()、sort()、reverse()；所有变异方法(会改变原数组的方法)都会触发更新检测,若发现数组有变化，则会更新依赖它的地方</li>
</ul>
</li>
<li><p>重塑数组</p>
<ul>
<li>不会改变原数组的方法为非变异方法，非变异方法会返回一个新的数组；filter(), concat(), slice()都是非变异方法；当使用新返回的数组替换原先的数组时(重塑数组)，不用担心vue会丢弃现有DOM重新渲染，vue会智能的复用DOM元素，<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">example1.items = example1.items.filter(<span class="function"><span class="keyword">function</span> (<span class="params">item</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> item.message.match(<span class="regexp">/Foo/</span>)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>注意</p>
<ul>
<li>由于js的限制，vue不能检测下面变动的数组，将不会触发更新<ul>
<li>当你利用索引直接设置一个项时，例如： vm.items[indexOfItem] = newValue</li>
<li>当你修改数组的长度时，例如： vm.items.length = newLength</li>
</ul>
</li>
<li><p>解决方法</p>
<ul>
<li><p>第一种问题，可以使用Vue.set或者splice方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Vue.set</span></div><div class="line">Vue.set(example1.items, indexOfItem, newValue)</div><div class="line"><span class="comment">// splice方法</span></div><div class="line">example1.items.splice(indexOfItem, <span class="number">1</span>, newValue)</div></pre></td></tr></table></figure>
</li>
<li><p>第二种问题可以使用splice</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">example1.items.splice(newLength)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="显示过滤-排序结果"><a href="#显示过滤-排序结果" class="headerlink" title="显示过滤/排序结果"></a>显示过滤/排序结果</h3><ul>
<li>我们想要显示一个数组的过滤或排序副本，而不实际改变或重置原始数据。在这种情况下，可以创建返回过滤或排序数组的计算属性。<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">li</span> <span class="attr">v-for</span>=<span class="string">"n in evenNumbers"</span>&gt;</span>&#123;&#123; n &#125;&#125;<span class="tag">&lt;/<span class="name">li</span>&gt;</span></div><div class="line">// js</div><div class="line">data: &#123;</div><div class="line">  numbers: [ 1, 2, 3, 4, 5 ]</div><div class="line">&#125;,</div><div class="line">computed: &#123;</div><div class="line">  evenNumbers: function () &#123;</div><div class="line">    return this.numbers.filter(function (number) &#123;</div><div class="line">      return number % 2 === 0</div><div class="line">    &#125;)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="事件处理器"><a href="#事件处理器" class="headerlink" title="事件处理器"></a>事件处理器</h2><h3 id="监听事件"><a href="#监听事件" class="headerlink" title="监听事件"></a>监听事件</h3><ul>
<li><p><code>v-on</code></p>
<ul>
<li><p>使用<code>v-on</code>监听事件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-1"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"counter += 1"</span>&gt;</span>增加 1<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>这个按钮被点击了 &#123;&#123; counter &#125;&#125; 次。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>缩写</p>
<ul>
<li><code>v-on:click=&quot;xxx&quot;</code>-&gt;<code>@click=&quot;xxx&quot;</code></li>
</ul>
</li>
</ul>
</li>
<li><p>方法事件处理器</p>
<ul>
<li>为事件指定一个处理函数<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">&lt;div id=<span class="string">"example-2"</span>&gt;</div><div class="line">  <span class="xml"><span class="comment">&lt;!-- `greet` 是在下面定义的方法名 --&gt;</span></span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"greet"</span>&gt;</span>Greet<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">// js</span></div><div class="line"><span class="keyword">var</span> example2 = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#example-2'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">name</span>: <span class="string">'Vue.js'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">// 在 `methods` 对象中定义方法</span></div><div class="line">  methods: &#123;</div><div class="line">    <span class="attr">greet</span>: <span class="function"><span class="keyword">function</span> (<span class="params">event</span>) </span>&#123;</div><div class="line">      <span class="comment">// `this` 在方法里指当前 Vue 实例</span></div><div class="line">      alert(<span class="string">'Hello '</span> + <span class="keyword">this</span>.name + <span class="string">'!'</span>)</div><div class="line">      <span class="comment">// `event` 是原生 DOM 事件</span></div><div class="line">      <span class="keyword">if</span> (event) &#123;</div><div class="line">        alert(event.target.tagName)</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// 也可以用 JavaScript 直接调用方法</span></div><div class="line">example2.greet() <span class="comment">// -&gt; 'Hello Vue.js!'</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>内联处理器方法</p>
<ul>
<li><p>直接将处理逻辑写在<code>v-on:click=</code>之后</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-3"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"say('hi')"</span>&gt;</span>Say hi<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"say('what')"</span>&gt;</span>Say what<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>传递event给内联处理器需要使用$event</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">&lt;button v-on:click="warn('Form cannot be submitted yet.', $event)"&gt;</div><div class="line">  Submit</div><div class="line">&lt;/button&gt;</div><div class="line">// js</div><div class="line">methods: &#123;</div><div class="line">  warn: function (message, event) &#123;</div><div class="line">    // 现在我们可以访问原生事件对象</div><div class="line">    if (event) event.preventDefault()</div><div class="line">    alert(message)</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>事件修饰符</p>
<ul>
<li>事件中经常需要调用event.preventDefault() 或 event.stopPropagation()，为了简化操作，也为了让处理函数中只有业务逻辑没有事件相关细节，所以vue在<code>v-on:</code>上添加修饰符</li>
<li><p><code>.stop</code>,<code>.prevent</code>,<code>.capture</code>,<code>.self</code>,<code>.once</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 阻止单击事件冒泡 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click.stop</span>=<span class="string">"doThis"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 提交事件不再重载页面 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>=<span class="string">"onSubmit"</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 修饰符可以串联  --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click.stop.prevent</span>=<span class="string">"doThat"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 只有修饰符 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">v-on:submit.prevent</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 添加事件侦听器时使用事件捕获模式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:click.capture</span>=<span class="string">"doThis"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 只当事件在该元素本身（比如不是子元素）触发时触发回调 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">v-on:click.self</span>=<span class="string">"doThat"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 点击事件将只会触发一次 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">v-on:click.once</span>=<span class="string">"doThis"</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>使用修饰符时，顺序很重要；相应的代码会以同样的顺序产生。因此，用 @click.prevent.self 会阻止所有的点击，而 @click.self.prevent 只会阻止元素上的点击。</p>
</li>
</ul>
</li>
<li><p>键值修饰符</p>
<ul>
<li><p>Vue 允许为 v-on 在监听键盘事件时添加关键修饰符</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;!-- 只有在 keyCode 是 <span class="number">13</span> 时调用 vm.submit() --&gt;</div><div class="line">&lt;input v-on:keyup.13="submit"&gt;</div><div class="line">&lt;!-- 同上 --&gt;</div><div class="line">&lt;input v-on:keyup.enter="submit"&gt;</div><div class="line">&lt;!-- 缩写语法 --&gt;</div><div class="line">&lt;input @keyup.enter="submit"&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>按键别名</p>
<ul>
<li><code>.enter</code>,<code>.tab</code>,<code>.delete(捕获“删除”和“退格”键)</code>,<code>.esc</code>,<code>.space</code>,<code>.up</code>,<code>.down</code>,<code>.left</code>,<code>.right</code></li>
</ul>
</li>
<li>可以通过全局 config.keyCodes 对象自定义键值修饰符别名<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 可以使用 v-on:keyup.f1</span></div><div class="line">Vue.config.keyCodes.f1 = <span class="number">112</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>修饰键</p>
<ul>
<li><p><code>.ctrl</code>,<code>.alt</code>,<code>.shift</code>,<code>.meta</code></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;!-- Alt + C --&gt;</div><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">input</span> @<span class="attr">keyup.alt.67</span>=<span class="string">"clear"</span>&gt;</span></span></div><div class="line"><span class="comment">&lt;!-- Ctrl + Click --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">div</span> @<span class="attr">click.ctrl</span>=<span class="string">"doSomething"</span>&gt;</span>Do something<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>滑鼠按键修饰符</p>
<ul>
<li><code>.left</code>,<code>.right</code>,<code>.middle</code></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="表单控件绑定"><a href="#表单控件绑定" class="headerlink" title="表单控件绑定"></a>表单控件绑定</h2><h3 id="基础用法"><a href="#基础用法" class="headerlink" title="基础用法"></a>基础用法</h3><ul>
<li><code>v-model</code><ul>
<li><code>v-model</code>可以实现表单控件的双向绑定；它会根据控件类型自动选取正确的方法来更新元素；类似ng-model</li>
<li><code>v-model</code>会忽略所有表单元素的value、checked、selected特性的初始值。因为它会选择Vue实例数据来作为具体的值。应该通过data选项声明初始值。</li>
<li><code>v-model</code>在中文输入(IME)时不会更新，可以监听<code>input</code>事件</li>
</ul>
</li>
<li><p>简单的表单</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 文本 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"message"</span> <span class="attr">placeholder</span>=<span class="string">"edit me"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span>Message is: &#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 多行文本 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Multiline message is:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">"white-space: pre-line"</span>&gt;</span>&#123;&#123; message &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">v-model</span>=<span class="string">"message"</span> <span class="attr">placeholder</span>=<span class="string">"add multiple lines"</span>&gt;</span><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span><span class="comment">&lt;!-- 在文本区域插值( &lt;textarea&gt;&lt;/textarea&gt; ) 并不会生效，应用 v-model 来代替 --&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>复选框</p>
<ul>
<li><p>单个复选框，逻辑值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"checked"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"checkbox"</span>&gt;</span>&#123;&#123; checked &#125;&#125;<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>多个复选框，<code>v-model</code>需要绑定到同一个数组上</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"jack"</span> <span class="attr">value</span>=<span class="string">"Jack"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"jack"</span>&gt;</span>Jack<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"john"</span> <span class="attr">value</span>=<span class="string">"John"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"john"</span>&gt;</span>John<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">id</span>=<span class="string">"mike"</span> <span class="attr">value</span>=<span class="string">"Mike"</span> <span class="attr">v-model</span>=<span class="string">"checkedNames"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"mike"</span>&gt;</span>Mike<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Checked names: &#123;&#123; checkedNames &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">// js</div><div class="line">new Vue(&#123;</div><div class="line">  el: '...',</div><div class="line">  data: &#123;</div><div class="line">    checkedNames: []</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>单选按钮</p>
<ul>
<li>同一组，<code>v-model</code>需要绑定到同一个数组上<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-4"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"one"</span> <span class="attr">value</span>=<span class="string">"One"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"one"</span>&gt;</span>One<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">id</span>=<span class="string">"two"</span> <span class="attr">value</span>=<span class="string">"Two"</span> <span class="attr">v-model</span>=<span class="string">"picked"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">label</span> <span class="attr">for</span>=<span class="string">"two"</span>&gt;</span>Two<span class="tag">&lt;/<span class="name">label</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Picked: &#123;&#123; picked &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// js</div><div class="line">new Vue(&#123;</div><div class="line">  el: '#example-4',</div><div class="line">  data: &#123;</div><div class="line">    picked: ''</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>select</p>
<ul>
<li><p>单选</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-5"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span> <span class="attr">disabled</span> <span class="attr">value</span>=<span class="string">""</span>&gt;</span>请选择<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// 如果 v-model 表达初始的值不匹配任何的选项，<span class="tag">&lt;<span class="name">select</span>&gt;</span> 元素就会以”未选中”的状态渲染。在 iOS 中，这会使用户无法选择第一个选项，因为这样的情况下，iOS 不会引发 change 事件。因此，像以上提供 disabled 选项是建议的做法。</div></pre></td></tr></table></figure>
</li>
<li><p>多选列表（绑定到一个数组）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"example-6"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span> <span class="attr">multiple</span> <span class="attr">style</span>=<span class="string">"width: 50px"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>A<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>B<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">option</span>&gt;</span>C<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// js</div><div class="line">new Vue(&#123;</div><div class="line">  el: '#example-6',</div><div class="line">  data: &#123;</div><div class="line">    selected: []</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>动态选项(使用<code>v-for</code>渲染)</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-for</span>=<span class="string">"option in options"</span> <span class="attr">v-bind:value</span>=<span class="string">"option.value"</span>&gt;</span></div><div class="line">    &#123;&#123; option.text &#125;&#125;</div><div class="line">  <span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span>Selected: &#123;&#123; selected &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></div><div class="line">// js</div><div class="line">new Vue(&#123;</div><div class="line">  el: '...',</div><div class="line">  data: &#123;</div><div class="line">    selected: 'A',</div><div class="line">    options: [</div><div class="line">      &#123; text: 'One', value: 'A' &#125;,</div><div class="line">      &#123; text: 'Two', value: 'B' &#125;,</div><div class="line">      &#123; text: 'Three', value: 'C' &#125;</div><div class="line">    ]</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>绑定value</p>
<ul>
<li>对于单选按钮，勾选框及选择列表选项， v-model 绑定的 value 通常是静态字符串（对于勾选框是逻辑值）;但有时我们想绑定value到Vue实例的一个动态属性上</li>
<li><p>复选框</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"checkbox"</span> <span class="attr">v-model</span>=<span class="string">"toggle"</span> <span class="attr">v-bind:true-value</span>=<span class="string">"a"</span> <span class="attr">v-bind:false-value</span>=<span class="string">"b"</span></span></div><div class="line">&gt;</div><div class="line">// 当选中时</div><div class="line">vm.toggle === vm.a</div><div class="line">// 当没有选中时</div><div class="line">vm.toggle === vm.b</div></pre></td></tr></table></figure>
</li>
<li><p>单选按钮</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"radio"</span> <span class="attr">v-model</span>=<span class="string">"pick"</span> <span class="attr">v-bind:value</span>=<span class="string">"a"</span>&gt;</span></div><div class="line">// 当选中时</div><div class="line">vm.pick === vm.a</div></pre></td></tr></table></figure>
</li>
<li><p>select</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">v-model</span>=<span class="string">"selected"</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 内联对象字面量 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">option</span> <span class="attr">v-bind:value</span>=<span class="string">"&#123; number: 123 &#125;"</span>&gt;</span>123<span class="tag">&lt;/<span class="name">option</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line">// 当选中时</div><div class="line">typeof vm.selected // -&gt; 'object'</div><div class="line">vm.selected.number // -&gt; 123</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>v-model</code>的修饰符</p>
<ul>
<li><p><code>.lazy</code>在默认情况下， v-model 在 input 事件中同步输入框的值与数据 (除了 上述 IME 部分)，但你可以添加一个修饰符 lazy ，从而转变为在 change 事件中同步</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 在 "change" 而不是 "input" 事件中更新 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.lazy</span>=<span class="string">"msg"</span> &gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>.number</code>如果想自动将用户的输入值转为 Number 类型（如果原值的转换结果为 NaN 则返回原值），可以添加一个修饰符 number 给 v-model 来处理输入值</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.number</span>=<span class="string">"age"</span> <span class="attr">type</span>=<span class="string">"number"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>.trim</code>如果要自动过滤用户输入的首尾空格，可以添加 trim 修饰符到 v-model 上过滤输入</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model.trim</span>=<span class="string">"msg"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="组件"><a href="#组件" class="headerlink" title="组件"></a>组件</h2><p>vue中的组件很类似ng1中的directive，通过自定义的html元素扩展功能</p>
<h3 id="使用组件"><a href="#使用组件" class="headerlink" title="使用组件"></a>使用组件</h3><ul>
<li><p>注册</p>
<ul>
<li><p>全局注册</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// Vue.component('组件名',选项对象 );// 选项对象和new Vue()中的几乎一样，只有个别属性使用不一样；</span></div><div class="line"><span class="comment">//组件名建议使用kebab-case(短横线隔开式)连接，不要使用camelCased(驼峰式)，因为html特性不区分大小写，类似ng1中的directive命名，为方便，同意使用kebab-case形式</span></div><div class="line"><span class="comment">// Vue.component()；不存在类似函数的声明提升机制，所以全局组件必须在根实例之前注册</span></div><div class="line">&lt;div id=<span class="string">"example"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">my-component</span>&gt;</span><span class="tag">&lt;/<span class="name">my-component</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="comment">// 注册-&gt;在创建根实例之前注册</span></div><div class="line">Vue.component(<span class="string">'my-component'</span>, &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;A custom component!&lt;/div&gt;'</span> <span class="comment">// template必须只有一个跟节点，类似ng1</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// 创建根实例</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#example'</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">// 渲染为</span></div><div class="line">&lt;div id=<span class="string">"example"</span>&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">div</span>&gt;</span>A custom component!<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span> <span class="comment">// vue中自定义元素将直接被替换，类似ng1中定义指令时配置了replace:true</span></div><div class="line">&lt;<span class="regexp">/div&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>局部注册</p>
<ul>
<li>通过使用组件选项对象中的components来注册，让其仅在一个实例/组件的作用域中可用<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> Child = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;A custom component!&lt;/div&gt;'</span></div><div class="line">&#125;;</div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>:<span class="string">'#test'</span>,</div><div class="line">  <span class="attr">components</span>: &#123;</div><div class="line">    <span class="comment">// &lt;my-component&gt; 将只在父模板可用(#test实例的范围中使用)</span></div><div class="line">    <span class="string">'my-component'</span>: Child</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>is</code></p>
<ul>
<li><p>在现有html上添加功能，类似ng1指令中的<code>restrict:A</code>-&gt;因为html的限制，某些标签下只能出现特定的标签，出现其他标签视为无效，如<code>select</code>下只能是<code>option</code>；所以变通的方法是采用<code>is</code>特性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 无效</span></div><div class="line">&lt;table&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">my-row</span>&gt;</span>...<span class="tag">&lt;/<span class="name">my-row</span>&gt;</span></span></div><div class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line"><span class="comment">// 有效</span></div><div class="line">&lt;table&gt;</div><div class="line">  <span class="xml"><span class="tag">&lt;<span class="name">tr</span> <span class="attr">is</span>=<span class="string">"my-row"</span>&gt;</span><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></span></div><div class="line">&lt;<span class="regexp">/table&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>下来源之一的字符串模板，此限制将不适用：</p>
<ul>
<li><code>&lt;script type=&quot;text/x-template&quot;&gt;</code></li>
<li>JavaScript 内联模版字符串</li>
<li><code>.vue</code>组件</li>
</ul>
</li>
</ul>
</li>
<li><code>data</code>必须是函数<ul>
<li>通过 Vue 构造器传入的各种选项大多数都可以在组件里用。<code>data</code>是一个例外，它必须是函数，若不是函数，Vue将发出警告</li>
<li>如果通过<code>data</code>函数返回一个对象(引用值)，那么注册的所有组件都将共用这个对象<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;div id=<span class="string">"example-2"</span>&gt;</div><div class="line">  &lt;simple-counter&gt;&lt;/simple-counter&gt;</div><div class="line">  &lt;simple-counter&gt;&lt;/simple-counter&gt;</div><div class="line">  &lt;simple-counter&gt;&lt;/simple-counter&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">var data = &#123; counter: 0 &#125;;</div><div class="line">Vue.component('simple-counter', &#123;</div><div class="line">  template: '&lt;button v-on:click="counter += 1"&gt;&#123;&#123; counter &#125;&#125;&lt;/button&gt;',</div><div class="line">  // 技术上 data 的确是一个函数了，因此 Vue 不会警告，</div><div class="line">  // 但是我们返回给每个组件的实例的却引用了同一个data对象</div><div class="line">  data: function () &#123;</div><div class="line">    return data</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">new Vue(&#123;</div><div class="line">  el: '#example-2'</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>父子组件如何通信</p>
<ul>
<li>props down, events up;<ul>
<li>父组件通过子组件的props接口，将数据传递给子组件；子组件通过事件的形式给父组件发送消息<img src="/2017/08/01/Vue-guide/props-events.png" alt=""></li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="proprs"><a href="#proprs" class="headerlink" title="proprs"></a>proprs</h3><ul>
<li><p><strong>组件期望获得的数据</strong>，有点类似ng1指令中的scope属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">Vue.component(<span class="string">'child'</span>, &#123;</div><div class="line">  <span class="comment">// 声明 props</span></div><div class="line">  props: [<span class="string">'message'</span>],</div><div class="line">  <span class="comment">// 就像 data 一样，prop 可以用在模板内</span></div><div class="line">  <span class="comment">// 同样也可以在 vm 实例中像“this.message”这样使用</span></div><div class="line">  template: <span class="string">'&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;'</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">// 通过child组件的message接口将数据传入</span></div><div class="line">&lt;child message=<span class="string">"hello!"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">child</span>&gt;</span></span></div></pre></td></tr></table></figure>
</li>
<li><p>动态prop</p>
<ul>
<li><p>在模板中，要动态地绑定父组件的数据到子模板的 props，与绑定到任何普通的HTML特性相类似，就是用 v-bind。每当父组件的数据变化时，该变化也会传导给子组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"parentMsg"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">br</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">child</span> <span class="attr">v-bind:my-message</span>=<span class="string">"parentMsg"</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>用v-bind绑定的数据发生发生变化时，会将变化传导到子组件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">child</span> <span class="attr">message</span>=<span class="string">'纯文本'</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">child</span> <span class="attr">message</span>=<span class="string">'test1'</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">child</span> <span class="attr">message</span>=<span class="string">'test2'</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">child</span> <span class="attr">v-bind:message</span>=<span class="string">'test2'</span>&gt;</span><span class="tag">&lt;/<span class="name">child</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button</span>&gt;</span>点击<span class="tag">&lt;/<span class="name">button</span>&gt;</span></div><div class="line">var vm = new Vue(&#123;</div><div class="line">    el: '#app',</div><div class="line">    data: &#123;</div><div class="line">        test1: '我是变量1',</div><div class="line">        test2: '我是变量2'</div><div class="line">    &#125;,</div><div class="line">    components: &#123;</div><div class="line">        'child': &#123;</div><div class="line">            props: ['message'],</div><div class="line">            template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;message&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>'</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">document.querySelector('button').onclick = function() &#123;</div><div class="line">    vm.test2 = '我是变量2，我被改变了';</div><div class="line">    console.log(vm);</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
</li>
<li><p>不要使用字面量形式传递数值，使用v-bind将其转化成表达式；下面例子，因为它是一个字面 prop，它的值是字符串 “1” 而不是 number。如果想传递一个实际的 number，需要使用 v-bind，从而让它的值被当作 JavaScript 表达式计算</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 传递了一个字符串 "1" --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">some-prop</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 传递实际的 number --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">v-bind:some-prop</span>=<span class="string">"1"</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>单向数据流</p>
<ul>
<li>prop是单向的，只能父传递到子，反之则不行</li>
<li>父组件更新时，子组件的所有prop也将得到更新</li>
<li><p>遇到下面情况，可能需要修改prop中的数据</p>
<ul>
<li><p>prop 作为初始值传入后，子组件想把它当作局部数据来用</p>
<ul>
<li>解决方法<ul>
<li>定义一个局部变量，并用 prop 的值初始化它<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">props: [<span class="string">'initialCounter'</span>],</div><div class="line"><span class="attr">data</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> &#123; <span class="attr">counter</span>: <span class="keyword">this</span>.initialCounter &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>prop 作为初始值传入，由子组件处理成其它数据输出</p>
<ul>
<li>解决方法<ul>
<li>定义一个计算属性，处理 prop 的值并返回<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">props: [<span class="string">'size'</span>],</div><div class="line"><span class="attr">computed</span>: &#123;</div><div class="line">  <span class="attr">normalizedSize</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.size.trim().toLowerCase()</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>注意在 JavaScript 中对象和数组是引用类型，指向同一个内存空间，如果 prop 是一个对象或数组，在子组件内部改变它会影响父组件的状态。</p>
</li>
</ul>
</li>
<li><p>prop验证</p>
<ul>
<li><p>有时需要对传入组件的数据先进行验证再操作</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line">Vue.component(<span class="string">'example'</span>, &#123;</div><div class="line">  <span class="attr">props</span>: &#123;</div><div class="line">    <span class="comment">// 基础类型检测 (`null` 意思是任何类型都可以)</span></div><div class="line">    propA: <span class="built_in">Number</span>,</div><div class="line">    <span class="comment">// 多种类型</span></div><div class="line">    propB: [<span class="built_in">String</span>, <span class="built_in">Number</span>],</div><div class="line">    <span class="comment">// 必传且是字符串</span></div><div class="line">    propC: &#123;</div><div class="line">      <span class="attr">type</span>: <span class="built_in">String</span>,</div><div class="line">      <span class="attr">required</span>: <span class="literal">true</span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 数字，有默认值</span></div><div class="line">    propD: &#123;</div><div class="line">      <span class="attr">type</span>: <span class="built_in">Number</span>,</div><div class="line">      <span class="attr">default</span>: <span class="number">100</span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 数组/对象的默认值应当由一个工厂函数返回</span></div><div class="line">    propE: &#123;</div><div class="line">      <span class="attr">type</span>: <span class="built_in">Object</span>,<span class="comment">// 注意是构造器，并不是字符串</span></div><div class="line">      <span class="keyword">default</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">message</span>: <span class="string">'hello'</span> &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 自定义验证函数</span></div><div class="line">    propF: &#123;</div><div class="line">      <span class="attr">validator</span>: <span class="function"><span class="keyword">function</span> (<span class="params">value</span>) </span>&#123;</div><div class="line">        <span class="keyword">return</span> value &gt; <span class="number">10</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>验证时的type可以是:String、Number、Boolean、Function、Object、Array、Symbol</p>
<ul>
<li>注意是构造器，不是字符串<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 这样是错误的</span></div><div class="line">type:<span class="string">'Boolean'</span></div><div class="line"><span class="comment">// 这样是对的</span></div><div class="line">type:<span class="built_in">Boolean</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>当 prop 验证失败，Vue 会在抛出警告 (如果使用的是开发版本)。注意 props 会在组件实例创建之前进行校验，所以<strong>在 default 或 validator 函数里，诸如 data、computed 或 methods 等实例属性还无法使用</strong>。</p>
</li>
</ul>
</li>
</ul>
<h3 id="非Prop属性"><a href="#非Prop属性" class="headerlink" title="非Prop属性"></a>非Prop属性</h3><ul>
<li>所谓非 prop 属性，就是它可以直接传入组件，而不需要定义相应的 prop。</li>
<li>明确给组件定义 prop 是传参的推荐方式</li>
<li><p><strong>非prop属性，将会被自动添加到模板的根元素上</strong></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 有个非prop属性，data-3d-data-picker --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bs-date-input</span> <span class="attr">data-3d-date-picker</span>=<span class="string">"true"</span>&gt;</span><span class="tag">&lt;/<span class="name">bs-date-input</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- bs-data-input的模板 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 渲染后 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">class</span>=<span class="string">"form-control"</span> <span class="attr">data-3d-date-picker</span>=<span class="string">"true"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>替换/覆盖现有的特性</p>
<ul>
<li>默认情况下，在发生特性冲突时，会采取覆盖策略，传递给组件的值会覆盖组件本身设定的值。即例如传递 type=”large” 将会覆盖 type=”date” </li>
<li>class和style特性，在发生冲突时，会采取合并策略，而不是覆盖策略<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bs-date-input</span> <span class="attr">type</span>=<span class="string">"num"</span> <span class="attr">data-3d-date-picker</span>=<span class="string">"true"</span> <span class="attr">class</span>=<span class="string">"date-picker-theme-dark"</span>&gt;</span><span class="tag">&lt;/<span class="name">bs-date-input</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 模板 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"date"</span> <span class="attr">class</span>=<span class="string">"form-control"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 渲染后，传进来的type覆盖了原先的type，class实现了合并 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"num"</span> <span class="attr">class</span>=<span class="string">"form-control date-picker-theme-dark"</span> <span class="attr">data-3d-date-picker</span>=<span class="string">"true"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="自定义事件"><a href="#自定义事件" class="headerlink" title="自定义事件"></a>自定义事件</h3><ul>
<li>可以通过props向子组件传递数据，子组件可以通过<strong>自定义事件</strong>向父组件发消息</li>
<li>每个vue实例都实现了事件接口<ul>
<li>vm.$on(eventName)监听事件</li>
<li>vm.$emit(eventName)触发事件</li>
</ul>
</li>
<li><strong>父组件可以在使用子组件的地方直接用<code>v-on</code>来监听子组件触发的自定义事件</strong>，注意在子组件的自定义标签上直接使用<code>v-on</code>只能绑定子组件<strong>主动分发(通过$emit触发)的事件</strong>，这是一种特殊写法,告诉父组件要监听某个自定义事件。如果想直接使用<code>v-on</code>为子组件绑定事件，将无法触发；例子见下一小节</li>
<li><p>不能用 $on 侦听子组件抛出的事件，而必须在模板里直接用 v-on 绑定</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"counter-event-example"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>&#123;&#123; total &#125;&#125;<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 这里的v-on:increment="incrementTotal"，其实在告诉父组件(这里是根实例)要监听increment事件了 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:increment</span>=<span class="string">"incrementTotal"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// js</div><div class="line">Vue.component('button-counter', &#123;</div><div class="line">  template: '<span class="tag">&lt;<span class="name">button</span> <span class="attr">v-on:click</span>=<span class="string">"incrementCounter"</span>&gt;</span>&#123;&#123; counter &#125;&#125;<span class="tag">&lt;/<span class="name">button</span>&gt;</span>',</div><div class="line">  data: function () &#123;</div><div class="line">    return &#123;</div><div class="line">      counter: 0</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    incrementCounter: function () &#123;</div><div class="line">      this.counter += 1;</div><div class="line">      this.$emit('increment');// 分发'increment'自定义事件</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">&#125;);</div><div class="line">new Vue(&#123;</div><div class="line">  el: '#counter-event-example',</div><div class="line">  data: &#123;</div><div class="line">    total: 0</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    incrementTotal: function () &#123;// 接收到子组件分发'increment'自定义事件后触发</div><div class="line">      this.total += 1</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">// 在v1版本中，子组件分发的自定义事件的触发函数是写在父组件的events中;</div><div class="line">// 这样写，有个不好的地方就是父组件不知道这个事件到底是哪个子组件分发的，如果多个子组件分发了同个自定义事件，就无法分辨。</div><div class="line">// 所以作者为了清晰的知道具体是哪个组件分发了事件，就将v-on移到了子组件的自定义标签上</div><div class="line">// https://v1.vuejs.org/guide/components.html#Custom-Events</div><div class="line">// https://segmentfault.com/q/1010000004486740/a-1020000004487413</div></pre></td></tr></table></figure>
</li>
<li><p>给组件绑定原生事件</p>
<ul>
<li>有时候，你可能想在某个组件的根元素上监听一个原生事件。</li>
<li>注意：在子组件的自定义标签上直接使用v-on:mouseenter，这种事件是无法直接触发的(只有子组件主动$emit了mouseenter事件，才会触发)，<strong>在子组件上直接使用<code>v-on</code>绑定的只能是子组件主动分发的事件，它是在告诉父组件要监听某个自定义事件，是一种特殊写法</strong>；</li>
<li><p>想为某个组件绑定一个原生事件(在某个组件的根元素上监听一个原生事件)，必须在自定义标签上使用<code>v-on:事件.native=xxx</code></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 这个mouseenter绑定的回调无法触发，除非子组件主动$emit了mouseenter，count才会被调用 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:child_increment</span>=<span class="string">"incrementTotal"</span> <span class="attr">v-on:mouseenter</span>=<span class="string">"count"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- v-on:mouseenter.native这种写法，给button-counter的根标签绑定了一个原生mouseenter事件，鼠标移入，就会触发count --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">button-counter</span> <span class="attr">v-on:child_increment</span>=<span class="string">"incrementTotal"</span> <span class="attr">v-on:mouseenter.native</span>=<span class="string">"count"</span>&gt;</span><span class="tag">&lt;/<span class="name">button-counter</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>小结</p>
<ul>
<li>子组件的自定义标签上直接使用<code>v-on</code>只适合子组件发消息给父组件这种情况，并且需要子组件主动$emit配合，经过这两步才能完成子组件给父组发消息，具体步骤如下<ul>
<li>子组件的自定义标签上直接使用<code>v-on:子组件主动分发的事件名=xxx</code></li>
<li>子组件在条件合适时主动$emit(事件名)</li>
</ul>
</li>
<li>想在子组件自定义标签上直接使用<code>v-on</code>给组件根元素绑定事件，必须添加<code>.native</code>修饰符</li>
</ul>
</li>
</ul>
</li>
<li><p>双向绑定<code>.sync</code></p>
<ul>
<li>当一个子组件改变了一个 prop 的值时，这个变化也会同步到父组件中所绑定的值。<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">:foo.sync</span>=<span class="string">"bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 本质为下面的 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">comp</span> <span class="attr">:foo</span>=<span class="string">"bar"</span> @<span class="attr">update:foo</span>=<span class="string">"val =&gt; bar = val"</span>&gt;</span><span class="tag">&lt;/<span class="name">comp</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 子组件值变化时，主动触发update事件 --&gt;</span></div><div class="line">this.$emit('update:foo', newValue)</div><div class="line"><span class="comment">&lt;!-- 其实这里的.sync也佐证了自定义标签上直接使用v-on绑定的事件，需要配合$emit才能触发 --&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>v-model</code></p>
<ul>
<li><p><code>v-model</code>常用来针对表单实行双向数据绑定，它的本质是个语法糖；value属性+input事件</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-model</span>=<span class="string">"something"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 本质如下 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">v-bind:value</span>=<span class="string">"something"</span> <span class="attr">v-on:input</span>=<span class="string">"something = $event.target.value"</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>创建自定义input组件时</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 下面2种效果一样 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">currency-input</span> <span class="attr">v-model</span>=<span class="string">"price"</span>&gt;</span><span class="tag">&lt;/<span class="name">currency-input</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">currency-input</span> <span class="attr">v-bind:value</span>=<span class="string">"price"</span> <span class="attr">v-on:input</span>=<span class="string">"price = arguments[0]"</span>&gt;</span><span class="tag">&lt;/<span class="name">currency-input</span>&gt;</span></div><div class="line"></div><div class="line">Vue.component('currency-input', &#123;</div><div class="line">    template: '<span class="tag">&lt;<span class="name">span</span>&gt;</span>$<span class="tag">&lt;<span class="name">input</span> <span class="attr">ref</span>=<span class="string">"input"</span> <span class="attr">v-bind:value</span>=<span class="string">"value"</span> <span class="attr">v-on:input</span>=<span class="string">"updateValue($event.target.value)"</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>',</div><div class="line">    props: &#123;</div><div class="line">        value: Number</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        // 不是直接更新值，而是使用此方法来对输入值进行格式化和位数限制</div><div class="line">        updateValue: function(value) &#123;</div><div class="line">            var formattedValue = value</div><div class="line">                // 删除两侧的空格符</div><div class="line">                .trim()</div><div class="line">                // 保留 2 小数位</div><div class="line">                .slice(</div><div class="line">                    0,</div><div class="line">                    value.indexOf('.') === -1 ?</div><div class="line">                    value.length :</div><div class="line">                    value.indexOf('.') + 3</div><div class="line">                )</div><div class="line">            // 如果值不统一，手动覆盖以保持一致</div><div class="line">            if (formattedValue !== value) &#123;</div><div class="line">                this.$refs.input.value = formattedValue</div><div class="line">            &#125;</div><div class="line">            // 通过 input 事件发出数值</div><div class="line">            this.$emit('input', Number(formattedValue))</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line">var vm = new Vue(&#123;</div><div class="line">    el: '#app',</div><div class="line">    data: &#123;</div><div class="line">        price: 3</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>定制<code>v-model</code></p>
<ul>
<li>从上节可知，<code>v-model</code>需要使用到表单的value属性和input事件，但单选、复选之类的表单会把value用做别的目的；此时使用组件选项对象的model选项即可避免冲突<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Vue.component(<span class="string">'my-checkbox'</span>, &#123;</div><div class="line">  <span class="attr">model</span>: &#123;<span class="comment">// v-model使用checked属性和change事件完成双向绑定，而不用原来的value属性和input属性</span></div><div class="line">    prop: <span class="string">'checked'</span>,</div><div class="line">    <span class="attr">event</span>: <span class="string">'change'</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">props</span>: &#123;</div><div class="line">    <span class="attr">checked</span>: <span class="built_in">Boolean</span>,</div><div class="line">    <span class="comment">// this allows using the `value` prop for a different purpose，value属性可以用做其他用途</span></div><div class="line">    value: <span class="built_in">String</span></div><div class="line">  &#125;,</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div><div class="line"></div><div class="line">&lt;my-checkbox v-model="foo" value="some value"&gt;&lt;/my-checkbox&gt;</div><div class="line">&lt;!-- 等价于 --&gt;</div><div class="line">&lt;my-checkbox</div><div class="line">  :checked="foo"</div><div class="line">  @change="val =&gt; &#123; foo = val &#125;"</div><div class="line">  value="some value"&gt;</div><div class="line">&lt;/my-checkbox&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>非父子组件通信</p>
<ul>
<li><p>有时，非父子关系的组件也需要通信，这时需要一个中介来传递信息，在简单的场景下，可以使用一个空的 Vue 实例作为中央事件总线</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> bus = <span class="keyword">new</span> Vue();</div><div class="line"><span class="comment">// 触发组件 A 中的事件</span></div><div class="line">bus.$emit(<span class="string">'id-selected'</span>, <span class="number">1</span>);</div><div class="line"><span class="comment">// 在组件 B 创建的钩子中监听事件</span></div><div class="line">bus.$on(<span class="string">'id-selected'</span>, <span class="function"><span class="keyword">function</span> (<span class="params">id</span>) </span>&#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>案例</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">my-num</span> <span class="attr">:init-num</span>=<span class="string">"price"</span>&gt;</span><span class="tag">&lt;/<span class="name">my-num</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">my-div</span>&gt;</span><span class="tag">&lt;/<span class="name">my-div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"></div><div class="line">Vue.component('my-num', &#123;</div><div class="line">    template: '<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"num"</span> <span class="attr">v-model</span>=<span class="string">"num"</span> @<span class="attr">input</span>=<span class="string">"numChanged"</span>&gt;</span>',</div><div class="line">    props: &#123;</div><div class="line">        'initNum': &#123;</div><div class="line">            type: Number</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    data: function() &#123;</div><div class="line">        return &#123;</div><div class="line">            num: this.initNum</div><div class="line">        &#125;;</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        numChanged: function() &#123;</div><div class="line">            console.log(this.num);</div><div class="line">            bus.$emit('my-num-change', this.num); // 通过bus触发my-num-change</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">Vue.component('my-div', &#123;</div><div class="line">    template: '<span class="tag">&lt;<span class="name">h1</span>&gt;</span>&#123;&#123;text&#125;&#125;<span class="tag">&lt;/<span class="name">h1</span>&gt;</span>',</div><div class="line">    data: function() &#123;</div><div class="line">        return &#123;</div><div class="line">            text: '我将展示上面input的内容'</div><div class="line">        &#125;;</div><div class="line">    &#125;,</div><div class="line">    created: function() &#123; // 创建后</div><div class="line">        var _self = this;</div><div class="line">        bus.$on('my-num-change', function(str) &#123; // 监听my-num-change事件</div><div class="line">            _self.text = str;</div><div class="line">        &#125;);</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">var bus = new Vue();</div><div class="line"></div><div class="line">var vm = new Vue(&#123;</div><div class="line">    el: '#app',</div><div class="line">    data: &#123;</div><div class="line">        price: 3</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="使用Slot分发内容"><a href="#使用Slot分发内容" class="headerlink" title="使用Slot分发内容"></a>使用Slot分发内容</h3><p>类似ng1中指令的transclude，用来混合<strong>父组件的内容</strong>和<strong>子组件的模板</strong></p>
<ul>
<li><p>编译作用域</p>
<ul>
<li><strong>父组件模板的内容在父组件作用域内编译</strong>；<strong>子组件模板的内容在子组件作用域内编译</strong>。<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">// message将在父组件/实例的作用域中编译，因为&#123;&#123;message&#125;&#125;实际是在父组件模板的内容中，而不是在子组件的模板内容中</div><div class="line">&lt;child-component&gt;</div><div class="line">  &#123;&#123; message &#125;&#125;</div><div class="line">&lt;/child-component&gt;</div><div class="line"></div><div class="line">// 下例&#123;&#123;test&#125;&#125;、&#123;&#123;test2&#125;&#125;都将在根实例的作用域下编译</div><div class="line">&lt;div id="app"&gt;</div><div class="line">    &lt;parent-comp&gt;</div><div class="line">        &#123;&#123;test&#125;&#125;</div><div class="line">        &lt;br&gt;</div><div class="line">        &lt;child-comp&gt;</div><div class="line">            &#123;&#123;test2&#125;&#125;</div><div class="line">        &lt;/child-comp&gt;</div><div class="line">    &lt;/parent-comp&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">// 假设someChildProperty是子组件上的属性，下面例子无效，将在父组件/实例的作用域中查找someChildProperty，你必须在child-component作用域中使用someChildProperty</div><div class="line">&lt;child-component v-show="someChildProperty"&gt;&lt;/child-component&gt;</div><div class="line"></div><div class="line">// 下面有效</div><div class="line">Vue.component('child-component', &#123;</div><div class="line">  // 有效，因为是在正确的作用域内</div><div class="line">  template: '&lt;div v-show="someChildProperty"&gt;Child&lt;/div&gt;',</div><div class="line">  data: function () &#123;</div><div class="line">    return &#123;</div><div class="line">      someChildProperty: true</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>分发内容</p>
<ul>
<li>父组件/实例中嵌套在子组件自定义便签中的内容都称为分发内容</li>
<li>分发内容是在父作用域内编译</li>
<li>分发内容适合混合/嵌套多个组件时使用<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- &#123;&#123;message&#125;&#125;属于分发内容，他将在child-component的父作用域中编译 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">child-component</span>&gt;</span></div><div class="line">  &#123;&#123; message &#125;&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">child-component</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>slot</code></p>
<ul>
<li><strong>除非子组件模板包含至少一个<code>&lt;slot&gt;</code>插口，否则父组件的内容将会被丢弃</strong>。类似ng1中directive模板中会指定一个标签，添加<code>ng-transclude</code>特性一样，这个标签将接收在父作用域中编译好的分发内容</li>
<li>当子组件模板只有一个没有属性的slot时，父组件整个内容片段将插入到slot所在的DOM位置，并替换掉slot标签本身</li>
<li>最初在 <slot> 标签中的任何内容都被视为备用内容。备用内容在子组件的作用域内编译，并且只有在宿主元素为空，且没有要插入的内容时才显示备用内容。<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">// 父组件模板</div><div class="line"> &lt;div&gt;</div><div class="line">  &lt;h1&gt;我是父组件的标题&lt;/h1&gt;</div><div class="line">  &lt;my-component&gt;</div><div class="line">    &lt;p&gt;这是一些初始内容&lt;/p&gt;</div><div class="line">    &lt;p&gt;这是更多的初始内容&lt;/p&gt;</div><div class="line">  &lt;/my-component&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">// 子组件my-component的模板</div><div class="line">&lt;div&gt;</div><div class="line">  &lt;h2&gt;我是子组件的标题&lt;/h2&gt;</div><div class="line">  &lt;slot&gt;</div><div class="line">    只有在没有要分发的内容时才会显示。&lt;slot&gt;整个标签将被分发内容替换</div><div class="line">  &lt;/slot&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">// 渲染后</div><div class="line">&lt;div&gt;</div><div class="line">  &lt;h1&gt;我是父组件的标题&lt;/h1&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;h2&gt;我是子组件的标题&lt;/h2&gt;</div><div class="line">    &lt;!-- 下面是分发内容替换了&lt;slot&gt; --&gt;</div><div class="line">    &lt;p&gt;这是一些初始内容&lt;/p&gt;</div><div class="line">    &lt;p&gt;这是更多的初始内容&lt;/p&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/div&gt;</div></pre></td></tr></table></figure>
</slot></li>
</ul>
</li>
<li><p>具名<code>slot</code></p>
<ul>
<li><code>&lt;slot&gt;</code>元素可以用一个特殊的属性 name 来配置如何分发内容。多个 slot 可以有不同的名字。具名 slot 将匹配内容片段中有对应 slot 特性的元素</li>
<li>仍然可以有一个匿名 slot，它是默认 slot，作为找不到匹配的内容片段的备用插槽。如果没有默认的 slot，这些找不到匹配的内容片段将被抛弃。</li>
<li><strong>子组件模板上有个<code>&lt;slot&gt;</code>标签，通过标签上的name属性来给<code>&lt;slot&gt;</code>起个名字，分发内容上有个slot特性，通过这个slot特性的值找到子组件中对应名字的<code>&lt;slot&gt;</code>标签，并用分发内容将其替换掉。</strong><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">// app-layout组件</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"header"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span> // 这里将要放名字为header的分发内容</div><div class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span>// 这里将要找不到匹配的分发内容</div><div class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"footer"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span>// 这里将要放名字为footer的分发内容</div><div class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">// 父组件模板</div><div class="line"><span class="tag">&lt;<span class="name">app-layout</span>&gt;</span>// 这里面的都是分发内容</div><div class="line">  <span class="tag">&lt;<span class="name">h1</span> <span class="attr">slot</span>=<span class="string">"header"</span>&gt;</span>这里可能是一个页面标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span> // 这个将放到header的slot中</div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>主要内容的一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span>&gt;</span>另一个主要段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">p</span> <span class="attr">slot</span>=<span class="string">"footer"</span>&gt;</span>这里有一些联系信息<span class="tag">&lt;/<span class="name">p</span>&gt;</span>// 这个将放到footer的slot中</div><div class="line"><span class="tag">&lt;/<span class="name">app-layout</span>&gt;</span></div><div class="line">// 渲染后</div><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"container"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">header</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>这里可能是一个页面标题<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">header</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">main</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>主要内容的一个段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>另一个主要段落。<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">main</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">footer</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span>这里有一些联系信息<span class="tag">&lt;/<span class="name">p</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">footer</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>作用域插槽(Scoped Slot)</p>
<ul>
<li>正常情况下，分发内容是在父组件的作用域中编译的；考虑下面情况:我们需要创建一个组件，能使用同一份数据，根据DOM的不同渲染出不一样的界面；同一个组件，有不同的DOM结构，我们肯定不能将DOM结构固死在组件内部，肯定需要外部传入，我们很快就想到需要使用分发内容和Slot来完成，但这样会出现一个问题。我们的DOM结构是通过分发内容传入组件内部的，但是分发内容在传入子组件时，已经在父组件的作用域中编译过了，也就是说它用的数据是父组件的而不是子组件的。Scoped Slot就能解决这一问题，它能让分发内容在传入子组件前使用子组件的数据；以前分发内容只能在父组件作用域中编译，根本无法使用到子组件的数据，现在使用Scoped Slot能实现分发内容使用子组件的数据编译。这样能提高组件的复用性。</li>
<li>如何使用<ul>
<li>在子组件模板<code>&lt;slot&gt;</code>标签上绑定需要暴露的数据(提供给父组件使用的数据)，这些数据会被封装到一个对象上，传递给父级</li>
<li>在父级上，必须有一个包含<code>scope</code>属性的<code>&lt;template&gt;</code>元素，表示它是作用域插槽的模板</li>
<li><code>scope</code>的值对应一个临时变量名，此变量接收从子组件中传递过来的对象</li>
</ul>
</li>
<li>实际例子<ul>
<li>现在要实现一个列表组件，可以让用户自定义DOM结构<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">my-awesome-list</span> <span class="attr">:items</span>=<span class="string">"items"</span>&gt;</span></div><div class="line">        <span class="comment">&lt;!-- 作用域插槽也可以是具名的,componProp就是子组件传递过来的对象 --&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">slot</span>=<span class="string">"list-item"</span> <span class="attr">scope</span>=<span class="string">"componProp"</span>&gt;</span></div><div class="line">            <span class="comment">&lt;!-- 这里我可以使用任意的结构来渲染list --&gt;</span></div><div class="line">            <span class="comment">&lt;!-- &lt;h1&gt;&#123;&#123; componProp.text &#125;&#125;&lt;/h1&gt; --&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"font-style: italic;"</span>&gt;</span>&#123;&#123; componProp.text &#125;&#125;<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">my-awesome-list</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    </div><div class="line">Vue.component('my-awesome-list', &#123;</div><div class="line">    props: &#123;</div><div class="line">        items: &#123;</div><div class="line">            type: Array,</div><div class="line">            required: true</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    template: '<span class="tag">&lt;<span class="name">div</span>&gt;</span><span class="tag">&lt;<span class="name">slot</span> <span class="attr">name</span>=<span class="string">"list-item"</span>  <span class="attr">v-for</span>=<span class="string">"item in items"</span>  <span class="attr">:text</span>=<span class="string">"item.text"</span>&gt;</span><span class="tag">&lt;/<span class="name">slot</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span>'// 暴露text给分发内容使用</div><div class="line">&#125;);</div><div class="line">    </div><div class="line">var vm = new Vue(&#123;</div><div class="line">    el: '#app',</div><div class="line">    data: &#123;</div><div class="line">        items: [&#123;</div><div class="line">            text: '11111'</div><div class="line">        &#125;, &#123;</div><div class="line">            text: '22222'</div><div class="line">        &#125;]</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="动态组件"><a href="#动态组件" class="headerlink" title="动态组件"></a>动态组件</h3><ul>
<li><p>通过使用保留的 <component> 元素，动态地绑定到它的 is 特性，我们让多个组件可以使用同一个挂载点，并动态切换</component></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">component</span> <span class="attr">v-bind:is</span>=<span class="string">"currentView"</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 组件在 vm.currentview 变化时改变！ --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">component</span>&gt;</span></div><div class="line"></div><div class="line">var vm = new Vue(&#123;</div><div class="line">  el: '#example',</div><div class="line">  data: &#123;</div><div class="line">    currentView: 'home'</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    home: &#123; /* ... */ &#125;,</div><div class="line">    posts: &#123; /* ... */ &#125;,</div><div class="line">    archive: &#123; /* ... */ &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>也可以直接绑定到组件对象上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var Home = &#123;</div><div class="line">  template: &apos;&lt;p&gt;Welcome home!&lt;/p&gt;&apos;</div><div class="line">&#125;</div><div class="line">var vm = new Vue(&#123;</div><div class="line">  el: &apos;#example&apos;,</div><div class="line">  data: &#123;</div><div class="line">    currentView: Home</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>动态组件配合使用<code>&lt;keep-alive&gt;</code>来缓存非活动组件，避免重新渲染</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;keep-alive&gt;</div><div class="line">  &lt;component :is=&quot;currentView&quot;&gt;</div><div class="line">    &lt;!-- 非活动组件将被缓存！ --&gt;</div><div class="line">  &lt;/component&gt;</div><div class="line">&lt;/keep-alive&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="杂项"><a href="#杂项" class="headerlink" title="杂项"></a>杂项</h3><ul>
<li>编写可复用组件<ul>
<li>Props 允许外部环境传递数据给组件</li>
<li>Events 允许从外部环境在组件内触发副作用</li>
<li>Slots 允许外部环境将额外的内容组合在组件中</li>
</ul>
</li>
<li><p>子组件索引</p>
<ul>
<li><p>尽管有 props 和 events，但是有时仍然需要在 JavaScript 中直接访问子组件。为此可以使用 ref 为子组件指定一个索引 ID</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"parent"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">user-profile</span> <span class="attr">ref</span>=<span class="string">"profile"</span>&gt;</span><span class="tag">&lt;/<span class="name">user-profile</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">var parent = new Vue(&#123; el: '#parent' &#125;);</div><div class="line">// 访问子组件</div><div class="line">var child = parent.$refs.profile</div></pre></td></tr></table></figure>
</li>
<li><p>当 ref 和 v-for 一起使用时，ref 是一个数组，包含相应的子组件</p>
</li>
<li>$refs 只在组件渲染完成后才填充，并且它是非响应式的。它仅仅作为一个直接访问子组件的应急方案——应当避免在模版或计算属性中使用 $refs。</li>
</ul>
</li>
<li><p>异步组件</p>
<ul>
<li><p>在大型应用中，我们可能需要将应用拆分为多个小模块，按需从服务器下载。为了让事情更简单，Vue.js 允许将组件定义为一个工厂函数，动态地解析组件的定义。Vue.js 只在组件需要渲染时触发工厂函数，并且把结果缓存起来，用于后面的再次渲染。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;async-example&apos;, function (resolve, reject) &#123;</div><div class="line">  setTimeout(function () &#123;</div><div class="line">    // Pass the component definition to the resolve callback</div><div class="line">    resolve(&#123;</div><div class="line">      template: &apos;&lt;div&gt;I am async!&lt;/div&gt;&apos;</div><div class="line">    &#125;)</div><div class="line">  &#125;, 1000)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>工厂函数接收一个 resolve 回调，在收到从服务器下载的组件定义时调用。也可以调用 reject(reason) 指示加载失败。这里 setTimeout 只是为了演示。怎么获取组件完全由你决定。推荐配合使用 ：Webpack 的代码分割功能</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;async-webpack-example&apos;, function (resolve) &#123;</div><div class="line">  // 这个特殊的 require 语法告诉 webpack</div><div class="line">  // 自动将编译后的代码分割成不同的块，</div><div class="line">  // 这些块将通过 Ajax 请求自动下载。</div><div class="line">  require([&apos;./my-async-component&apos;], resolve)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>你可以使用 Webpack 2 + ES2015 的语法返回一个 Promise resolve 函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Vue.component(</div><div class="line">  &apos;async-webpack-example&apos;,</div><div class="line">  () =&gt; import(&apos;./my-async-component&apos;)</div><div class="line">)</div></pre></td></tr></table></figure>
</li>
<li><p>当使用局部注册时，你也可以直接提供一个返回 Promise 的函数</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">new Vue(&#123;</div><div class="line">  // ...</div><div class="line">  components: &#123;</div><div class="line">    &apos;my-component&apos;: () =&gt; import(&apos;./my-async-component&apos;)</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>如果你是 Browserify 用户,可能就无法使用异步组件了,它的作者已经表明 Browserify 是不支持异步加载的。Browserify 社区发现 一些解决方法，可能有助于已存在的复杂应用。对于其他场景，我们推荐简单实用 Webpack 构建，一流的异步支持</p>
</li>
</ul>
</li>
<li><p>高级异步组件</p>
<ul>
<li><p>自 2.3.0 起，异步组件的工厂函数也可以返回一个如下的对象</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">const AsyncComp = () =&gt; (&#123;</div><div class="line">  // 需要加载的组件. 应当是一个 Promise</div><div class="line">  component: import(&apos;./MyComp.vue&apos;),</div><div class="line">  // loading 时应当渲染的组件</div><div class="line">  loading: LoadingComp,</div><div class="line">  // 出错时渲染的组件</div><div class="line">  error: ErrorComp,</div><div class="line">  // 渲染 loading 组件前的等待时间。默认：200ms.</div><div class="line">  delay: 200,</div><div class="line">  // 最长等待时间。超出此时间则渲染 error 组件。默认：Infinity</div><div class="line">  timeout: 3000</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>注意，当一个异步组件被作为 vue-</p>
</li>
<li>的路由组件使用时，这些高级选项都是无效的，因为在路由切换前就会提前加载所需要的异步组件。另外，如果你要在路由组件中使用上述写法，需要使用 </li>
<li>2.4.0+。</li>
</ul>
</li>
<li>组件命名约定<ul>
<li>注册组件 (或者 props) 时，可以使用 kebab-case(短横线连接)，camelCase，或 PascalCase</li>
<li>在 HTML 模版中，使用组件推荐 kebab-case 形式</li>
</ul>
</li>
<li>递归组件<ul>
<li>组件在它的模板内可以递归地调用自己，不过，只有当它有 name 选项时才可以</li>
<li>当你利用Vue.component全局注册了一个组件, 全局的ID作为组件的 name 选项，被自动设置.<strong>局部注册需要手动设置</strong></li>
<li>递归时，一定要设置终止条件</li>
</ul>
</li>
<li><p>组件间的循环引用</p>
<ul>
<li>假设你正在构建一个文件目录树，像在Finder或文件资源管理器中。你可能有一个 tree-folder组件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">// tree-folder组件</div><div class="line">&lt;p&gt;</div><div class="line">  &lt;span&gt;&#123;&#123; folder.name &#125;&#125;&lt;/span&gt;</div><div class="line">  &lt;tree-folder-contents :children=&quot;folder.children&quot;/&gt;</div><div class="line">&lt;/p&gt;</div><div class="line">// 然后 一个tree-folder-contents组件</div><div class="line">&lt;ul&gt;</div><div class="line">  &lt;li v-for=&quot;child in children&quot;&gt;</div><div class="line">    &lt;tree-folder v-if=&quot;child.children&quot; :folder=&quot;child&quot;/&gt;</div><div class="line">    &lt;span v-else&gt;&#123;&#123; child.name &#125;&#125;&lt;/span&gt;</div><div class="line">  &lt;/li&gt;</div><div class="line">&lt;/ul&gt;</div><div class="line">// 当你仔细看时，会发现在渲染树上这两个组件同时为对方的父节点和子节点–这点是矛盾的。当使用Vue.component将这两个组件注册为全局组件的时候，框架会自动为你解决这个矛盾</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>内联模版</p>
<ul>
<li><p>如果子组件有 inline-template 特性，组件将把它的内容当作它的模板，而不是把它当作分发内容</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;my-component inline-template&gt;</div><div class="line">  &lt;div&gt;</div><div class="line">    &lt;p&gt;These are compiled as the component&apos;s own template.&lt;/p&gt;</div><div class="line">    &lt;p&gt;Not parent&apos;s transclusion content.&lt;/p&gt;</div><div class="line">  &lt;/div&gt;</div><div class="line">&lt;/my-component&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>但是 inline-template 让模板的作用域难以理解。最佳实践是使用 template 选项在组件内定义模板或者在 .vue 文件中使用 template 元素</p>
</li>
</ul>
</li>
<li><p>X-Templates</p>
<ul>
<li><p>另一种定义模版的方式是在 JavaScript 标签里使用 text/x-template 类型，并且指定一个 id</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;script type=&quot;text/x-template&quot; id=&quot;hello-world-template&quot;&gt;</div><div class="line">  &lt;p&gt;Hello hello hello&lt;/p&gt;</div><div class="line">&lt;/script&gt;</div><div class="line">Vue.component(&apos;hello-world&apos;, &#123;</div><div class="line">  template: &apos;#hello-world-template&apos;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>这在有很多模版或者小的应用中有用，否则应该避免使用，因为它将模版和组件的其他定义隔离了。</p>
</li>
</ul>
</li>
<li>对低开销的静态组件使用 v-once<ul>
<li>尽管在 Vue 中渲染 HTML 很快，不过当组件中包含大量静态内容时，可以考虑使用 v-once 将渲染结果缓存起来，就像这样<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;terms-of-service&apos;, &#123;</div><div class="line">  template: &apos;\</div><div class="line">    &lt;div v-once&gt;\</div><div class="line">      &lt;h1&gt;Terms of Service&lt;/h1&gt;\</div><div class="line">      ... a lot of static content ...\</div><div class="line">    &lt;/div&gt;\</div><div class="line">  &apos;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="深入响应式原理"><a href="#深入响应式原理" class="headerlink" title="深入响应式原理"></a>深入响应式原理</h2><h3 id="如何追踪变化"><a href="#如何追踪变化" class="headerlink" title="如何追踪变化"></a>如何追踪变化</h3><ul>
<li>Vue通过<code>Object.defineProperty</code>将属性转化为setter/getter，在setter/getter中进行依赖追踪<ul>
<li>把一个普通 JavaScript 对象传给 Vue 实例的 data 选项，Vue 将遍历此对象所有的属性，并使用 Object.defineProperty 把这些属性全部转为 getter/setter。</li>
<li>用户看不到 getter/setter，但是在内部它们让 Vue 追踪依赖，在属性被访问和修改时通知变化</li>
<li>每个组件实例都有相应的 watcher 实例对象，它会在组件渲染的过程中把属性记录为依赖，之后当依赖项的 setter 被调用时，会通知 watcher 重新计算，从而致使它关联的组件得以更新<img src="/2017/08/01/Vue-guide/data.png" alt=""></li>
</ul>
</li>
</ul>
<h3 id="变化检测问题"><a href="#变化检测问题" class="headerlink" title="变化检测问题"></a>变化检测问题</h3><ul>
<li><p>受现代 JavaScript 的限制（以及废弃 Object.observe），<strong>Vue 不能检测到对象属性的添加或删除</strong>。由于 Vue 会在初始化实例时对属性执行 getter/setter 转化过程，所以<strong>属性必须在 data 对象上存在才能让 Vue 转换它，这样才能让它是响应的</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">data</span>:&#123;</div><div class="line">  <span class="attr">a</span>:<span class="number">1</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"><span class="comment">// `vm.a` 是响应的</span></div><div class="line">vm.b = <span class="number">2</span></div><div class="line"><span class="comment">// `vm.b` 是非响应的</span></div></pre></td></tr></table></figure>
</li>
<li><p>可以使用<code>Vue.set(target,key,value)</code>或者<code>vm.$set(target,key,value)</code>来添加响应式属性;注意<code>target</code>不能是 Vue 实例，或者 Vue 实例的根数据对象</p>
</li>
<li>有时你想向已有对象上添加一些属性，例如使用 Object.assign() 或 _.extend() 方法来添加属性。但是，添加到对象上的新属性不会触发更新。在这种情况下可以创建一个新的对象，让它包含原对象的属性和新的属性<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 代替 `Object.assign(this.someObject, &#123; a: 1, b: 2 &#125;)`</span></div><div class="line"><span class="keyword">this</span>.someObject = <span class="built_in">Object</span>.assign(&#123;&#125;, <span class="keyword">this</span>.someObject, &#123; <span class="attr">a</span>: <span class="number">1</span>, <span class="attr">b</span>: <span class="number">2</span> &#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="声明响应式属性"><a href="#声明响应式属性" class="headerlink" title="声明响应式属性"></a>声明响应式属性</h3><ul>
<li>由于 Vue 不允许动态添加根级响应式属性，所以你必须在初始化实例前声明根级响应式属性，哪怕只是一个空值<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="comment">// 声明 message 为一个空值字符串</span></div><div class="line">    message: <span class="string">''</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;&#123;&#123; message &#125;&#125;&lt;/div&gt;'</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// 之后设置 `message` </span></div><div class="line">vm.message = <span class="string">'Hello!'</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="异步更新队列"><a href="#异步更新队列" class="headerlink" title="异步更新队列"></a>异步更新队列</h3><ul>
<li><strong>Vue中的DOM更新是异步的</strong>；实际的DOM更新是发生在观察到数据变化后下一个eventLoop的tick中</li>
<li>只要观察到数据变化，Vue 将开启一个队列，并缓冲在同一事件循环中发生的所有数据改变。如果同一个 watcher 被多次触发，只会一次推入到队列中。这种在缓冲时去除重复数据对于避免不必要的计算和 DOM 操作上非常重要。然后，在下一个的事件循环“tick”中，Vue 刷新队列并执行实际（已去重的）工作。<strong>(数据变化-&gt;开启队列-&gt;去重复/缓冲)-&gt;(DOM更新)</strong>，在同一个括号中，代表发生在同一个tick中</li>
<li>Vue 在内部尝试对异步队列使用原生的 Promise.then 和 MutationObserver，如果执行环境不支持，会采用 setTimeout(fn, 0) 代替。例如，当你设置 vm.someData = ‘new value’ ，该组件不会立即重新渲染。当刷新队列时，组件会在事件循环队列清空时的下一个“tick”更新。</li>
<li><p>可以使用<code>Vue.nextTick(callback)</code>,在 DOM 更新完成后立即调用callback</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">&lt;div id="example"&gt;&#123;&#123;message&#125;&#125;&lt;/div&gt;</div><div class="line">var vm = new Vue(&#123;</div><div class="line">  el: '#example',</div><div class="line">  data: &#123;</div><div class="line">    message: '123'</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">vm.message = 'new message' // 更改数据</div><div class="line">vm.$el.textContent === 'new message' // false</div><div class="line">Vue.nextTick(function () &#123;</div><div class="line">  vm.$el.textContent === 'new message' // true</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>组件内使用<code>vm.$nextTick(callback)</code>,callback中的 this 将自动绑定到当前的 Vue 实例上</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;example&apos;, &#123;</div><div class="line">  template: &apos;&lt;span&gt;&#123;&#123; message &#125;&#125;&lt;/span&gt;&apos;,</div><div class="line">  data: function () &#123;</div><div class="line">    return &#123;</div><div class="line">      message: &apos;没有更新&apos;</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    updateMessage: function () &#123;</div><div class="line">      this.message = &apos;更新完成&apos;</div><div class="line">      console.log(this.$el.textContent) // =&gt; &apos;没有更新&apos;</div><div class="line">      this.$nextTick(function () &#123;</div><div class="line">        console.log(this.$el.textContent) // =&gt; &apos;更新完成&apos;</div><div class="line">      &#125;)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="过渡效果"><a href="#过渡效果" class="headerlink" title="过渡效果"></a>过渡效果</h2><h3 id="单元素-组件的过渡"><a href="#单元素-组件的过渡" class="headerlink" title="单元素/组件的过渡"></a>单元素/组件的过渡</h3><ul>
<li><p>Vue 提供了 transition 的封装组件，在下列情形中，可以给任何元素和组件添加 entering/leaving 过渡</p>
<ul>
<li>条件渲染 （使用 v-if）</li>
<li>条件展示 （使用 v-show）</li>
<li>动态组件</li>
<li><p>组件根节点</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;div id="demo"&gt;</div><div class="line">  &lt;button v-on:click="show = !show"&gt;</div><div class="line">    Toggle</div><div class="line">  &lt;/button&gt;</div><div class="line">  &lt;transition name="fade"&gt;</div><div class="line">    &lt;p v-if="show"&gt;hello&lt;/p&gt;</div><div class="line">  &lt;/transition&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">.fade-enter-active, .fade-leave-active &#123;</div><div class="line">  transition: opacity 0.5s</div><div class="line">&#125;</div><div class="line">.fade-enter, .fade-leave-to &#123;</div><div class="line">  opacity: 0</div><div class="line">&#125;</div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">  el: '#demo',</div><div class="line">  data: &#123;</div><div class="line">    show: true</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>当插入或删除包含在<code>&lt;transition&gt;</code>组件中的元素时，Vue 将会做以下处理</p>
<ul>
<li>自动嗅探目标元素是否应用了 CSS 过渡或动画，如果是，在恰当的时机添加/删除 CSS 类名。</li>
<li>如果过渡组件提供了 JavaScript 钩子函数，这些钩子函数将在恰当的时机被调用</li>
<li>如果没有找到 JavaScript 钩子并且也没有检测到 CSS 过渡/动画，DOM 操作（插入/删除）在下一帧中立即执行。(注意：此指浏览器逐帧动画机制，和Vue的 nextTick 概念不同)</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="过渡的css类名"><a href="#过渡的css类名" class="headerlink" title="过渡的css类名"></a>过渡的css类名</h3><p>类似ng中动画会添加合适的class</p>
<ul>
<li>会有 6 个(CSS)类名在 enter/leave 的过渡中切换<ul>
<li><code>v-enter</code>-&gt;定义开始状态，会在元素插入时生效，并在下一frame被删除</li>
<li><code>v-enter-active</code>-&gt;定义过渡状态，插入时生效，过渡结束时删除；这个可以被用来定义过渡的过程时间，延迟和曲线函数。</li>
<li><code>v-enter-to</code>-&gt;定义过渡结束状态，在元素插入后的下一frame被加入(<code>v-enter</code>正好删除),过渡结束时删除</li>
<li>同理，<code>leave</code>也一样，有<code>v-leave</code>、<code>v-leave-active</code>、<code>v-leave-to</code><img src="/2017/08/01/Vue-guide/transition.png" alt=""></li>
<li>过渡中的类名前缀是可以更换的，通过<code>&lt;transtion&gt;</code>组件的<code>name</code>特性可以指定过渡类的前缀<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">// 对应的过渡样式类就是.testAnim-enter、.testAnim-enter-active、.testAnim-enter-to</div><div class="line">&lt;transtion name=&quot;testAnim&quot;&gt;xxx&lt;/transition&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="css过渡"><a href="#css过渡" class="headerlink" title="css过渡"></a>css过渡</h3><p>最常用的<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;example-1&quot;&gt;</div><div class="line">  &lt;button @click=&quot;show = !show&quot;&gt;</div><div class="line">    Toggle render</div><div class="line">  &lt;/button&gt;</div><div class="line">  &lt;transition name=&quot;slide-fade&quot;&gt;</div><div class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</div><div class="line">  &lt;/transition&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#example-1&apos;,</div><div class="line">  data: &#123;</div><div class="line">    show: true</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">/* 可以设置不同的进入和离开动画 */</div><div class="line">/* 设置持续时间和动画函数 */</div><div class="line">.slide-fade-enter-active &#123;</div><div class="line">  transition: all .3s ease;</div><div class="line">&#125;</div><div class="line">.slide-fade-leave-active &#123;</div><div class="line">  transition: all .8s cubic-bezier(1.0, 0.5, 0.8, 1.0);</div><div class="line">&#125;</div><div class="line">.slide-fade-enter, .slide-fade-leave-to &#123;</div><div class="line">  transform: translateX(10px);</div><div class="line">  opacity: 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<h3 id="css动画"><a href="#css动画" class="headerlink" title="css动画"></a>css动画</h3><p>animation</p>
<ul>
<li>CSS 动画用法同 CSS 过渡，区别是在动画中<code>v-enter</code>类名在节点插入 DOM 后不会立即删除，而是在 animationend 事件触发时(动画结束)删除。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;example-2&quot;&gt;</div><div class="line">  &lt;button @click=&quot;show = !show&quot;&gt;Toggle show&lt;/button&gt;</div><div class="line">  &lt;transition name=&quot;bounce&quot;&gt;</div><div class="line">    &lt;p v-if=&quot;show&quot;&gt;Look at me!&lt;/p&gt;</div><div class="line">  &lt;/transition&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#example-2&apos;,</div><div class="line">  data: &#123;</div><div class="line">    show: true</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">.bounce-enter-active &#123;</div><div class="line">  animation: bounce-in .5s;</div><div class="line">&#125;</div><div class="line">.bounce-leave-active &#123;</div><div class="line">  animation: bounce-in .5s reverse;</div><div class="line">&#125;</div><div class="line">@keyframes bounce-in &#123;</div><div class="line">  0% &#123;</div><div class="line">    transform: scale(0);</div><div class="line">  &#125;</div><div class="line">  50% &#123;</div><div class="line">    transform: scale(1.5);</div><div class="line">  &#125;</div><div class="line">  100% &#123;</div><div class="line">    transform: scale(1);</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="自定义过渡类名"><a href="#自定义过渡类名" class="headerlink" title="自定义过渡类名"></a>自定义过渡类名</h3><ul>
<li>可以通过以下特性来自定义过渡类名;<strong>主要用来配合第三方css动画库使用</strong>;他们的优先级高于普通的类名<ul>
<li>enter-class</li>
<li>enter-active-class</li>
<li>enter-to-class (2.1.8+)</li>
<li>leave-class</li>
<li>leave-active-class</li>
<li>leave-to-class (2.1.8+)<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&lt;link href=&quot;https://unpkg.com/animate.css@3.5.1/animate.min.css&quot; rel=&quot;stylesheet&quot; type=&quot;text/css&quot;&gt;</div><div class="line">&lt;div id=&quot;example-3&quot;&gt;</div><div class="line">  &lt;button @click=&quot;show = !show&quot;&gt;</div><div class="line">    Toggle render</div><div class="line">  &lt;/button&gt;</div><div class="line">    &lt;!-- 进入离开时用特殊的class  --&gt;</div><div class="line">  &lt;transition</div><div class="line">    name=&quot;custom-classes-transition&quot;</div><div class="line">    enter-active-class=&quot;animated tada&quot;</div><div class="line">    leave-active-class=&quot;animated bounceOutRight&quot;</div><div class="line">  &gt;</div><div class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</div><div class="line">  &lt;/transition&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#example-3&apos;,</div><div class="line">  data: &#123;</div><div class="line">    show: true</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="同时使用-Transitions-和-Animations"><a href="#同时使用-Transitions-和-Animations" class="headerlink" title="同时使用 Transitions 和 Animations"></a>同时使用 Transitions 和 Animations</h3><ul>
<li>Vue 为了知道过渡的完成，必须设置相应的事件监听器。它可以是 transitionend 或 animationend ，这取决于给元素应用的 CSS 规则。如果你使用其中任何一种，Vue 能自动识别类型并设置监听。</li>
<li>但是，在一些场景中，你需要给同一个元素同时设置两种过渡动效，比如 animation 很快的被触发并完成了，而 transition 效果还没结束。在这种情况中，你就需要使用 type 特性并设置 animation 或 transition 来明确声明你需要 Vue 监听的类型。</li>
</ul>
<h3 id="显性的过渡效果持续时间"><a href="#显性的过渡效果持续时间" class="headerlink" title="显性的过渡效果持续时间"></a>显性的过渡效果持续时间</h3><ul>
<li>在很多情况下，Vue 可以自动得出过渡效果的完成时机。默认情况下，Vue 会等待其在过渡效果的根元素的第一个 transitionend 或 animationend 事件。然而也可以不这样设定——比如，我们可以拥有一个精心编排的一序列过渡效果，其中一些嵌套的内部元素相比于过渡效果的根元素有延迟的或更长的过渡效果。在这种情况下你可以用 <transition> 组件上的 duration 属性定制一个显性的过渡效果持续时间 (以毫秒计)：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;transition :duration=&quot;1000&quot;&gt;...&lt;/transition&gt;</div><div class="line">// 你也可以定制进入和移出的持续时间：</div><div class="line">&lt;transition :duration=&quot;&#123; enter: 500, leave: 800 &#125;&quot;&gt;...&lt;/transition&gt;</div></pre></td></tr></table></figure>
</transition></li>
</ul>
<p>###JavaScript 钩子(Js动画)<br>可以在属性中声明 JavaScript 钩子，通过钩子在特定时间调用特定动画函数来实现js动画</p>
<ul>
<li><code>beforeEnter</code>-&gt;进入前</li>
<li><code>enter</code>-&gt;进入中</li>
<li><code>after-enter</code>-&gt;进入后</li>
<li><code>enter-cancelled</code>-&gt;取消后</li>
<li><p>同理leave也有类似钩子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div></pre></td><td class="code"><pre><div class="line">&lt;transition</div><div class="line">  v-on:before-enter=&quot;beforeEnter&quot;</div><div class="line">  v-on:enter=&quot;enter&quot;</div><div class="line">  v-on:after-enter=&quot;afterEnter&quot;</div><div class="line">  v-on:enter-cancelled=&quot;enterCancelled&quot;</div><div class="line">  v-on:before-leave=&quot;beforeLeave&quot;</div><div class="line">  v-on:leave=&quot;leave&quot;</div><div class="line">  v-on:after-leave=&quot;afterLeave&quot;</div><div class="line">  v-on:leave-cancelled=&quot;leaveCancelled&quot;</div><div class="line">&gt;</div><div class="line">  &lt;!-- ... --&gt;</div><div class="line">&lt;/transition&gt;</div><div class="line">// ...</div><div class="line">methods: &#123;</div><div class="line">  // --------</div><div class="line">  // 进入中</div><div class="line">  // --------</div><div class="line">  beforeEnter: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  // 此回调函数是可选项的设置</div><div class="line">  // 与 CSS 结合时使用</div><div class="line">  enter: function (el, done) &#123;</div><div class="line">    // ...</div><div class="line">    done()</div><div class="line">  &#125;,</div><div class="line">  afterEnter: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  enterCancelled: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  // --------</div><div class="line">  // 离开时</div><div class="line">  // --------</div><div class="line">  beforeLeave: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  // 此回调函数是可选项的设置</div><div class="line">  // 与 CSS 结合时使用</div><div class="line">  leave: function (el, done) &#123;</div><div class="line">    // ...</div><div class="line">    done()</div><div class="line">  &#125;,</div><div class="line">  afterLeave: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;,</div><div class="line">  // leaveCancelled 只用于 v-show 中</div><div class="line">  leaveCancelled: function (el) &#123;</div><div class="line">    // ...</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>这些钩子函数可以结合 CSS transitions/animations 使用，也可以单独使用。</p>
</li>
<li><strong>当只用 JavaScript 过渡的时候， 在 enter 和 leave 中，回调函数 done 是必须的 。 否则，它们会被同步调用，过渡会立即完成</strong>。</li>
<li><strong>推荐对于仅使用 JavaScript 过渡的元素添加 v-bind:css=”false”，Vue 会跳过 CSS 的检测。这也可以避免过渡过程中 CSS 的影响。</strong></li>
</ul>
<h3 id="初始渲染的过渡"><a href="#初始渲染的过渡" class="headerlink" title="初始渲染的过渡"></a>初始渲染的过渡</h3><p>定义第一次渲染时，如何过渡</p>
<ul>
<li><p>通过添加<code>appear</code>特性，可以开启初始渲染过渡动画</p>
<ul>
<li><p>和<code>enter</code>、<code>leave</code>过渡一样可以自己定义css类名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;transition</div><div class="line">  appear</div><div class="line">  appear-class=&quot;custom-appear-class&quot;</div><div class="line">  appear-to-class=&quot;custom-appear-to-class&quot;</div><div class="line">  appear-active-class=&quot;custom-appear-active-class&quot;</div><div class="line">&gt;</div><div class="line">  &lt;!-- ... --&gt;</div><div class="line">&lt;/transition&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>也有相应的js钩子</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;transition</div><div class="line">  appear</div><div class="line">  v-on:before-appear=&quot;customBeforeAppearHook&quot;</div><div class="line">  v-on:appear=&quot;customAppearHook&quot;</div><div class="line">  v-on:after-appear=&quot;customAfterAppearHook&quot;</div><div class="line">  v-on:appear-cancelled=&quot;customAppearCancelledHook&quot;</div><div class="line">&gt;</div><div class="line">  &lt;!-- ... --&gt;</div><div class="line">&lt;/transition&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="多个元素的过渡"><a href="#多个元素的过渡" class="headerlink" title="多个元素的过渡"></a>多个元素的过渡</h3><ul>
<li><p>对于原生标签可以使用 v-if/v-else 。最常见的多标签过渡是一个列表和描述这个列表为空消息的元素</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">&lt;transition&gt;</div><div class="line">  &lt;table v-if=&quot;items.length &gt; 0&quot;&gt;</div><div class="line">    &lt;!-- ... --&gt;</div><div class="line">  &lt;/table&gt;</div><div class="line">  &lt;p v-else&gt;Sorry, no items found.&lt;/p&gt;</div><div class="line">&lt;/transition&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>当有相同标签名的元素切换时，需要通过 key 特性设置唯一的值来标记以让 Vue 区分它们，否则 Vue 为了效率只会替换相同标签内部的内容。即使在技术上没有必要，给在 <transition> 组件中的多个元素设置 key 是一个更好的实践。</transition></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div></pre></td><td class="code"><pre><div class="line"> &lt;style type=&quot;text/css&quot;&gt;</div><div class="line">    .fade-enter,</div><div class="line">    .fade-leave &#123;</div><div class="line">        opacity: 0;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .fade-enter-active,</div><div class="line">    .fade-leave-active &#123;</div><div class="line">        transition: all .3s ease-in-out;</div><div class="line">    &#125;</div><div class="line">    &lt;/style&gt;</div><div class="line">&lt;div id=&quot;app&quot;&gt;</div><div class="line">    &lt;transition name=&quot;fade&quot;&gt;</div><div class="line">        &lt;!-- 没有加key,根据vue的就地复用原则，他们将只替换内容，因此不会产生过渡动画 --&gt;</div><div class="line">        &lt;!--     &lt;button v-if=&quot;isEditing&quot;&gt;</div><div class="line">            Save</div><div class="line">        &lt;/button&gt;</div><div class="line">        &lt;button v-else&gt;</div><div class="line">            Edit</div><div class="line">        &lt;/button&gt;  --&gt;</div><div class="line">        &lt;!-- 添加key --&gt;</div><div class="line">        &lt;!--   &lt;button v-if=&quot;isEditing&quot; key=&quot;save&quot;&gt;</div><div class="line">            Save</div><div class="line">        &lt;/button&gt;</div><div class="line">        &lt;button v-else key=&quot;edit&quot;&gt;</div><div class="line">            Edit</div><div class="line">        &lt;/button&gt; --&gt;</div><div class="line">        &lt;!-- 在一些场景中，也可以给通过给同一个元素的 key 特性设置不同的状态来代替 v-if 和 v-else，上面的例子可以重写为： --&gt;</div><div class="line">        &lt;button v-bind:key=&quot;isEditing&quot;&gt;</div><div class="line">            &#123;&#123; isEditing ? &apos;Save&apos; : &apos;Edit&apos; &#125;&#125;</div><div class="line">        &lt;/button&gt;</div><div class="line">    &lt;/transition&gt;</div><div class="line">    &lt;button @click=&quot;isEditing=!isEditing&quot;&gt;点击&lt;/button&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">var vm = new Vue(&#123;</div><div class="line">        el: &apos;#app&apos;,</div><div class="line">        data: &#123;</div><div class="line">            isEditing: true</div><div class="line">        &#125;</div><div class="line">    &#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>使用多个 v-if 的多个元素的过渡可以重写为绑定了动态属性的单个元素过渡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">&lt;transition&gt;</div><div class="line">  &lt;button v-if=&quot;docState === &apos;saved&apos;&quot; key=&quot;saved&quot;&gt;</div><div class="line">    Edit</div><div class="line">  &lt;/button&gt;</div><div class="line">  &lt;button v-if=&quot;docState === &apos;edited&apos;&quot; key=&quot;edited&quot;&gt;</div><div class="line">    Save</div><div class="line">  &lt;/button&gt;</div><div class="line">  &lt;button v-if=&quot;docState === &apos;editing&apos;&quot; key=&quot;editing&quot;&gt;</div><div class="line">    Cancel</div><div class="line">  &lt;/button&gt;</div><div class="line">&lt;/transition&gt;</div><div class="line">&lt;!-- 重写 --&gt;</div><div class="line">&lt;transition&gt;</div><div class="line">  &lt;button v-bind:key=&quot;docState&quot;&gt;</div><div class="line">    &#123;&#123; buttonMessage &#125;&#125;</div><div class="line">  &lt;/button&gt;</div><div class="line">&lt;/transition&gt;</div><div class="line">// ...</div><div class="line">computed: &#123;</div><div class="line">  buttonMessage: function () &#123;</div><div class="line">    switch (this.docState) &#123;</div><div class="line">      case &apos;saved&apos;: return &apos;Edit&apos;</div><div class="line">      case &apos;edited&apos;: return &apos;Save&apos;</div><div class="line">      case &apos;editing&apos;: return &apos;Cancel&apos;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="多元素的过渡模式"><a href="#多元素的过渡模式" class="headerlink" title="多元素的过渡模式"></a>多元素的过渡模式</h3><p>多元素过渡时(一个enter、一个leave)默认是进入和离开同时发生；这样可能会发生过渡时画面抖动的问题；通过多元素的过渡模式可以解决</p>
<ul>
<li>通过在<code>&lt;transtion&gt;</code>上添加<code>mode</code>特性便可指定过渡模式<ul>
<li>in-out: 新元素先进行过渡进入，完成之后当前元素过渡离开。-&gt;先enter后leave</li>
<li>out-in: 当前元素先进行过渡离开，完成之后新元素过渡进入。-&gt;先leave后enter<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div></pre></td><td class="code"><pre><div class="line">&lt;style type=&quot;text/css&quot;&gt;</div><div class="line">    .fade-enter,</div><div class="line">    .fade-leave-to &#123;</div><div class="line">        opacity: 0;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .fade-enter &#123;</div><div class="line">        transform: translateX(10px);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .fade-leave-to &#123;</div><div class="line">        transform: translateX(-10px);</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .fade-enter-active,</div><div class="line">    .fade-leave-active &#123;</div><div class="line">        transition: all .3s ease-in-out;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;div id=&quot;app&quot;&gt;</div><div class="line">    &lt;transition name=&quot;fade&quot; mode=&quot;in-out&quot;&gt;</div><div class="line">        &lt;button :key=&quot;isEditing&quot; @click=&quot;isEditing=!isEditing&quot; :style=&quot;&#123;position:&apos;absolute&apos;&#125;&quot;&gt;</div><div class="line">            &#123;&#123; isEditing &#125;&#125;</div><div class="line">        &lt;/button&gt;</div><div class="line">    &lt;/transition&gt;</div><div class="line">&lt;/div&gt;</div><div class="line"> var vm = new Vue(&#123;</div><div class="line">    el: &apos;#app&apos;,</div><div class="line">    data: &#123;</div><div class="line">        isEditing: true</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="多个组件的过渡"><a href="#多个组件的过渡" class="headerlink" title="多个组件的过渡"></a>多个组件的过渡</h3><ul>
<li>多个组件的过渡简单很多 - 我们不需要使用 key 特性。相反，我们只需要使用动态组件<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line">&lt;transition name=&quot;component-fade&quot; mode=&quot;out-in&quot;&gt;</div><div class="line">  &lt;component v-bind:is=&quot;view&quot;&gt;&lt;/component&gt;</div><div class="line">&lt;/transition&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#transition-components-demo&apos;,</div><div class="line">  data: &#123;</div><div class="line">    view: &apos;v-a&apos;</div><div class="line">  &#125;,</div><div class="line">  components: &#123;</div><div class="line">    &apos;v-a&apos;: &#123;</div><div class="line">      template: &apos;&lt;div&gt;Component A&lt;/div&gt;&apos;</div><div class="line">    &#125;,</div><div class="line">    &apos;v-b&apos;: &#123;</div><div class="line">      template: &apos;&lt;div&gt;Component B&lt;/div&gt;&apos;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">.component-fade-enter-active, .component-fade-leave-active &#123;</div><div class="line">  transition: opacity .3s ease;</div><div class="line">&#125;</div><div class="line">.component-fade-enter, .component-fade-leave-to&#123;</div><div class="line">  opacity: 0;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="列表过渡"><a href="#列表过渡" class="headerlink" title="列表过渡"></a>列表过渡</h3><ul>
<li>那么怎么同时渲染整个列表，比如使用 v-for ？在这种场景中，使用<code>&lt;transition-group&gt;</code>组件。<ul>
<li>不同于<code>&lt;transition&gt;</code>，它会以一个真实元素呈现：默认为一个 <span>。你也可以通过<code>tag</code>特性更换为其他元素。</span></li>
<li><strong>内部元素 总是需要 提供唯一的 key 属性值</strong><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div></pre></td><td class="code"><pre><div class="line">&lt;style type=&quot;text/css&quot;&gt;</div><div class="line">    .list-item &#123;</div><div class="line">        display: inline-block;</div><div class="line">        margin-right: 10px;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .list-enter-active,</div><div class="line">    .list-leave-active &#123;</div><div class="line">        transition: all 1s;</div><div class="line">    &#125;</div><div class="line"></div><div class="line">    .list-enter,</div><div class="line">    .list-leave-to &#123;</div><div class="line">        opacity: 0;</div><div class="line">        transform: translateY(30px);</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;div id=&quot;list-demo&quot; class=&quot;demo&quot;&gt;</div><div class="line">    &lt;button v-on:click=&quot;add&quot;&gt;Add&lt;/button&gt;</div><div class="line">    &lt;button v-on:click=&quot;remove&quot;&gt;Remove&lt;/button&gt;</div><div class="line">    &lt;!-- 因为指定了tag特性，所以transition-group将被p取代 --&gt;</div><div class="line">    &lt;transition-group name=&quot;list&quot; tag=&quot;p&quot;&gt;</div><div class="line">        &lt;!-- 绑定唯一的key --&gt;</div><div class="line">        &lt;span v-for=&quot;item in items&quot; v-bind:key=&quot;item&quot; class=&quot;list-item&quot;&gt;&#123;&#123; item &#125;&#125;&lt;/span&gt;</div><div class="line">    &lt;/transition-group&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">    el: &apos;#list-demo&apos;,</div><div class="line">    data: &#123;</div><div class="line">        items: [1, 2, 3, 4, 5, 6, 7, 8, 9],</div><div class="line">        nextNum: 10</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        randomIndex: function() &#123;</div><div class="line">            return Math.floor(Math.random() * this.items.length)</div><div class="line">        &#125;,</div><div class="line">        add: function() &#123;</div><div class="line">            this.items.splice(this.randomIndex(), 0, this.nextNum++)</div><div class="line">        &#125;,</div><div class="line">        remove: function() &#123;</div><div class="line">            this.items.splice(this.randomIndex(), 1)</div><div class="line">        &#125;,</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h3 id="列表的位移过渡"><a href="#列表的位移过渡" class="headerlink" title="列表的位移过渡"></a>列表的位移过渡</h3><ul>
<li>上面的例子，当添加和移除元素的时候，周围的元素会瞬间移动到他们的新布局的位置，而不是平滑的过渡</li>
<li><p><code>&lt;transition-group&gt;</code>组件还有一个特殊之处。不仅可以进入和离开动画，还可以改变定位。要使用这个新功能只需了解新增的<code>v-move</code>特性，它会在元素的改变定位的过程中应用。像之前的类名一样，可以通过<code>name</code>属性来自定义前缀，也可以通过<code>move-class</code>属性手动设置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line">&lt;style type=&quot;text/css&quot;&gt;</div><div class="line">    /*设置-move*/</div><div class="line">    .flip-list-move &#123;</div><div class="line">        transition: transform 1s;</div><div class="line">    &#125;</div><div class="line">&lt;/style&gt;</div><div class="line">&lt;div id=&quot;flip-list-demo&quot; class=&quot;demo&quot;&gt;</div><div class="line">    &lt;button v-on:click=&quot;shuffle&quot;&gt;洗牌&lt;/button&gt;</div><div class="line">    &lt;transition-group name=&quot;flip-list&quot; tag=&quot;ul&quot;&gt;</div><div class="line">        &lt;li v-for=&quot;item in items&quot; v-bind:key=&quot;item&quot;&gt;</div><div class="line">            &#123;&#123; item &#125;&#125;</div><div class="line">        &lt;/li&gt;</div><div class="line">    &lt;/transition-group&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">    el: &apos;#flip-list-demo&apos;,</div><div class="line">    data: &#123;</div><div class="line">        items: [1, 2, 3, 4, 5, 6, 7, 8, 9]</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        shuffle: function() &#123;</div><div class="line">            this.items = _.shuffle(this.items) // 打乱</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>内部的实现，Vue 使用了一个叫 FLIP 简单的动画队列使用 transforms 将元素从之前的位置平滑过渡新的位置。</p>
</li>
<li>需要注意的是使用FLIP过渡的元素<strong>不能设置为 display: inline </strong>。作为替代方案，可以设置为 display: inline-block 或者放置于 flex 中</li>
</ul>
<h3 id="列表的渐进过渡"><a href="#列表的渐进过渡" class="headerlink" title="列表的渐进过渡"></a>列表的渐进过渡</h3><ul>
<li>通过 data 属性与 JavaScript 通信 ，就可以实现列表的渐进过渡<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;div id=&quot;staggered-list-demo&quot;&gt;</div><div class="line">    &lt;input v-model=&quot;query&quot;&gt;</div><div class="line">    &lt;!-- 因为是全部用js完成动画，所以v-bind:css=&quot;false&quot;，避开css动画检查，提高效率；并在各个动画钩子处绑定动画函数 --&gt;</div><div class="line">    &lt;transition-group name=&quot;staggered-fade&quot; tag=&quot;ul&quot; v-bind:css=&quot;false&quot; v-on:before-enter=&quot;beforeEnter&quot; v-on:enter=&quot;enter&quot; v-on:leave=&quot;leave&quot;&gt;</div><div class="line">        &lt;!-- 绑定唯一的key并绑定索引 --&gt;</div><div class="line">        &lt;li v-for=&quot;(item, index) in computedList&quot; v-bind:key=&quot;item.msg&quot; v-bind:data-index=&quot;index&quot;&gt;&#123;&#123; item.msg &#125;&#125;&lt;/li&gt;</div><div class="line">    &lt;/transition-group&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">        el: &apos;#staggered-list-demo&apos;,</div><div class="line">        data: &#123;</div><div class="line">            query: &apos;&apos;,</div><div class="line">            list: [</div><div class="line">                &#123; msg: &apos;Bruce Lee&apos; &#125;,</div><div class="line">                &#123; msg: &apos;Jackie Chan&apos; &#125;,</div><div class="line">                &#123; msg: &apos;Chuck Norris&apos; &#125;,</div><div class="line">                &#123; msg: &apos;Jet Li&apos; &#125;,</div><div class="line">                &#123; msg: &apos;Kung Fury&apos; &#125;</div><div class="line">            ]</div><div class="line">        &#125;,</div><div class="line">        computed: &#123;</div><div class="line">            computedList: function() &#123;</div><div class="line">                var vm = this</div><div class="line">                return this.list.filter(function(item) &#123;</div><div class="line">                    return item.msg.toLowerCase().indexOf(vm.query.toLowerCase()) !== -1</div><div class="line">                &#125;)</div><div class="line">            &#125;</div><div class="line">        &#125;,</div><div class="line">        methods: &#123;</div><div class="line">            beforeEnter: function(el) &#123;</div><div class="line">                el.style.opacity = 0</div><div class="line">                el.style.height = 0</div><div class="line">            &#125;,</div><div class="line">            enter: function(el, done) &#123;</div><div class="line">                // 根据索引创建延迟</div><div class="line">                var delay = el.dataset.index * 150;</div><div class="line">                setTimeout(function() &#123;</div><div class="line">                    Velocity(</div><div class="line">                        el, &#123; opacity: 1, height: &apos;1.6em&apos; &#125;, &#123; complete: done &#125;</div><div class="line">                    )</div><div class="line">                &#125;, delay)</div><div class="line">            &#125;,</div><div class="line">            leave: function(el, done) &#123;</div><div class="line">                var delay = el.dataset.index * 150</div><div class="line">                setTimeout(function() &#123;</div><div class="line">                    Velocity(</div><div class="line">                        el, &#123; opacity: 0, height: 0 &#125;, &#123; complete: done &#125;</div><div class="line">                    )</div><div class="line">                &#125;, delay)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="可复用的过渡"><a href="#可复用的过渡" class="headerlink" title="可复用的过渡"></a>可复用的过渡</h3><ul>
<li>过渡可以通过 Vue 的组件系统实现复用<ul>
<li>要创建一个可复用过渡组件，你需要做的就是将 <transition> 或者 <transition-group> 作为根组件，然后将任何子组件放置在其中就可以了。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">Vue.component(&apos;my-special-transition&apos;, &#123;</div><div class="line">  template: &apos;\</div><div class="line">    &lt;transition\</div><div class="line">      name=&quot;very-special-transition&quot;\</div><div class="line">      mode=&quot;out-in&quot;\</div><div class="line">      v-on:before-enter=&quot;beforeEnter&quot;\</div><div class="line">      v-on:after-enter=&quot;afterEnter&quot;\</div><div class="line">    &gt;\</div><div class="line">      &lt;slot&gt;&lt;/slot&gt;\</div><div class="line">    &lt;/transition&gt;\</div><div class="line">  &apos;,</div><div class="line">  methods: &#123;</div><div class="line">    beforeEnter: function (el) &#123;</div><div class="line">      // ...</div><div class="line">    &#125;,</div><div class="line">    afterEnter: function (el) &#123;</div><div class="line">      // ...</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</transition-group></transition></li>
</ul>
</li>
</ul>
<h3 id="动态过渡"><a href="#动态过渡" class="headerlink" title="动态过渡"></a>动态过渡</h3><ul>
<li>Vue 中即使是过渡也是数据驱动的，过渡中的各种状态能通过数据动态改变。</li>
<li>当你想用 Vue 的过渡系统来定义的 CSS 过渡/动画 在不同过渡间切换会非常有用</li>
<li>所有的过渡特性都是动态绑定。</li>
<li>它不仅是简单的特性，通过事件的钩子函数方法，可以在获取到相应上下文数据。</li>
<li>这意味着，可以根据组件的状态通过 JavaScript 过渡设置不同的过渡效果。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/velocity/1.2.3/velocity.min.js&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;div id=&quot;dynamic-fade-demo&quot; class=&quot;demo&quot;&gt;</div><div class="line">  Fade In: &lt;input type=&quot;range&quot; v-model=&quot;fadeInDuration&quot; min=&quot;0&quot; v-bind:max=&quot;maxFadeDuration&quot;&gt;</div><div class="line">  Fade Out: &lt;input type=&quot;range&quot; v-model=&quot;fadeOutDuration&quot; min=&quot;0&quot; v-bind:max=&quot;maxFadeDuration&quot;&gt;</div><div class="line">  &lt;transition</div><div class="line">    v-bind:css=&quot;false&quot;</div><div class="line">    v-on:before-enter=&quot;beforeEnter&quot;</div><div class="line">    v-on:enter=&quot;enter&quot;</div><div class="line">    v-on:leave=&quot;leave&quot;</div><div class="line">  &gt;</div><div class="line">    &lt;p v-if=&quot;show&quot;&gt;hello&lt;/p&gt;</div><div class="line">  &lt;/transition&gt;</div><div class="line">  &lt;button</div><div class="line">    v-if=&quot;stop&quot;</div><div class="line">    v-on:click=&quot;stop = false; show = false&quot;</div><div class="line">  &gt;Start animating&lt;/button&gt;</div><div class="line">  &lt;button</div><div class="line">    v-else</div><div class="line">    v-on:click=&quot;stop = true&quot;</div><div class="line">  &gt;Stop it!&lt;/button&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#dynamic-fade-demo&apos;,</div><div class="line">  data: &#123;</div><div class="line">    show: true,</div><div class="line">    fadeInDuration: 1000,</div><div class="line">    fadeOutDuration: 1000,</div><div class="line">    maxFadeDuration: 1500,</div><div class="line">    stop: true</div><div class="line">  &#125;,</div><div class="line">  mounted: function () &#123;</div><div class="line">    this.show = false</div><div class="line">  &#125;,</div><div class="line">  methods: &#123;</div><div class="line">    beforeEnter: function (el) &#123;</div><div class="line">      el.style.opacity = 0</div><div class="line">    &#125;,</div><div class="line">    enter: function (el, done) &#123;</div><div class="line">      var vm = this</div><div class="line">      Velocity(el,</div><div class="line">        &#123; opacity: 1 &#125;,</div><div class="line">        &#123;</div><div class="line">          duration: this.fadeInDuration,// 持续时间为动态绑定</div><div class="line">          complete: function () &#123;</div><div class="line">            done()</div><div class="line">            if (!vm.stop) vm.show = false</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      )</div><div class="line">    &#125;,</div><div class="line">    leave: function (el, done) &#123;</div><div class="line">      var vm = this</div><div class="line">      Velocity(el,</div><div class="line">        &#123; opacity: 0 &#125;,</div><div class="line">        &#123;</div><div class="line">          duration: this.fadeOutDuration,// 持续时间为动态绑定</div><div class="line">          complete: function () &#123;</div><div class="line">            done()</div><div class="line">            vm.show = true</div><div class="line">          &#125;</div><div class="line">        &#125;</div><div class="line">      )</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="过渡状态"><a href="#过渡状态" class="headerlink" title="过渡状态"></a>过渡状态</h2><ul>
<li>Vue 的过渡系统提供了非常多简单的方法设置进入、离开和列表的动效。有些变化中间的过渡状态无法通过vue独自完成，例如<ul>
<li>数字和运算(数字从1变为10中间的过渡)</li>
<li>颜色的显示(从一种颜色变化到另一种的过渡)</li>
<li>SVG 节点的位置</li>
<li>元素的大小和其他的属性</li>
</ul>
</li>
<li><strong>所有的原始数字都被事先存储起来，可以直接转换到数字</strong>。做到这一步，我们就可以结合 Vue 的响应式和组件系统，使用第三方库来实现切换元素的过渡状态，补间动画</li>
</ul>
<h3 id="状态动画-与-watcher"><a href="#状态动画-与-watcher" class="headerlink" title="状态动画 与 watcher"></a>状态动画 与 watcher</h3><ul>
<li>通过 watcher 我们能监听到任何数值属性的数值更新，然后调用一些辅助用的动画库(例如tween.js、color.js)完成相应的特殊过渡<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;https://unpkg.com/tween.js@16.3.4&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;div id=&quot;animated-number-demo&quot;&gt;</div><div class="line">  &lt;input v-model.number=&quot;number&quot; type=&quot;number&quot; step=&quot;20&quot;&gt;</div><div class="line">  &lt;p&gt;&#123;&#123; animatedNumber &#125;&#125;&lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#animated-number-demo&apos;,</div><div class="line">  data: &#123;</div><div class="line">    number: 0,</div><div class="line">    animatedNumber: 0</div><div class="line">  &#125;,</div><div class="line">  watch: &#123;</div><div class="line">    number: function(newValue, oldValue) &#123;</div><div class="line">      var vm = this</div><div class="line">      function animate () &#123;</div><div class="line">        if (TWEEN.update()) &#123;</div><div class="line">          requestAnimationFrame(animate)</div><div class="line">        &#125;</div><div class="line">      &#125;</div><div class="line">      new TWEEN.Tween(&#123; tweeningNumber: oldValue &#125;)</div><div class="line">        .easing(TWEEN.Easing.Quadratic.Out)</div><div class="line">        .to(&#123; tweeningNumber: newValue &#125;, 500)</div><div class="line">        .onUpdate(function () &#123;</div><div class="line">          vm.animatedNumber = this.tweeningNumber.toFixed(0)</div><div class="line">        &#125;)</div><div class="line">        .start()</div><div class="line">      animate()</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="动态状态转换"><a href="#动态状态转换" class="headerlink" title="动态状态转换"></a>动态状态转换</h3><ul>
<li>类似动态过渡，每个状态都是可变的(响应式的)</li>
</ul>
<h3 id="通过组件组织过渡"><a href="#通过组件组织过渡" class="headerlink" title="通过组件组织过渡"></a>通过组件组织过渡</h3><ul>
<li>管理太多的状态转换会很快的增加 Vue 实例或者组件的复杂性，幸好很多的动画可以提取到专用的子组件。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div></pre></td><td class="code"><pre><div class="line">&lt;script src=&quot;https://unpkg.com/tween.js@16.3.4&quot;&gt;&lt;/script&gt;</div><div class="line">&lt;div id=&quot;example-8&quot;&gt;</div><div class="line">    &lt;input v-model.number=&quot;firstNumber&quot; type=&quot;number&quot; step=&quot;20&quot;&gt; +</div><div class="line">    &lt;input v-model.number=&quot;secondNumber&quot; type=&quot;number&quot; step=&quot;20&quot;&gt; = &#123;&#123; result &#125;&#125;</div><div class="line">    &lt;p&gt;</div><div class="line">        &lt;!-- 传入输入框的值 --&gt;</div><div class="line">        &lt;animated-integer v-bind:value=&quot;firstNumber&quot;&gt;&lt;/animated-integer&gt; +</div><div class="line">        &lt;animated-integer v-bind:value=&quot;secondNumber&quot;&gt;&lt;/animated-integer&gt; =</div><div class="line">        &lt;animated-integer v-bind:value=&quot;result&quot;&gt;&lt;/animated-integer&gt;</div><div class="line">    &lt;/p&gt;</div><div class="line">&lt;/div&gt;</div><div class="line">// 这种复杂的补间动画逻辑可以被复用</div><div class="line">// 任何整数都可以执行动画</div><div class="line">// 组件化使我们的界面十分清晰</div><div class="line">// 可以支持更多更复杂的动态过渡</div><div class="line">Vue.component(&apos;animated-integer&apos;, &#123;</div><div class="line">    template: &apos;&lt;span&gt;&#123;&#123; tweeningValue &#125;&#125;&lt;/span&gt;&apos;,</div><div class="line">    props: &#123;</div><div class="line">        value: &#123; // 接收的值</div><div class="line">            type: Number,</div><div class="line">            required: true</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    data: function() &#123;</div><div class="line">        return &#123;</div><div class="line">            tweeningValue: 0</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    watch: &#123; // 传过来的值有变化，触发tween</div><div class="line">        value: function(newValue, oldValue) &#123;</div><div class="line">            this.tween(oldValue, newValue)</div><div class="line">        &#125;</div><div class="line">    &#125;,</div><div class="line">    mounted: function() &#123; // 刚载入，触发默认tween</div><div class="line">        this.tween(0, this.value)</div><div class="line">    &#125;,</div><div class="line">    methods: &#123;</div><div class="line">        tween: function(startValue, endValue) &#123;</div><div class="line">            var vm = this;</div><div class="line"></div><div class="line">            // raf</div><div class="line">            function animate() &#123;</div><div class="line">                if (TWEEN.update()) &#123;</div><div class="line">                    requestAnimationFrame(animate)</div><div class="line">                &#125;</div><div class="line">            &#125;</div><div class="line">            // 数值变化的补间动画</div><div class="line">            new TWEEN.Tween(&#123; tweeningValue: startValue &#125;)</div><div class="line">                .to(&#123; tweeningValue: endValue &#125;, 500)</div><div class="line">                .onUpdate(function() &#123;</div><div class="line">                    vm.tweeningValue = this.tweeningValue.toFixed(0)</div><div class="line">                &#125;)</div><div class="line">                .start();</div><div class="line">            // 调用一次    </div><div class="line">            animate();</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">    el: &apos;#example-8&apos;,</div><div class="line">    data: &#123;</div><div class="line">        firstNumber: 20,</div><div class="line">        secondNumber: 40</div><div class="line">    &#125;,</div><div class="line">    computed: &#123;</div><div class="line">        result: function() &#123;</div><div class="line">            return this.firstNumber + this.secondNumber</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="Render函数-gt-用到再补"><a href="#Render函数-gt-用到再补" class="headerlink" title="Render函数-&gt;用到再补"></a>Render函数-&gt;用到再补</h2><h2 id="自定义指令"><a href="#自定义指令" class="headerlink" title="自定义指令"></a>自定义指令</h2><ul>
<li>vue2中代码复用的主要形式和抽象是组件,有的情况下,你仍然<strong>需要对纯 DOM 元素进行底层操作</strong>,这时候就会用到<strong>自定义指令</strong>。</li>
</ul>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><ul>
<li><p>注册</p>
<ul>
<li><p>全局注册</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">// 注册一个全局自定义指令 v-focus</div><div class="line">Vue.directive(&apos;focus&apos;, &#123;</div><div class="line">  // 当绑定元素插入到 DOM 中。</div><div class="line">  inserted: function (el) &#123;</div><div class="line">    // 聚焦元素</div><div class="line">    el.focus()</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>局部注册</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">directives: &#123;</div><div class="line">  focus: &#123;</div><div class="line">    // 指令的定义---</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>使用-&gt;<code>&lt;input v-focus&gt;</code></p>
</li>
</ul>
</li>
</ul>
<h3 id="钩子函数"><a href="#钩子函数" class="headerlink" title="钩子函数"></a>钩子函数</h3><ul>
<li>自定义指令提供下面钩子<ul>
<li><code>bind</code>-&gt;只调用一次，只在第一次绑定到元素时调用，主要用做初始化工作</li>
<li><code>inserted</code>-&gt;被绑定元素插入父节点时调用（父节点存在即可调用，不必存在于 document 中）</li>
<li><code>componentUpdated</code>-&gt;所在组件的 VNode <strong>及其孩子的 VNode</strong> 全部更新时调用。</li>
<li><code>update</code>-&gt;所在组件的 VNode 更新时调用,但是可能发生在其孩子的 VNode 更新之前。指令的值可能发生了改变也可能没有。但是你可以通过比较更新前后的值来忽略不必要的模板更新</li>
<li><code>unbind</code>-&gt; 只调用一次， 指令与元素解绑时调用</li>
</ul>
</li>
</ul>
<h3 id="钩子函数参数"><a href="#钩子函数参数" class="headerlink" title="钩子函数参数"></a>钩子函数参数</h3><ul>
<li>钩子函数的回调在被调用时，会自动传入一些参数<code>el</code>,<code>bingding</code>,<code>vnode</code>,<code>oldVnode</code><br>  -<code>el</code>: 指令所绑定的元素，可以用来直接操作 DOM 。 <ul>
<li><code>binding</code>: 一个对象，包含以下属性<ul>
<li><code>name</code>: 指令名，不包括 v- 前缀。</li>
<li><code>value</code>: 指令的绑定值， 例如： v-my-directive=”1 + 1”, value 的值是 2。</li>
<li><code>oldValue</code>: <strong>指令绑定的前一个值，仅在 update 和 componentUpdated 钩子中可用</strong>。无论值是否改变都可用。</li>
<li><code>expression</code>: 绑定值的字符串形式。 例如 v-my-directive=”1 + 1” ， expression 的值是 “1 + 1”。</li>
<li><code>arg</code>: 传给指令的参数。例如 v-my-directive:foo， arg 的值是 “foo”。</li>
<li><code>modifiers</code>: 一个包含修饰符的对象。 例如： v-my-directive.foo.bar, 修饰符对象 modifiers 的值是 { foo: true, bar: true }。</li>
</ul>
</li>
<li><code>vnode</code>: Vue 编译生成的虚拟节点</li>
<li><code>oldVnode</code>: 上一个虚拟节点，<strong>仅在 update 和 componentUpdated 钩子中可用</strong>。</li>
</ul>
</li>
<li>除了 el 之外，其它参数都应该是只读的，尽量不要修改他们。如果需要在钩子之间共享数据，建议通过元素的 dataset 来进行。<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">&lt;div id=&quot;hook-arguments-example&quot; v-demo:foo.a.b=&quot;message&quot;&gt;&lt;/div&gt;</div><div class="line">Vue.directive(&apos;demo&apos;, &#123;</div><div class="line">  bind: function (el, binding, vnode) &#123;</div><div class="line">    var s = JSON.stringify</div><div class="line">    el.innerHTML =</div><div class="line">      &apos;name: &apos;       + s(binding.name) + &apos;&lt;br&gt;&apos; +</div><div class="line">      &apos;value: &apos;      + s(binding.value) + &apos;&lt;br&gt;&apos; +</div><div class="line">      &apos;expression: &apos; + s(binding.expression) + &apos;&lt;br&gt;&apos; +</div><div class="line">      &apos;argument: &apos;   + s(binding.arg) + &apos;&lt;br&gt;&apos; +</div><div class="line">      &apos;modifiers: &apos;  + s(binding.modifiers) + &apos;&lt;br&gt;&apos; +</div><div class="line">      &apos;vnode keys: &apos; + Object.keys(vnode).join(&apos;, &apos;)</div><div class="line">  &#125;</div><div class="line">&#125;);</div><div class="line">new Vue(&#123;</div><div class="line">  el: &apos;#hook-arguments-example&apos;,</div><div class="line">  data: &#123;</div><div class="line">    message: &apos;hello!&apos;</div><div class="line">  &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="函数简写"><a href="#函数简写" class="headerlink" title="函数简写"></a>函数简写</h3><ul>
<li>大多数情况下，我们可能想在 bind 和 update 钩子上做重复动作，并且不想关心其它的钩子函数。</li>
<li>第二个参数不传入选项对象，而是一个函数，则表示此函数只会在bind和update时被调用<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Vue.directive(&apos;color-swatch&apos;, function (el, binding) &#123;</div><div class="line">  el.style.backgroundColor = binding.value</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="对象字面量"><a href="#对象字面量" class="headerlink" title="对象字面量"></a>对象字面量</h3><ul>
<li>如果指令需要多个值，可以传入一个 JavaScript 对象字面量<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">&lt;div v-demo=&quot;&#123; color: &apos;white&apos;, text: &apos;hello!&apos; &#125;&quot;&gt;&lt;/div&gt;</div><div class="line">Vue.directive(&apos;demo&apos;, function (el, binding) &#123;</div><div class="line">  console.log(binding.value.color) // =&gt; &quot;white&quot;</div><div class="line">  console.log(binding.value.text)  // =&gt; &quot;hello!&quot;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="混合"><a href="#混合" class="headerlink" title="混合"></a>混合</h2><ul>
<li>当多个组件拥有相同的选项时，可以将这些公用选项抽象成一个mixin对象，然后通过配置组件的<code>mixins</code>字段来混入选项(类似jQuery.extend方法)</li>
<li><p>混入策略</p>
<ul>
<li><p>数据对象在内部进行合并；<strong>数据冲突时，以组件数据优先</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mixin = &#123;</div><div class="line">  <span class="attr">data</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">message</span>: <span class="string">'hello'</span>,</div><div class="line">      <span class="attr">foo</span>: <span class="string">'abc'</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">mixins</span>: [mixin],</div><div class="line">  <span class="attr">data</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">message</span>: <span class="string">'goodbye'</span>,</div><div class="line">      <span class="attr">bar</span>: <span class="string">'def'</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">created</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="keyword">this</span>.$data)</div><div class="line">    <span class="comment">// =&gt; &#123; message: "goodbye", foo: "abc", bar: "def" &#125;</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>同名钩子函数，将会混合成一个数组，<strong>混入的钩子函数将在组件自身钩子函数之前调用</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mixin = &#123;</div><div class="line">  <span class="attr">created</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'混入对象的钩子被调用'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">mixins</span>: [mixin],</div><div class="line">  <span class="attr">created</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'组件钩子被调用'</span>)</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// =&gt; "混入对象的钩子被调用"</span></div><div class="line"><span class="comment">// =&gt; "组件钩子被调用"</span></div></pre></td></tr></table></figure>
</li>
<li><p>值为对象的选项，例如 methods, components 和 directives，将被混合为同一个对象。<strong>两个对象键名冲突时，取组件对象的键值对</strong></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> mixin = &#123;</div><div class="line">  <span class="attr">methods</span>: &#123;</div><div class="line">    <span class="attr">foo</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'foo'</span>)</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">conflicting</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'from mixin'</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">var</span> vm = <span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">mixins</span>: [mixin],</div><div class="line">  <span class="attr">methods</span>: &#123;</div><div class="line">    <span class="attr">bar</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'bar'</span>)</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">conflicting</span>: <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="built_in">console</span>.log(<span class="string">'from self'</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line">vm.foo() <span class="comment">// =&gt; "foo"</span></div><div class="line">vm.bar() <span class="comment">// =&gt; "bar"</span></div><div class="line">vm.conflicting() <span class="comment">// =&gt; "from self"</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="插件"><a href="#插件" class="headerlink" title="插件"></a>插件</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> MyPlugin form <span class="string">'xxxx'</span>;</div><div class="line"></div><div class="line"><span class="comment">// 插件一定要通过use来注册一下</span></div><div class="line">Vue.use(MyPlugin, &#123; <span class="attr">someOption</span>: <span class="literal">true</span> &#125;);</div></pre></td></tr></table></figure>
<h2 id="单文件组件"><a href="#单文件组件" class="headerlink" title="单文件组件"></a>单文件组件</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 每个.vue文件只能包含一个template，template内只能有一个根节点 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"app"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"./assets/logo.png"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">router-view</span>/&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 每个 .vue 文件最多包含一个 &lt;script&gt; 块 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="javascript"></span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  <span class="attr">name</span>: <span class="string">'app'</span></div><div class="line">&#125;</div><div class="line"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 可以有多个style，可以在根组件中导入一些全局样式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">src</span>=<span class="string">"./assets/test.scss"</span> <span class="attr">lang</span>=<span class="string">"scss"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">src</span>=<span class="string">"./assets/test2.scss"</span> <span class="attr">lang</span>=<span class="string">"scss"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 导入路径都是基于当前目录的，不过可以从NPM包中直接导入资源，如下 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;style src="todomvc-app-css/index.css"&gt;&lt;/style&gt; --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 当style标签有 scoped 属性时，它的 CSS 只作用于当前组件中的元素 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;style scoped&gt;.example &#123;color: red;&#125;&lt;/style&gt; --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 在你的 &lt;style&gt; 上添加 module 属性，将为 css-loader 打开 CSS Modules 模式，生成的 CSS 对象将为组件注入一个名叫 $style 的计算属性，你可以在你的模块中使用动态 class 绑定 --&gt;</span></div></pre></td></tr></table></figure>
<h2 id="生产环境部署提示"><a href="#生产环境部署提示" class="headerlink" title="生产环境部署提示"></a>生产环境部署提示</h2><ul>
<li>记得定义<code>process.env.NODE_ENV = &#39;production&#39;</code></li>
<li><code>vue-cli</code>的build命令已经预先定义了</li>
</ul>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><h3 id="简单路由"><a href="#简单路由" class="headerlink" title="简单路由"></a>简单路由</h3><ul>
<li>HTML5 History API<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> NotFound = &#123; <span class="attr">template</span>: <span class="string">'&lt;p&gt;Page not found&lt;/p&gt;'</span> &#125;</div><div class="line"><span class="keyword">const</span> Home = &#123; <span class="attr">template</span>: <span class="string">'&lt;p&gt;home page&lt;/p&gt;'</span> &#125;</div><div class="line"><span class="keyword">const</span> About = &#123; <span class="attr">template</span>: <span class="string">'&lt;p&gt;about page&lt;/p&gt;'</span> &#125;</div><div class="line"><span class="keyword">const</span> routes = &#123;</div><div class="line">  <span class="string">'/'</span>: Home,</div><div class="line">  <span class="string">'/about'</span>: About</div><div class="line">&#125;</div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#app'</span>,</div><div class="line">  <span class="attr">data</span>: &#123;</div><div class="line">    <span class="attr">currentRoute</span>: <span class="built_in">window</span>.location.pathname</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">computed</span>: &#123;</div><div class="line">    ViewComponent () &#123;</div><div class="line">      <span class="keyword">return</span> routes[<span class="keyword">this</span>.currentRoute] || NotFound</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  render (h) &#123; <span class="keyword">return</span> h(<span class="keyword">this</span>.ViewComponent) &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="官方路由Vue-router"><a href="#官方路由Vue-router" class="headerlink" title="官方路由Vue-router"></a>官方路由Vue-router</h3><ul>
<li><p>基础使用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// router/index.js</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span>;</div><div class="line"></div><div class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span>;<span class="comment">// 导入vue-router</span></div><div class="line"></div><div class="line">..</div><div class="line">import Recommend <span class="keyword">from</span> <span class="string">'components/recommend/recommend'</span></div><div class="line"><span class="keyword">import</span> Singer <span class="keyword">from</span> <span class="string">'components/singer/singer'</span></div><div class="line">...</div><div class="line"></div><div class="line">Vue.use(Router); <span class="comment">// 必须使用use方法来注册第三方插件</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;<span class="comment">// 导出一个vue-router实例</span></div><div class="line">  routes: [&#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'/'</span>,</div><div class="line">    <span class="attr">redirect</span>: <span class="string">'/recommend'</span>,<span class="comment">// 没有匹配到的路径全部重定向到/recomend</span></div><div class="line">  &#125;, &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'/recommend'</span>,<span class="comment">// path一定是个路径，开头必须有/</span></div><div class="line">    name: <span class="string">'Recommend'</span>,</div><div class="line">    <span class="attr">component</span>: Recommend,</div><div class="line">    <span class="attr">children</span>: [&#123;<span class="comment">// 子路由</span></div><div class="line">      path: <span class="string">':id'</span>,<span class="comment">// 传递的参数</span></div><div class="line">      name: <span class="string">'Disc'</span>,</div><div class="line">      <span class="attr">component</span>: Disc</div><div class="line">    &#125;]</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// src/main.js</span></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line">...</div><div class="line">import router <span class="keyword">from</span> <span class="string">'./router'</span>; <span class="comment">// 导入</span></div><div class="line">...</div><div class="line"></div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#app'</span>,</div><div class="line">  router,<span class="comment">// 注册</span></div><div class="line">  store,</div><div class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>动态路由匹配</p>
  <figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/div&gt;'</span>,<span class="comment">// 获取传递动态路由参数</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    <span class="comment">// 动态路径参数 以冒号开头</span></div><div class="line">    &#123; <span class="attr">path</span>: <span class="string">'/user/:id'</span>, <span class="attr">component</span>: User &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
<ul>
<li>响应路由参数的变化<ul>
<li>使用动态路由时，如果组件相同，仅路由参数不同，vue会复用组件(导致组件的生命周期钩子，无法再被触发)，可以对路由参数的变化做个观测，来响应变化；<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用watch观测$route的变化，来做响应</span></div><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'...'</span>,</div><div class="line">  <span class="attr">watch</span>: &#123;</div><div class="line">    <span class="string">'$route'</span> (to, <span class="keyword">from</span>) &#123;</div><div class="line">      <span class="comment">// 对路由变化作出响应...</span></div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 或者使用2.2+的beforeRouteUpdate</span></div><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'...'</span>,</div><div class="line">  beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    <span class="comment">// react to route changes...</span></div><div class="line">    <span class="comment">// don't forget to call next()</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
<li><p>嵌套路由</p>
<ul>
<li>在定义routes使用children字段来定义自路由，并在上层路由对应的组件中添加一个<code>router-view</code></li>
<li>注意子路由开头不能以<code>/</code>开头，这代表根目录<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// User.js</span></div><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">`</span></div><div class="line">    &lt;div class="user"&gt;</div><div class="line">      &lt;h2&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/h2&gt;</div><div class="line">      &lt;router-view&gt;&lt;/router-view&gt;</div><div class="line">    &lt;/div&gt;</div><div class="line">  `</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123; <span class="attr">path</span>: <span class="string">'/user/:id'</span>, <span class="attr">component</span>: User,</div><div class="line">      <span class="attr">children</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="comment">// 当 /user/:id/profile 匹配成功，</span></div><div class="line">          <span class="comment">// UserProfile 会被渲染在 User 的 &lt;router-view&gt; 中</span></div><div class="line">          path: <span class="string">'profile'</span>,</div><div class="line">          <span class="attr">component</span>: UserProfile</div><div class="line">        &#125;,</div><div class="line">        &#123;</div><div class="line">          <span class="comment">// 当 /user/:id/posts 匹配成功</span></div><div class="line">          <span class="comment">// UserPosts 会被渲染在 User 的 &lt;router-view&gt; 中</span></div><div class="line">          path: <span class="string">'posts'</span>,</div><div class="line">          <span class="attr">component</span>: UserPosts</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>路由跳转api</p>
<ul>
<li><p>router.push()，向历史记录栈中压入一条历史记录</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 字符串</span></div><div class="line">router.push(<span class="string">'home'</span>)</div><div class="line"></div><div class="line"><span class="comment">// 对象</span></div><div class="line">router.push(&#123; <span class="attr">path</span>: <span class="string">'home'</span> &#125;)</div><div class="line"></div><div class="line"><span class="comment">// 命名的路由</span></div><div class="line">router.push(&#123; <span class="attr">name</span>: <span class="string">'user'</span>, <span class="attr">params</span>: &#123; <span class="attr">userId</span>: <span class="number">123</span> &#125;&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 带查询参数，变成 /register?plan=private</span></div><div class="line">router.push(&#123; <span class="attr">path</span>: <span class="string">'register'</span>, <span class="attr">query</span>: &#123; <span class="attr">plan</span>: <span class="string">'private'</span> &#125;&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 如果提供了 path，params就会被忽略，上述例子中的 query 并不属于这种情况</span></div><div class="line"><span class="comment">// 这里的 params 不生效</span></div><div class="line">router.push(&#123; <span class="attr">path</span>: <span class="string">'/user'</span>, <span class="attr">params</span>: &#123; userId &#125;&#125;) <span class="comment">// -&gt; /user</span></div></pre></td></tr></table></figure>
</li>
<li><p>router.replace()替换当前记录，用法类似push</p>
</li>
<li>router.go()历史记录前进后台几步</li>
</ul>
</li>
<li><p>可以给路由命名</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">const router = new VueRouter(&#123;</div><div class="line">  routes: [</div><div class="line">    &#123;</div><div class="line">      path: '/user/:userId',</div><div class="line">      name: 'user',// 取个名字</div><div class="line">      component: User</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"></div><div class="line">// 调用</div><div class="line">&lt;router-link :to="&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;"&gt;User&lt;/router-link&gt;</div><div class="line">router.push(&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>也可以给视图命名，方便创建sidebar、main双视图的布局</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">&lt;router-view <span class="class"><span class="keyword">class</span></span>=<span class="string">"view one"</span>&gt;&lt;/router-view&gt; // 默认视图的name为default</div><div class="line">&lt;router-view class="view two" name="a"&gt;&lt;/router-view&gt;</div><div class="line">&lt;router-view class="view three" name="b"&gt;&lt;/router-view&gt;</div><div class="line"></div><div class="line">const router = new VueRouter(&#123;</div><div class="line">  routes: [</div><div class="line">    &#123;</div><div class="line">      path: '/',</div><div class="line">      components: &#123;</div><div class="line">        // 匹配'/'路径时，default视图渲染Foo组件,a视图渲染Bar,b视图渲染Baz</div><div class="line">        default: Foo,</div><div class="line">        a: Bar,</div><div class="line">        b: Baz</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>重定向、别名</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 重定向</span></div><div class="line"><span class="comment">// 当用户访问 /a时，URL 将会被替换成 /b，然后匹配路由为 /b</span></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123; <span class="attr">path</span>: <span class="string">'/a'</span>, <span class="attr">redirect</span>: <span class="string">'/b'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"><span class="comment">// 别名</span></div><div class="line"><span class="comment">// /a 的别名是 /b，意味着，当用户访问 /b 时，URL 会保持为 /b，但是路由匹配则为 /a，就像用户访问 /a 一样。</span></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123; <span class="attr">path</span>: <span class="string">'/a'</span>, <span class="attr">component</span>: A, <span class="attr">alias</span>: <span class="string">'/b'</span> &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>向组件传递数据</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 利用动态路径参数来直接传递，组件和路由耦合性高</span></div><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;User &#123;&#123; $route.params.id &#125;&#125;&lt;/div&gt;'</span></div><div class="line">&#125;</div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123; <span class="attr">path</span>: <span class="string">'/user/:id'</span>, <span class="attr">component</span>: User &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 通过 props 解耦</span></div><div class="line"><span class="keyword">const</span> User = &#123;</div><div class="line">  <span class="attr">props</span>: [<span class="string">'id'</span>],</div><div class="line">  <span class="attr">template</span>: <span class="string">'&lt;div&gt;User &#123;&#123; id &#125;&#125;&lt;/div&gt;'</span></div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/user/:id'</span>,</div><div class="line">      <span class="attr">component</span>: User, </div><div class="line">      <span class="attr">props</span>: <span class="literal">true</span>,<span class="comment">// 参数会做为props传入到组件中 </span></div><div class="line">    &#125;,</div><div class="line">    <span class="comment">// 对于包含命名视图的路由，你必须分别为每个命名视图添加 `props` 选项：</span></div><div class="line">    &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/user/:id'</span>,</div><div class="line">      <span class="attr">components</span>: &#123; <span class="attr">default</span>: User, <span class="attr">sidebar</span>: Sidebar &#125;,</div><div class="line">      <span class="attr">props</span>: &#123; <span class="attr">default</span>: <span class="literal">true</span>, <span class="attr">sidebar</span>: <span class="literal">false</span> &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>注册导航守卫(事件)</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123; ... &#125;)</div><div class="line"><span class="comment">// 全局路由守卫</span></div><div class="line"><span class="comment">// 全局前置守卫，路由确认时触发</span></div><div class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</div><div class="line">    <span class="comment">// to: Route: 即将要进入的目标 路由对象</span></div><div class="line">    <span class="comment">// from: Route: 当前导航正要离开的路由</span></div><div class="line">    <span class="comment">// next: Function: 一定要调用该方法来 resolve 这个钩子。执行效果依赖 next 方法的调用参数。</span></div><div class="line">&#125;)</div><div class="line"><span class="comment">// 全局解析守卫，路由确认之后，组内守卫、异步路由组建被解析之后触发</span></div><div class="line">router.beforeResolve()</div><div class="line"><span class="comment">// 全局后置守卫，路由到达后触发</span></div><div class="line">router.afterEach(<span class="function">(<span class="params">to, <span class="keyword">from</span></span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// ...</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 单独路由的守卫</span></div><div class="line"><span class="comment">// 定义在一个单独路由上</span></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/foo'</span>,</div><div class="line">      <span class="attr">component</span>: Foo,</div><div class="line">      <span class="attr">beforeEnter</span>: <span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</div><div class="line">        <span class="comment">// ...</span></div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 组件内路由守卫</span></div><div class="line"><span class="keyword">const</span> Foo = &#123;</div><div class="line">  <span class="attr">template</span>: <span class="string">`...`</span>,</div><div class="line">  beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    <span class="comment">// 在渲染该组件的对应路由被 confirm 前调用</span></div><div class="line">    <span class="comment">// 因为当守卫执行前，组件实例还没被创建</span></div><div class="line">    <span class="comment">// 不！能！获取组件实例 `this`，不过这个守卫中的next很特殊，可以接收一个回调，回调会接收到vm实例，可以通过vm实例来访问this</span></div><div class="line">    next(<span class="function"><span class="params">vm</span>=&gt;</span>&#123;</div><div class="line">        <span class="comment">// do sth</span></div><div class="line">    &#125;);</div><div class="line">  &#125;,</div><div class="line">  beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    <span class="comment">// 在当前路由改变，但是该组件被复用时调用</span></div><div class="line">    <span class="comment">// 举例来说，对于一个带有动态参数的路径 /foo/:id，在 /foo/1 和 /foo/2 之间跳转的时候，</span></div><div class="line">    <span class="comment">// 由于会渲染同样的 Foo 组件，因此组件实例会被复用。而这个钩子就会在这个情况下被调用。</span></div><div class="line">    <span class="comment">// 可以访问组件实例 `this`</span></div><div class="line">  &#125;,</div><div class="line">  beforeRouteLeave (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    <span class="comment">// 导航离开该组件的对应路由时调用</span></div><div class="line">    <span class="comment">// 可以访问组件实例 `this`</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>路由解析流程</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="number">1.</span>导航被触发。</div><div class="line"><span class="number">2.</span>在失活的组件里调用离开守卫。</div><div class="line"><span class="number">3.</span>调用全局的 beforeEach 守卫。</div><div class="line"><span class="number">4.</span>在重用的组件里调用 beforeRouteUpdate 守卫 (<span class="number">2.2</span>+)。</div><div class="line"><span class="number">5.</span>在路由配置里调用 beforeEnter。</div><div class="line"><span class="number">6.</span>解析异步路由组件。</div><div class="line"><span class="number">7.</span>在被激活的组件里调用 beforeRouteEnter。</div><div class="line"><span class="number">8.</span>调用全局的 beforeResolve 守卫 (<span class="number">2.5</span>+)。</div><div class="line"><span class="number">9.</span>导航被确认。</div><div class="line"><span class="number">10.</span>调用全局的 afterEach 钩子。</div><div class="line"><span class="number">11.</span>触发 DOM 更新。</div><div class="line"><span class="number">12.</span>用创建好的实例调用 beforeRouteEnter 守卫中传给 next 的回调函数。</div></pre></td></tr></table></figure>
</li>
<li><p>路由元信息，可用来完成页面是否登录的需求</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [</div><div class="line">    &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/foo'</span>,</div><div class="line">      <span class="attr">component</span>: Foo,</div><div class="line">      <span class="attr">children</span>: [</div><div class="line">        &#123;</div><div class="line">          <span class="attr">path</span>: <span class="string">'bar'</span>,</div><div class="line">          <span class="attr">component</span>: Bar,</div><div class="line">          <span class="comment">// a meta field，定义/foo/bar需要登录</span></div><div class="line">          meta: &#123; <span class="attr">requiresAuth</span>: <span class="literal">true</span> &#125;</div><div class="line">        &#125;</div><div class="line">      ]</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 注册全局的路由前置守卫</span></div><div class="line">router.beforeEach(<span class="function">(<span class="params">to, <span class="keyword">from</span>, next</span>) =&gt;</span> &#123;</div><div class="line">  <span class="comment">// 一个路由匹配到的所有路由记录会暴露为 $route 对象的 $route.matched 数组</span></div><div class="line">  <span class="comment">// 遍历$route.matched数组，检查meta字段</span></div><div class="line">  <span class="keyword">if</span> (to.matched.some(<span class="function"><span class="params">record</span> =&gt;</span> record.meta.requiresAuth)) &#123;</div><div class="line">    <span class="comment">// this route requires auth, check if logged in</span></div><div class="line">    <span class="comment">// if not, redirect to login page.</span></div><div class="line">    <span class="comment">// 未登录，则跳转登录，并附带一个返回的url</span></div><div class="line">    <span class="keyword">if</span> (!auth.loggedIn()) &#123;</div><div class="line">      next(&#123;</div><div class="line">        <span class="attr">path</span>: <span class="string">'/login'</span>,</div><div class="line">        <span class="comment">// 传递给登录页面一个返回的url地址</span></div><div class="line">        query: &#123; <span class="attr">redirect</span>: to.fullPath &#125;</div><div class="line">      &#125;)</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      next()</div><div class="line">    &#125;</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    next() <span class="comment">// 确保一定要调用 next()</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>路由过渡效果</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line">// 所有路由设置一样的过渡效果</div><div class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div><div class="line"></div><div class="line">// 配合keep-alive</div><div class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div><div class="line"></div><div class="line">// 单个路由设置过度效果</div><div class="line">const Foo = &#123;</div><div class="line">  template: `</div><div class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"slide"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"foo"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div><div class="line">  `</div><div class="line">&#125;</div><div class="line"></div><div class="line">const Bar = &#123;</div><div class="line">  template: `</div><div class="line">    <span class="tag">&lt;<span class="name">transition</span> <span class="attr">name</span>=<span class="string">"fade"</span>&gt;</span></div><div class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"bar"</span>&gt;</span>...<span class="tag">&lt;/<span class="name">div</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div><div class="line">  `</div><div class="line">&#125;</div><div class="line"></div><div class="line">// 动态过渡(进入用一个效果，退出用另一个效果)</div><div class="line"><span class="comment">&lt;!-- 使用动态的 transition name --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">transition</span> <span class="attr">:name</span>=<span class="string">"transitionName"</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div><div class="line">// 接着在父组件内</div><div class="line">// watch $route 决定使用哪种过渡</div><div class="line">watch: &#123;</div><div class="line">  '$route' (to, from) &#123;</div><div class="line">    const toDepth = to.path.split('/').length</div><div class="line">    const fromDepth = from.path.split('/').length</div><div class="line">    this.transitionName = toDepth <span class="tag">&lt; <span class="attr">fromDepth</span> ? '<span class="attr">slide-right</span>' <span class="attr">:</span> '<span class="attr">slide-left</span>'</span></div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>数据获取</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 导航完成后，在created中获取数据</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">loading</span>: <span class="literal">false</span>,</div><div class="line">      <span class="attr">post</span>: <span class="literal">null</span>,</div><div class="line">      <span class="attr">error</span>: <span class="literal">null</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  created () &#123;</div><div class="line">    <span class="comment">// 组件创建完后获取数据，</span></div><div class="line">    <span class="comment">// 此时 data 已经被 observed 了</span></div><div class="line">    <span class="keyword">this</span>.fetchData()</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// 导航进入前获取数据</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</div><div class="line">  data () &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">post</span>: <span class="literal">null</span>,</div><div class="line">      <span class="attr">error</span>: <span class="literal">null</span></div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  beforeRouteEnter (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    getPost(to.params.id, (err, post) =&gt; &#123;</div><div class="line">      next(<span class="function"><span class="params">vm</span> =&gt;</span> vm.setData(err, post))</div><div class="line">    &#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="comment">// 路由改变前，组件就已经渲染完了</span></div><div class="line">  <span class="comment">// 逻辑稍稍不同</span></div><div class="line">  beforeRouteUpdate (to, <span class="keyword">from</span>, next) &#123;</div><div class="line">    <span class="keyword">this</span>.post = <span class="literal">null</span></div><div class="line">    getPost(to.params.id, (err, post) =&gt; &#123;</div><div class="line">      <span class="keyword">this</span>.setData(err, post)</div><div class="line">      next()</div><div class="line">    &#125;)</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">methods</span>: &#123;</div><div class="line">    setData (err, post) &#123;</div><div class="line">      <span class="keyword">if</span> (err) &#123;</div><div class="line">        <span class="keyword">this</span>.error = err.toString()</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">this</span>.post = post</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>记录上次滚动位置</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [...],</div><div class="line">  scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</div><div class="line">    <span class="comment">// return 期望滚动到哪个的位置</span></div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> VueRouter(&#123;</div><div class="line">  <span class="attr">routes</span>: [...],</div><div class="line">    scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</div><div class="line">    <span class="comment">// 如果savedPosition，存在则滚动到特定位置，否则滚动到顶部</span></div><div class="line">      <span class="keyword">if</span> (savedPosition) &#123;</div><div class="line">        <span class="keyword">return</span> savedPosition</div><div class="line">      &#125; <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="number">0</span>, <span class="attr">y</span>: <span class="number">0</span> &#125;</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// 如果你要模拟『滚动到锚点』的行为</span></div><div class="line">scrollBehavior (to, <span class="keyword">from</span>, savedPosition) &#123;</div><div class="line">  <span class="keyword">if</span> (to.hash) &#123;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">      <span class="attr">selector</span>: to.hash</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>路由懒加载</p>
<ul>
<li>路由被访问时，才加载对应的组件<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> Router <span class="keyword">from</span> <span class="string">'vue-router'</span></div><div class="line"></div><div class="line">Vue.use(Router)</div><div class="line"></div><div class="line"><span class="keyword">const</span> Recommend = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/recommend/recommend'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Singer = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/singer/singer'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Rank = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/rank/rank'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Search = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/search/search'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> SingerDetail = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/singer-detail/singer-detail'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> Disc = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/disc/disc'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> TopList = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/top-list/top-list'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">const</span> UserCenter = <span class="function">(<span class="params">resolve</span>) =&gt;</span> &#123;</div><div class="line">  <span class="keyword">import</span>(<span class="string">'components/user-center/user-center'</span>).then(<span class="function">(<span class="params"><span class="built_in">module</span></span>) =&gt;</span> &#123;</div><div class="line">    resolve(<span class="built_in">module</span>)</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Router(&#123;</div><div class="line">  <span class="attr">routes</span>: [&#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'/'</span>,</div><div class="line">    <span class="attr">redirect</span>: <span class="string">'/recommend'</span></div><div class="line">  &#125;, &#123;</div><div class="line">    <span class="attr">path</span>: <span class="string">'/recommend'</span>,</div><div class="line">    <span class="attr">name</span>: <span class="string">'Recommend'</span>,</div><div class="line">    <span class="attr">component</span>: Recommend,</div><div class="line">    <span class="attr">children</span>: [&#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">':id'</span>,</div><div class="line">      <span class="attr">name</span>: <span class="string">'Disc'</span>,</div><div class="line">      <span class="attr">component</span>: Disc</div><div class="line">    &#125;]</div><div class="line">  &#125;,</div><div class="line">    &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/singer'</span>,</div><div class="line">      <span class="attr">name</span>: <span class="string">'Singer'</span>,</div><div class="line">      <span class="attr">component</span>: Singer,</div><div class="line">      <span class="attr">children</span>: [&#123;</div><div class="line">        <span class="attr">path</span>: <span class="string">':id'</span>,</div><div class="line">        <span class="attr">name</span>: <span class="string">'SingerDetail'</span>,</div><div class="line">        <span class="attr">component</span>: SingerDetail</div><div class="line">      &#125;]</div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/rank'</span>,</div><div class="line">      <span class="attr">name</span>: <span class="string">'Rank'</span>,</div><div class="line">      <span class="attr">component</span>: Rank,</div><div class="line">      <span class="attr">children</span>:[&#123;</div><div class="line">        <span class="attr">path</span>:<span class="string">':id'</span>,</div><div class="line">        <span class="attr">name</span>: <span class="string">'TopList'</span>,</div><div class="line">        <span class="attr">component</span>:TopList</div><div class="line">      &#125;]</div><div class="line">    &#125;, &#123;</div><div class="line">      <span class="attr">path</span>: <span class="string">'/search'</span>,</div><div class="line">      <span class="attr">name</span>: <span class="string">'Search'</span>,</div><div class="line">      <span class="attr">component</span>: Search,</div><div class="line">      <span class="attr">children</span>: [&#123;</div><div class="line">        <span class="attr">path</span>: <span class="string">':id'</span>,</div><div class="line">        <span class="attr">name</span>: <span class="string">'SingerDetail'</span>,</div><div class="line">        <span class="attr">component</span>: SingerDetail</div><div class="line">      &#125;]</div><div class="line">    &#125;,&#123;</div><div class="line">      <span class="attr">path</span>:<span class="string">'/user'</span>,</div><div class="line">      <span class="attr">name</span>:<span class="string">'User'</span>,</div><div class="line">      <span class="attr">component</span>:UserCenter</div><div class="line">    &#125;</div><div class="line">  ]</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>router-link</code></p>
<ul>
<li>默认被渲染为a标签</li>
<li>激活时，会自动加上<code>router-link-active样式类</code><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 字符串 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">to</span>=<span class="string">"home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 渲染结果 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"home"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="comment">&lt;!-- 使用 v-bind 的 JS 表达式 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">v-bind:to</span>=<span class="string">"'home'"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="comment">&lt;!-- 不写 v-bind 也可以，就像绑定别的属性一样 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"'home'"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="comment">&lt;!-- 同上 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"&#123; path: 'home' &#125;"</span>&gt;</span>Home<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="comment">&lt;!-- 命名的路由 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"&#123; name: 'user', params: &#123; userId: 123 &#125;&#125;"</span>&gt;</span>User<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div><div class="line">    </div><div class="line"><span class="comment">&lt;!-- 带查询参数，下面的结果为 /register?plan=private --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">router-link</span> <span class="attr">:to</span>=<span class="string">"&#123; path: 'register', query: &#123; plan: 'private' &#125;&#125;"</span>&gt;</span>Register<span class="tag">&lt;/<span class="name">router-link</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>router-view</code></p>
<ul>
<li>可以通过name定义命名视图</li>
<li>配合keep-alive、transition<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">transition</span>&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">router-view</span>&gt;</span><span class="tag">&lt;/<span class="name">router-view</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">transition</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="状态管理"><a href="#状态管理" class="headerlink" title="状态管理"></a>状态管理</h2><h3 id="类-Flux-状态管理的官方实现"><a href="#类-Flux-状态管理的官方实现" class="headerlink" title="类 Flux 状态管理的官方实现"></a>类 Flux 状态管理的官方实现</h3><ul>
<li>由于多个状态分散的跨越在许多组件和交互间各个角落，大型应用复杂度也经常逐渐增长。为了解决这个问题，Vue 提供 vuex： 我们有受到 Elm 启发的状态管理库</li>
</ul>
<h3 id="简单状态管理起步使用"><a href="#简单状态管理起步使用" class="headerlink" title="简单状态管理起步使用"></a>简单状态管理起步使用</h3><ul>
<li><p>Vue 应用中原始数据对象的实际来源 - 当访问数据对象时，一个 Vue 实例只是简单的代理访问。所以，如果你有一处需要被多个实例间共享的状态，可以简单地通过维护一份数据来实现共享</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">const sourceOfTruth = &#123;&#125;</div><div class="line">const vmA = new Vue(&#123;</div><div class="line">  data: sourceOfTruth</div><div class="line">&#125;)</div><div class="line">const vmB = new Vue(&#123;</div><div class="line">  data: sourceOfTruth</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>现在当 sourceOfTruth 发生变化，vmA 和 vmB 都将自动的更新引用它们的视图。子组件们的每个实例也会通过 this.$root.$data 去访问。现在我们有了唯一的实际来源，但是，调试将会变为噩梦。任何时间，我们应用中的任何部分，在任何数据改变后，都不会留下变更过的记录</p>
</li>
<li><p>为了解决这个问题，我们采用一个简单的 store 模式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line">var store = &#123;</div><div class="line">  debug: true,</div><div class="line">  state: &#123;</div><div class="line">    message: &apos;Hello!&apos;</div><div class="line">  &#125;,</div><div class="line">  setMessageAction (newValue) &#123;</div><div class="line">    if (this.debug) console.log(&apos;setMessageAction triggered with&apos;, newValue)</div><div class="line">    this.state.message = newValue</div><div class="line">  &#125;,</div><div class="line">  clearMessageAction () &#123;</div><div class="line">    if (this.debug) console.log(&apos;clearMessageAction triggered&apos;)</div><div class="line">    this.state.message = &apos;&apos;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>所有 store 中 state 的改变，都放置在 store 自身的 action 中去管理,这种集中式状态管理能够被更容易地理解哪种类型的 mutation 将会发生，以及它们是如何被触发。当错误出现时，我们现在也会有一个 log 记录 bug 之前发生了什么</p>
</li>
<li>此外，每个实例/组件仍然可以拥有和管理自己的私有状态：<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">var vmA = new Vue(&#123;</div><div class="line">  data: &#123;</div><div class="line">    privateState: &#123;&#125;,</div><div class="line">    sharedState: store.state</div><div class="line">  &#125;</div><div class="line">&#125;)</div><div class="line">var vmB = new Vue(&#123;</div><div class="line">  data: &#123;</div><div class="line">    privateState: &#123;&#125;,</div><div class="line">    sharedState: store.state</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<p><img src="/2017/08/01/Vue-guide/state.png" alt=""></p>
<ul>
<li>重要的是，注意你不应该在 action 中 替换原始的状态对象 - 组件和 store 需要引用同一个共享对象，mutation 才能够被观察</li>
<li>接着我们继续延伸约定，组件不允许直接修改属于 store 实例的 state，而应执行 action 来分发 (dispatch) 事件通知 store 去改变，我们最终达成了 Flux 架构</li>
<li><p>这样约定的好处是，我们能够记录所有 store 中发生的 state 改变，同时实现能做到记录变更 (mutation) 、保存状态快照、历史回滚/时光旅行的先进的调试工具</p>
<h3 id="vuex"><a href="#vuex" class="headerlink" title="vuex"></a>vuex</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">const</span> store = <span class="keyword">new</span> Vuex.Store(&#123;</div><div class="line">  <span class="attr">state</span>: &#123;</div><div class="line">    <span class="comment">// 需要全局共享的数据</span></div><div class="line">    count: <span class="number">1</span></div><div class="line">  &#125;,</div><div class="line">  <span class="attr">mutations</span>: &#123;</div><div class="line">    <span class="comment">// 注册一个increment mutations</span></div><div class="line">    increment (state,payload) &#123;</div><div class="line">      <span class="comment">// 变更状态</span></div><div class="line">      state.count += payload.amount</div><div class="line">    &#125;</div><div class="line">  &#125;,</div><div class="line">  <span class="attr">actions</span>: &#123;</div><div class="line">    incrementAsync (context,payload) &#123;</div><div class="line">      setTimeout(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</div><div class="line">        context.commit(<span class="string">'increment'</span>)</div><div class="line">      &#125;, <span class="number">1000</span>)</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p><code>states</code></p>
<ul>
<li>需要全局共享的基础数据，派生数据(计算数据)可以通过编写getters来实现</li>
</ul>
</li>
<li><code>getters</code><ul>
<li>类似计算属性，可以用来访问基于state派生出的一些state，主要用来访问states</li>
</ul>
</li>
<li><code>mutations</code><ul>
<li>很类似事件，只能通过提交mutations来改变state(方便开发工具跟踪)，主要用来设置states</li>
<li>提交mutaions是改变state的唯一方式</li>
<li>只能是同步任务，异步任务需要<code>actions</code>来完成</li>
<li>每一个mutation，store会传入state和可选的payload</li>
</ul>
</li>
<li><p><code>commit</code></p>
<ul>
<li>用来提交<code>mutaions</code></li>
<li>可以传递额外的参数<code>payload</code>给<code>mutaions</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">store.commit(<span class="string">'increment'</span>, &#123;</div><div class="line">  <span class="attr">amount</span>: <span class="number">10</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><code>actions</code></p>
<ul>
<li>主要用来完成异步任务;需要请求后台的任务全部放在<code>actions</code>中</li>
<li><code>action</code>不会直接变更状态，而是通过提交mutation来改变state，</li>
<li>每个action，store会传入一个context和可选的payload，context包含store实例的所有方法和属性。因此你可以调用 <code>context.commit</code> 提交一个 <code>mutation</code>，或者通过 <code>context.state</code> 和 <code>context.getters</code> 来获取 <code>state</code> 和 <code>getters</code></li>
</ul>
</li>
<li><p><code>dispatch</code></p>
<ul>
<li>用来分发(提交)action</li>
<li>可以传递额外的参数(<code>payload</code>)给<code>actions</code><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">store.dispatch(<span class="string">'incrementAsync'</span>, &#123;</div><div class="line">  <span class="attr">amount</span>: <span class="number">10</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>辅助函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mapState、mapGetters、mapMutations、mapActions，都是返回一个对象，可以使用扩展预算符解析出来</span></div><div class="line"><span class="keyword">new</span> Vue(&#123;</div><div class="line">    <span class="attr">el</span>:<span class="string">'#app'</span>,</div><div class="line">    store,</div><div class="line">    <span class="attr">computed</span>: &#123;</div><div class="line">        localComputed () &#123;&#125;,</div><div class="line">        <span class="comment">// 使用对象展开运算符将此对象混入到外部对象中</span></div><div class="line">        ...mapState([</div><div class="line">            count,<span class="comment">// 将this.count 映射为 store.state.count</span></div><div class="line">        ]),</div><div class="line">        ...mapGetters([</div><div class="line">            <span class="string">'doneTodosCount'</span>,<span class="comment">// 将this.doneTodosCount 映射为 store.getters.doneTodosCount</span></div><div class="line">            <span class="string">'anotherGetter'</span>,<span class="comment">// 将this.anotherGetter 映射为 store.getters.anotherGetter</span></div><div class="line">        ])</div><div class="line">    &#125;,</div><div class="line">    <span class="attr">methods</span>: &#123;</div><div class="line">        ...mapMutations([</div><div class="line">            <span class="string">'increment'</span>, <span class="comment">// 将 `this.increment()` 映射为 `this.$store.commit('increment')`</span></div><div class="line">        </div><div class="line">            <span class="comment">// `mapMutations` 也支持载荷：</span></div><div class="line">            <span class="string">'incrementBy'</span> <span class="comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.commit('incrementBy', amount)`</span></div><div class="line">        ]),</div><div class="line">        ...mapMutations(&#123;</div><div class="line">            <span class="attr">add</span>: <span class="string">'increment'</span> <span class="comment">// 将 `this.add()` 映射为 `this.$store.commit('increment')`</span></div><div class="line">        &#125;),</div><div class="line">        ...mapActions([</div><div class="line">            <span class="string">'increment'</span>, <span class="comment">// 将 `this.increment()` 映射为 `this.$store.dispatch('increment')`</span></div><div class="line">        </div><div class="line">            <span class="comment">// `mapActions` 也支持载荷：</span></div><div class="line">            <span class="string">'incrementBy'</span> <span class="comment">// 将 `this.incrementBy(amount)` 映射为 `this.$store.dispatch('incrementBy', amount)`</span></div><div class="line">        ]),</div><div class="line">        ...mapActions(&#123;</div><div class="line">            <span class="attr">add</span>: <span class="string">'increment'</span> <span class="comment">// 将 `this.add()` 映射为 `this.$store.dispatch('increment')`</span></div><div class="line">        &#125;)</div><div class="line">    &#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>实际项目目录</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div><div class="line">212</div><div class="line">213</div><div class="line">214</div><div class="line">215</div><div class="line">216</div><div class="line">217</div><div class="line">218</div><div class="line">219</div><div class="line">220</div><div class="line">221</div><div class="line">222</div><div class="line">223</div><div class="line">224</div><div class="line">225</div><div class="line">226</div><div class="line">227</div><div class="line">228</div><div class="line">229</div><div class="line">230</div><div class="line">231</div><div class="line">232</div><div class="line">233</div><div class="line">234</div><div class="line">235</div><div class="line">236</div><div class="line">237</div><div class="line">238</div><div class="line">239</div><div class="line">240</div><div class="line">241</div><div class="line">242</div><div class="line">243</div><div class="line">244</div><div class="line">245</div><div class="line">246</div><div class="line">247</div><div class="line">248</div><div class="line">249</div><div class="line">250</div><div class="line">251</div><div class="line">252</div><div class="line">253</div><div class="line">254</div><div class="line">255</div><div class="line">256</div><div class="line">257</div><div class="line">258</div><div class="line">259</div><div class="line">260</div><div class="line">261</div><div class="line">262</div><div class="line">263</div><div class="line">264</div><div class="line">265</div><div class="line">266</div><div class="line">267</div><div class="line">268</div><div class="line">269</div><div class="line">270</div><div class="line">271</div><div class="line">272</div><div class="line">273</div><div class="line">274</div><div class="line">275</div><div class="line">276</div><div class="line">277</div><div class="line">278</div><div class="line">279</div><div class="line">280</div><div class="line">281</div><div class="line">282</div><div class="line">283</div><div class="line">284</div><div class="line">285</div><div class="line">286</div><div class="line">287</div><div class="line">288</div><div class="line">289</div><div class="line">290</div><div class="line">291</div><div class="line">292</div><div class="line">293</div><div class="line">294</div><div class="line">295</div><div class="line">296</div><div class="line">297</div><div class="line">298</div><div class="line">299</div><div class="line">300</div><div class="line">301</div><div class="line">302</div><div class="line">303</div><div class="line">304</div><div class="line">305</div><div class="line">306</div><div class="line">307</div><div class="line">308</div><div class="line">309</div><div class="line">310</div><div class="line">311</div></pre></td><td class="code"><pre><div class="line">|---store/</div><div class="line">    actions.js          <span class="comment">// 保存所有异步任务</span></div><div class="line">    getters.js          <span class="comment">// 保存所有getters</span></div><div class="line">    index.js            <span class="comment">// 导入state、getter...来实例化vuex</span></div><div class="line">    mutations-type.js   <span class="comment">// 保存所有mutations类型</span></div><div class="line">    mutations.js        <span class="comment">// 实际的mutation函数</span></div><div class="line">    state.js            <span class="comment">// 所有需要共享的数据</span></div><div class="line"></div><div class="line"><span class="comment">// state.js</span></div><div class="line"><span class="comment">// 首先确定哪些数据需要vuex来管理，并给定默认值</span></div><div class="line"><span class="keyword">import</span> &#123;playMode&#125; <span class="keyword">from</span> <span class="string">'common/js/config'</span></div><div class="line"><span class="keyword">import</span> &#123;loadSearch,loadPlay,loadFavorite&#125; <span class="keyword">from</span> <span class="string">'common/js/cache'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> state = &#123;</div><div class="line">  <span class="attr">singer</span>: &#123;&#125;,</div><div class="line">  <span class="attr">playing</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">fullScreen</span>: <span class="literal">false</span>,</div><div class="line">  <span class="attr">playlist</span>: [],</div><div class="line">  <span class="attr">sequenceList</span>: [],</div><div class="line">  <span class="attr">mode</span>: playMode.sequence,</div><div class="line">  <span class="attr">currentIndex</span>: <span class="number">-1</span>,</div><div class="line">  <span class="attr">disc</span>:&#123;&#125;,</div><div class="line">  <span class="attr">topList</span>:&#123;&#125;,</div><div class="line">  <span class="attr">searchHistory</span>:loadSearch(),</div><div class="line">  <span class="attr">playHistory</span>:loadPlay(),</div><div class="line">  <span class="attr">favoriteList</span>:loadFavorite(),</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> state;<span class="comment">// 导出state对象</span></div><div class="line"></div><div class="line"><span class="comment">// mutation-types.js</span></div><div class="line"><span class="comment">// 确定针对state的修改</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_SINGER = <span class="string">'SET_SINGER'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_PLAYING_STATE = <span class="string">'SET_PLAYING_STATE'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_FULL_SCREEN = <span class="string">'SET_FULL_SCREEN'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_PLAYLIST = <span class="string">'SET_PLAYLIST'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_SEQUENCE_LIST = <span class="string">'SET_SEQUENCE_LIST'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_PLAY_MODE = <span class="string">'SET_PLAY_MODE'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_CURRENT_INDEX = <span class="string">'SET_CURRENT_INDEX'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_DISC = <span class="string">'SET_DISC'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_TOP_LIST = <span class="string">'SET_TOP_LIST'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_SEARCH_HISTORY = <span class="string">'SET_SEARCH_HISTORY'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_PLAY_HISTORY = <span class="string">'SET_PLAY_HISTORY'</span></div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> SET_FAVORITE_LIST = <span class="string">'SET_FAVORITE_LIST'</span></div><div class="line"></div><div class="line"><span class="comment">// mutations.js</span></div><div class="line"><span class="comment">// 根据mutaion-types编写具体的mutation来设置state</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> types <span class="keyword">from</span> <span class="string">'./mutation-types'</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> mutations = &#123;</div><div class="line">  [types.SET_SINGER](state, singer) &#123;</div><div class="line">    state.singer = singer</div><div class="line">  &#125;,</div><div class="line">  [types.SET_PLAYING_STATE](state, flag) &#123;</div><div class="line">    state.playing = flag</div><div class="line">  &#125;,</div><div class="line">  [types.SET_FULL_SCREEN](state, flag) &#123;</div><div class="line">    state.fullScreen = flag</div><div class="line">  &#125;,</div><div class="line">  [types.SET_PLAYLIST](state, list) &#123;</div><div class="line">    state.playlist = list</div><div class="line">  &#125;,</div><div class="line">  [types.SET_SEQUENCE_LIST](state, list) &#123;</div><div class="line">    state.sequenceList = list</div><div class="line">  &#125;,</div><div class="line">  [types.SET_PLAY_MODE](state, mode) &#123;</div><div class="line">    state.mode = mode</div><div class="line">  &#125;,</div><div class="line">  [types.SET_CURRENT_INDEX](state, index) &#123;</div><div class="line">    state.currentIndex = index</div><div class="line">  &#125;,</div><div class="line">  [types.SET_DISC](state, disc) &#123;</div><div class="line">    state.disc = disc</div><div class="line">  &#125;,</div><div class="line">  [types.SET_TOP_LIST](state, topList) &#123;</div><div class="line">    state.topList = topList</div><div class="line">  &#125;,</div><div class="line">  [types.SET_SEARCH_HISTORY](state, history) &#123;</div><div class="line">    state.searchHistory = history</div><div class="line">  &#125;,</div><div class="line">  [types.SET_PLAY_HISTORY](state, history) &#123;</div><div class="line">    state.playHistory = history</div><div class="line">  &#125;,</div><div class="line">  [types.SET_FAVORITE_LIST](state, list) &#123;</div><div class="line">    state.favoriteList = list</div><div class="line">  &#125;,</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> mutations; <span class="comment">// 导出mutations对象</span></div><div class="line"></div><div class="line"><span class="comment">// getters.js</span></div><div class="line"><span class="comment">// 编写getter来读取state</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> singer = <span class="function"><span class="params">state</span> =&gt;</span> state.singer</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> playing = <span class="function"><span class="params">state</span>=&gt;</span>state.playing</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> fullScreen = <span class="function"><span class="params">state</span>=&gt;</span>state.fullScreen</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> playlist = <span class="function"><span class="params">state</span>=&gt;</span>state.playlist</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> sequenceList = <span class="function"><span class="params">state</span>=&gt;</span>state.sequenceList</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> mode = <span class="function"><span class="params">state</span>=&gt;</span>state.mode</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> currentIndex = <span class="function"><span class="params">state</span>=&gt;</span>state.currentIndex</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> currentSong = <span class="function">(<span class="params">state</span>)=&gt;</span> &#123;</div><div class="line">  <span class="keyword">return</span> state.playlist[state.currentIndex] || &#123;&#125;;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> disc = <span class="function"><span class="params">state</span>=&gt;</span>state.disc</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> topList = <span class="function"><span class="params">state</span>=&gt;</span>state.topList</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> searchHistory = <span class="function"><span class="params">state</span>=&gt;</span>state.searchHistory</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> playHistory = <span class="function"><span class="params">state</span>=&gt;</span>state.playHistory</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> favoriteList = <span class="function"><span class="params">state</span>=&gt;</span>state.favoriteList</div><div class="line"></div><div class="line"><span class="comment">// actions.js</span></div><div class="line"><span class="comment">// 异步操作</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> types <span class="keyword">from</span> <span class="string">'./mutation-types'</span></div><div class="line"><span class="keyword">import</span> &#123; playMode &#125; <span class="keyword">from</span> <span class="string">'common/js/config'</span></div><div class="line"><span class="keyword">import</span> &#123; shuffle &#125; <span class="keyword">from</span> <span class="string">'common/js/util'</span></div><div class="line"><span class="keyword">import</span> &#123; saveSearch, deleteSearch, clearSearch, savePlay, saveFavorite, deleteFavorite &#125; <span class="keyword">from</span> <span class="string">'common/js/cache'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">findIndex</span>(<span class="params">list, song</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> list.findIndex(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</div><div class="line">    <span class="keyword">return</span> item.id === song.id;</div><div class="line">  &#125;)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> selectPlay = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit, state &#125;, &#123; list, index &#125;</span>) </span>&#123;</div><div class="line">  commit(types.SET_SEQUENCE_LIST, list);</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (state.mode === playMode.random) &#123;</div><div class="line">    <span class="keyword">let</span> randomList = shuffle(list);</div><div class="line">    commit(types.SET_PLAYLIST, randomList);</div><div class="line">    index = findIndex(randomList, list[index]);</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    commit(types.SET_PLAYLIST, list);</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  commit(types.SET_CURRENT_INDEX, index);</div><div class="line">  commit(types.SET_FULL_SCREEN, <span class="literal">true</span>);</div><div class="line">  commit(types.SET_PLAYING_STATE, <span class="literal">true</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> randomPlay = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, &#123; list &#125;</span>) </span>&#123;</div><div class="line">  commit(types.SET_PLAY_MODE, playMode.random);</div><div class="line">  commit(types.SET_SEQUENCE_LIST, list);</div><div class="line"></div><div class="line">  <span class="keyword">let</span> randomList = shuffle(list);</div><div class="line">  commit(types.SET_PLAYLIST, randomList);</div><div class="line"></div><div class="line">  commit(types.SET_CURRENT_INDEX, <span class="number">0</span>);</div><div class="line">  commit(types.SET_FULL_SCREEN, <span class="literal">true</span>);</div><div class="line">  commit(types.SET_PLAYING_STATE, <span class="literal">true</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> insertSong = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit, state &#125;, song</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> playlist = state.playlist.slice();</div><div class="line">  <span class="keyword">let</span> sequenceList = state.sequenceList.slice();</div><div class="line">  <span class="keyword">let</span> currentIndex = state.currentIndex;</div><div class="line">  <span class="comment">// 记录当前歌曲</span></div><div class="line">  <span class="keyword">let</span> currentSong = playlist[currentIndex];</div><div class="line"></div><div class="line">  <span class="comment">// 修改playlist</span></div><div class="line">  <span class="comment">// 查询当前列表中是否有待插入的歌曲并返回其索引</span></div><div class="line">  <span class="keyword">let</span> fpIndex = findIndex(playlist, song);</div><div class="line">  <span class="comment">// 因为是插入歌曲，所以索引要+1</span></div><div class="line">  currentIndex++;</div><div class="line">  <span class="comment">// 插入这首歌当当前索引位置</span></div><div class="line">  playlist.splice(currentIndex, <span class="number">0</span>, song);</div><div class="line">  <span class="comment">// 如果已经包含这首歌曲</span></div><div class="line">  <span class="keyword">if</span> (fpIndex &gt; <span class="number">-1</span>) &#123;</div><div class="line">    <span class="comment">// 如果当前插入的索引大于列表中的序号</span></div><div class="line">    <span class="keyword">if</span> (currentIndex &gt; fpIndex) &#123;</div><div class="line">      playlist.splice(fpIndex, <span class="number">1</span>);</div><div class="line">      currentIndex--;</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      playlist.splice(fpIndex + <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  <span class="comment">// 修改sequenceList</span></div><div class="line">  <span class="keyword">let</span> currentSIndex = findIndex(sequenceList, currentSong) + <span class="number">1</span>;</div><div class="line">  <span class="keyword">let</span> fsIndex = findIndex(sequenceList, song);</div><div class="line">  sequenceList.splice(currentSIndex, <span class="number">0</span>, song);</div><div class="line">  <span class="keyword">if</span> (fsIndex &gt; <span class="number">-1</span>) &#123;</div><div class="line">    <span class="keyword">if</span> (currentSIndex &gt; fsIndex) &#123;</div><div class="line">      sequenceList.splice(fsIndex, <span class="number">1</span>);</div><div class="line">    &#125; <span class="keyword">else</span> &#123;</div><div class="line">      sequenceList.splice(fsIndex + <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  commit(types.SET_PLAYLIST, playlist);</div><div class="line">  commit(types.SET_SEQUENCE_LIST, sequenceList);</div><div class="line">  commit(types.SET_CURRENT_INDEX, currentIndex);</div><div class="line">  commit(types.SET_FULL_SCREEN, <span class="literal">true</span>);</div><div class="line">  commit(types.SET_PLAYING_STATE, <span class="literal">true</span>);</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> saveSearchHistory = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, query</span>) </span>&#123;</div><div class="line">  commit(types.SET_SEARCH_HISTORY, saveSearch(query));</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteSearchHistory = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, query</span>) </span>&#123;</div><div class="line">  commit(types.SET_SEARCH_HISTORY, deleteSearch(query));</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> clearSearchHistory = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;</span>) </span>&#123;</div><div class="line">  commit(types.SET_SEARCH_HISTORY, clearSearch());</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteSong = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit, state &#125;, song</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> playlist = state.playlist.slice()</div><div class="line">  <span class="keyword">let</span> sequenceList = state.sequenceList.slice()</div><div class="line">  <span class="keyword">let</span> currentIndex = state.currentIndex</div><div class="line"></div><div class="line">  <span class="keyword">let</span> pIndex = findIndex(playlist, song)</div><div class="line">  playlist.splice(pIndex, <span class="number">1</span>)</div><div class="line"></div><div class="line">  <span class="keyword">let</span> sIndex = findIndex(sequenceList, song)</div><div class="line">  sequenceList.splice(sIndex, <span class="number">1</span>)</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (currentIndex &gt; pIndex || currentIndex === playlist.length) &#123;</div><div class="line">    currentIndex--</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  commit(types.SET_PLAYLIST, playlist)</div><div class="line">  commit(types.SET_SEQUENCE_LIST, sequenceList)</div><div class="line">  commit(types.SET_CURRENT_INDEX, currentIndex)</div><div class="line"></div><div class="line">  <span class="keyword">if</span> (!playlist.length) &#123;</div><div class="line">    commit(types.SET_PLAYING_STATE, <span class="literal">false</span>)</div><div class="line">  &#125; <span class="keyword">else</span> &#123;</div><div class="line">    commit(types.SET_PLAYING_STATE, <span class="literal">true</span>)</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteSongList = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;</span>) </span>&#123;</div><div class="line">  commit(types.SET_CURRENT_INDEX, <span class="number">-1</span>)</div><div class="line">  commit(types.SET_PLAYLIST, [])</div><div class="line">  commit(types.SET_SEQUENCE_LIST, [])</div><div class="line">  commit(types.SET_PLAYING_STATE, <span class="literal">false</span>)</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> savePlayHistory = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, song</span>) </span>&#123;</div><div class="line">  commit(types.SET_PLAY_HISTORY, savePlay(song))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> saveFavoriteList = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, song</span>) </span>&#123;</div><div class="line">  commit(types.SET_FAVORITE_LIST, saveFavorite(song))</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="keyword">export</span> <span class="keyword">const</span> deleteFavoriteList = <span class="function"><span class="keyword">function</span>(<span class="params">&#123; commit &#125;, song</span>) </span>&#123;</div><div class="line">  commit(types.SET_FAVORITE_LIST, deleteFavorite(song))</div><div class="line">&#125;</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment">// index.js</span></div><div class="line"><span class="comment">// 入口文件，实例化vuex</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> Vue <span class="keyword">from</span> <span class="string">'vue'</span></div><div class="line"><span class="keyword">import</span> Vuex <span class="keyword">from</span> <span class="string">'vuex'</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> actions <span class="keyword">from</span> <span class="string">'./actions'</span></div><div class="line"><span class="keyword">import</span> * <span class="keyword">as</span> getters <span class="keyword">from</span> <span class="string">'./getters'</span></div><div class="line"><span class="keyword">import</span> state <span class="keyword">from</span> <span class="string">'./state'</span></div><div class="line"><span class="keyword">import</span> mutations <span class="keyword">from</span> <span class="string">'./mutations'</span></div><div class="line"><span class="keyword">import</span> createLogger <span class="keyword">from</span> <span class="string">'vuex/dist/logger'</span>;<span class="comment">// 调试工具，可以打印出log</span></div><div class="line"></div><div class="line">Vue.use(Vuex);<span class="comment">// vuex是个插件，需要use</span></div><div class="line"></div><div class="line"><span class="keyword">const</span> debug = process.env.NODE_ENV !== <span class="string">'production'</span>;</div><div class="line"></div><div class="line"><span class="comment">// 导出一个store实例，供main.js使用</span></div><div class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="keyword">new</span> Vuex.Store(&#123;</div><div class="line">  actions,</div><div class="line">  getters,</div><div class="line">  state,</div><div class="line">  mutations,</div><div class="line">  <span class="attr">strict</span>: debug,<span class="comment">// strict模式会针对不通过commit提交mutation报错</span></div><div class="line">  plugins: debug ? [createLogger()] : [],<span class="comment">// 使用打印log插件</span></div><div class="line">&#125;)</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="comment">// 导入vuex的stroe实例，并注入到vue根组件中</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">'./store'</span></div><div class="line">...</div><div class="line"></div><div class="line">new Vue(&#123;</div><div class="line">  <span class="attr">el</span>: <span class="string">'#app'</span>,</div><div class="line">  router,</div><div class="line">  store,<span class="comment">// 导入vuex的stroe实例</span></div><div class="line">  render: <span class="function"><span class="params">h</span> =&gt;</span> h(App)</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="单元测试-gt-用到再补"><a href="#单元测试-gt-用到再补" class="headerlink" title="单元测试-&gt;用到再补"></a>单元测试-&gt;用到再补</h2><h2 id="服务器端渲染-gt-用到再补"><a href="#服务器端渲染-gt-用到再补" class="headerlink" title="服务器端渲染-&gt;用到再补"></a>服务器端渲染-&gt;用到再补</h2><h2 id="Typescript支持-gt-用到再补"><a href="#Typescript支持-gt-用到再补" class="headerlink" title="Typescript支持-&gt;用到再补"></a>Typescript支持-&gt;用到再补</h2>
      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/vue/" rel="tag"># vue</a>
          
        </div>
      

      
        
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/07/31/how-does-timer-work/" rel="next" title="how-does-timer-work">
                <i class="fa fa-chevron-left"></i> how-does-timer-work
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/04/type-existence/" rel="prev" title="type-existence">
                type-existence <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>

          
          </div>
          


          
  <div class="comments" id="comments">
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/Avatar.png"
               alt="BryanAdamss" />
          <p class="site-author-name" itemprop="name">BryanAdamss</p>
           
              <p class="site-description motion-element" itemprop="description"></p>
          
        </div>
        <nav class="site-state motion-element">
        
          
            <div class="site-state-item site-state-posts">
              <a href="/archives">
                <span class="site-state-item-count">24</span>
                <span class="site-state-item-name">日志</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">2</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">36</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
            
              <span class="links-of-author-item">
                <a href="https://github.com/BryanAdamss" target="_blank" title="GitHub">
                  
                    <i class="fa fa-fw fa-github"></i>
                  
                  GitHub
                </a>
              </span>
            
          
        </div>

        
        

        
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#VueJs官网教程学习笔记"><span class="nav-number">1.</span> <span class="nav-text">VueJs官网教程学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#安装"><span class="nav-number">1.1.</span> <span class="nav-text">安装</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#介绍"><span class="nav-number">1.2.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Vue实例"><span class="nav-number">1.3.</span> <span class="nav-text">Vue实例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#模板语法"><span class="nav-number">1.4.</span> <span class="nav-text">模板语法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#插值"><span class="nav-number">1.4.1.</span> <span class="nav-text">插值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#指令"><span class="nav-number">1.4.2.</span> <span class="nav-text">指令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过滤器"><span class="nav-number">1.4.3.</span> <span class="nav-text">过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#缩写"><span class="nav-number">1.4.4.</span> <span class="nav-text">缩写</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#计算属性"><span class="nav-number">1.5.</span> <span class="nav-text">计算属性</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#计算属性-1"><span class="nav-number">1.5.1.</span> <span class="nav-text">计算属性</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Class与Style绑定"><span class="nav-number">1.6.</span> <span class="nav-text">Class与Style绑定</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#绑定-HTML-Class"><span class="nav-number">1.6.1.</span> <span class="nav-text">绑定 HTML Class</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#绑定内联样式"><span class="nav-number">1.6.2.</span> <span class="nav-text">绑定内联样式</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#条件渲染"><span class="nav-number">1.7.</span> <span class="nav-text">条件渲染</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#v-if"><span class="nav-number">1.7.1.</span> <span class="nav-text">v-if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-else"><span class="nav-number">1.7.2.</span> <span class="nav-text">v-else</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-else-if"><span class="nav-number">1.7.3.</span> <span class="nav-text">v-else-if</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#用-key-管理可复用的元素"><span class="nav-number">1.7.4.</span> <span class="nav-text">用 key 管理可复用的元素</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-show"><span class="nav-number">1.7.5.</span> <span class="nav-text">v-show</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-if和v-show"><span class="nav-number">1.7.6.</span> <span class="nav-text">v-if和v-show</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#v-if和v-for一起使用"><span class="nav-number">1.7.7.</span> <span class="nav-text">v-if和v-for一起使用</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#列表渲染"><span class="nav-number">1.8.</span> <span class="nav-text">列表渲染</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#v-for"><span class="nav-number">1.8.1.</span> <span class="nav-text">v-for</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#key"><span class="nav-number">1.8.2.</span> <span class="nav-text">key</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数组更新检测"><span class="nav-number">1.8.3.</span> <span class="nav-text">数组更新检测</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#显示过滤-排序结果"><span class="nav-number">1.8.4.</span> <span class="nav-text">显示过滤/排序结果</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#事件处理器"><span class="nav-number">1.9.</span> <span class="nav-text">事件处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#监听事件"><span class="nav-number">1.9.1.</span> <span class="nav-text">监听事件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#表单控件绑定"><span class="nav-number">1.10.</span> <span class="nav-text">表单控件绑定</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#基础用法"><span class="nav-number">1.10.1.</span> <span class="nav-text">基础用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#组件"><span class="nav-number">1.11.</span> <span class="nav-text">组件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用组件"><span class="nav-number">1.11.1.</span> <span class="nav-text">使用组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#proprs"><span class="nav-number">1.11.2.</span> <span class="nav-text">proprs</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#非Prop属性"><span class="nav-number">1.11.3.</span> <span class="nav-text">非Prop属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义事件"><span class="nav-number">1.11.4.</span> <span class="nav-text">自定义事件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#使用Slot分发内容"><span class="nav-number">1.11.5.</span> <span class="nav-text">使用Slot分发内容</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态组件"><span class="nav-number">1.11.6.</span> <span class="nav-text">动态组件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#杂项"><span class="nav-number">1.11.7.</span> <span class="nav-text">杂项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#深入响应式原理"><span class="nav-number">1.12.</span> <span class="nav-text">深入响应式原理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#如何追踪变化"><span class="nav-number">1.12.1.</span> <span class="nav-text">如何追踪变化</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#变化检测问题"><span class="nav-number">1.12.2.</span> <span class="nav-text">变化检测问题</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#声明响应式属性"><span class="nav-number">1.12.3.</span> <span class="nav-text">声明响应式属性</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#异步更新队列"><span class="nav-number">1.12.4.</span> <span class="nav-text">异步更新队列</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过渡效果"><span class="nav-number">1.13.</span> <span class="nav-text">过渡效果</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#单元素-组件的过渡"><span class="nav-number">1.13.1.</span> <span class="nav-text">单元素/组件的过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#过渡的css类名"><span class="nav-number">1.13.2.</span> <span class="nav-text">过渡的css类名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#css过渡"><span class="nav-number">1.13.3.</span> <span class="nav-text">css过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#css动画"><span class="nav-number">1.13.4.</span> <span class="nav-text">css动画</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#自定义过渡类名"><span class="nav-number">1.13.5.</span> <span class="nav-text">自定义过渡类名</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#同时使用-Transitions-和-Animations"><span class="nav-number">1.13.6.</span> <span class="nav-text">同时使用 Transitions 和 Animations</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#显性的过渡效果持续时间"><span class="nav-number">1.13.7.</span> <span class="nav-text">显性的过渡效果持续时间</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#初始渲染的过渡"><span class="nav-number">1.13.8.</span> <span class="nav-text">初始渲染的过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多个元素的过渡"><span class="nav-number">1.13.9.</span> <span class="nav-text">多个元素的过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多元素的过渡模式"><span class="nav-number">1.13.10.</span> <span class="nav-text">多元素的过渡模式</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#多个组件的过渡"><span class="nav-number">1.13.11.</span> <span class="nav-text">多个组件的过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列表过渡"><span class="nav-number">1.13.12.</span> <span class="nav-text">列表过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列表的位移过渡"><span class="nav-number">1.13.13.</span> <span class="nav-text">列表的位移过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#列表的渐进过渡"><span class="nav-number">1.13.14.</span> <span class="nav-text">列表的渐进过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#可复用的过渡"><span class="nav-number">1.13.15.</span> <span class="nav-text">可复用的过渡</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态过渡"><span class="nav-number">1.13.16.</span> <span class="nav-text">动态过渡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#过渡状态"><span class="nav-number">1.14.</span> <span class="nav-text">过渡状态</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#状态动画-与-watcher"><span class="nav-number">1.14.1.</span> <span class="nav-text">状态动画 与 watcher</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#动态状态转换"><span class="nav-number">1.14.2.</span> <span class="nav-text">动态状态转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#通过组件组织过渡"><span class="nav-number">1.14.3.</span> <span class="nav-text">通过组件组织过渡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Render函数-gt-用到再补"><span class="nav-number">1.15.</span> <span class="nav-text">Render函数->用到再补</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#自定义指令"><span class="nav-number">1.16.</span> <span class="nav-text">自定义指令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简介"><span class="nav-number">1.16.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#钩子函数"><span class="nav-number">1.16.2.</span> <span class="nav-text">钩子函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#钩子函数参数"><span class="nav-number">1.16.3.</span> <span class="nav-text">钩子函数参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#函数简写"><span class="nav-number">1.16.4.</span> <span class="nav-text">函数简写</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#对象字面量"><span class="nav-number">1.16.5.</span> <span class="nav-text">对象字面量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#混合"><span class="nav-number">1.17.</span> <span class="nav-text">混合</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#插件"><span class="nav-number">1.18.</span> <span class="nav-text">插件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单文件组件"><span class="nav-number">1.19.</span> <span class="nav-text">单文件组件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#生产环境部署提示"><span class="nav-number">1.20.</span> <span class="nav-text">生产环境部署提示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#路由"><span class="nav-number">1.21.</span> <span class="nav-text">路由</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#简单路由"><span class="nav-number">1.21.1.</span> <span class="nav-text">简单路由</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#官方路由Vue-router"><span class="nav-number">1.21.2.</span> <span class="nav-text">官方路由Vue-router</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#状态管理"><span class="nav-number">1.22.</span> <span class="nav-text">状态管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#类-Flux-状态管理的官方实现"><span class="nav-number">1.22.1.</span> <span class="nav-text">类 Flux 状态管理的官方实现</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#简单状态管理起步使用"><span class="nav-number">1.22.2.</span> <span class="nav-text">简单状态管理起步使用</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#vuex"><span class="nav-number">1.22.3.</span> <span class="nav-text">vuex</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#单元测试-gt-用到再补"><span class="nav-number">1.23.</span> <span class="nav-text">单元测试->用到再补</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#服务器端渲染-gt-用到再补"><span class="nav-number">1.24.</span> <span class="nav-text">服务器端渲染->用到再补</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Typescript支持-gt-用到再补"><span class="nav-number">1.25.</span> <span class="nav-text">Typescript支持->用到再补</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2017 - 
  <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">BryanAdamss</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Mist
  </a>
</div>


        

        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    
    
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  



  




	





  





  





  



  
  
  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length == 0) {
      search_path = "search.xml";
    }
    var path = "/" + search_path;
    // monitor main search box;

    function proceedsearch() {
      $("body").append('<div class="local-search-pop-overlay">').css('overflow', 'hidden');
      $('.popup').toggle();
    }
    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';
      $.ajax({
        url: path,
        dataType: "xml",
        async: true,
        success: function( xmlResponse ) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = $( "entry", xmlResponse ).map(function() {
            return {
              title: $( "title", this ).text(),
              content: $("content",this).text(),
              url: $( "url" , this).text()
            };
          }).get();
          var $input = document.getElementById(search_id);
          var $resultContent = document.getElementById(content_id);
          $input.addEventListener('input', function(){
            var matchcounts = 0;
            var str='<ul class=\"search-result-list\">';
            var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
            $resultContent.innerHTML = "";
            if (this.value.trim().length > 1) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var content_index = [];
                var data_title = data.title.trim().toLowerCase();
                var data_content = data.content.trim().replace(/<[^>]+>/g,"").toLowerCase();
                var data_url = decodeURIComponent(data.url);
                var index_title = -1;
                var index_content = -1;
                var first_occur = -1;
                // only match artiles with not empty titles and contents
                if(data_title != '') {
                  keywords.forEach(function(keyword, i) {
                    index_title = data_title.indexOf(keyword);
                    index_content = data_content.indexOf(keyword);
                    if( index_title >= 0 || index_content >= 0 ){
                      isMatch = true;
                      if (i == 0) {
                        first_occur = index_content;
                      }
                    }

                  });
                }
                // show search results
                if (isMatch) {
                  matchcounts += 1;
                  str += "<li><a href='"+ data_url +"' class='search-result-title'>"+ data_title +"</a>";
                  var content = data.content.trim().replace(/<[^>]+>/g,"");
                  if (first_occur >= 0) {
                    // cut out 100 characters
                    var start = first_occur - 20;
                    var end = first_occur + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if(start == 0){
                      end = 50;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    var match_content = content.substring(start, end);
                    // highlight all keywords
                    keywords.forEach(function(keyword){
                      var regS = new RegExp(keyword, "gi");
                      match_content = match_content.replace(regS, "<b class=\"search-keyword\">"+keyword+"</b>");
                    });

                    str += "<p class=\"search-result\">" + match_content +"...</p>"
                  }
                  str += "</li>";
                }
              })};
            str += "</ul>";
            if (matchcounts == 0) { str = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>' }
            if (keywords == "") { str = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>' }
            $resultContent.innerHTML = str;
          });
          proceedsearch();
        }
      });}

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched == false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(function(e){
      $('.popup').hide();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    });
    $('.popup').click(function(e){
      e.stopPropagation();
    });
  </script>


  

  

  

  


  

</body>
</html>
